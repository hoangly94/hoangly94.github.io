(window.webpackJsonp=window.webpackJsonp||[]).push([["trading"],{"+J+G":function(t,e,i){t.exports=i.p+"alarm_clock.48d3df0afe4d4981523b8a12e4e25f92.mp3"},"+xnd":function(t,e,i){"use strict";var r;i.d(e,"a",(function(){return r})),function(t){t.Default="default",t.Success="success",t.Warning="warning",t.Danger="danger"}(r||(r={}))},"/KDZ":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i("q1tI");class s extends r.PureComponent{constructor(t){super(t),this._handleChange=()=>{this.forceUpdate()},this.state={query:window.matchMedia(this.props.rule)}}componentDidMount(){this._subscribe(this.state.query)}componentDidUpdate(t,e){this.state.query!==e.query&&(this._unsubscribe(e.query),this._subscribe(this.state.query))}componentWillUnmount(){this._unsubscribe(this.state.query)}render(){return this.props.children(this.state.query.matches)}static getDerivedStateFromProps(t,e){return t.rule!==e.query.media?{query:window.matchMedia(t.rule)}:null}_subscribe(t){t.addListener(this._handleChange)}_unsubscribe(t){t.removeListener(this._handleChange)}}},"02pg":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("q1tI"),s=i("TSYQ"),o=i("XiJV");function n(t){return r.createElement("div",{className:s(o.separator,t.className)})}},"0jws":function(t,e,i){t.exports={blockHidden:"blockHidden-xPfK7aM7","pane-button":"pane-button-xPfK7aM7"}},"0rc0":function(t,e,i){"use strict";i.d(e,"t",(function(){return m})),i.d(e,"g",(function(){return g})),i.d(e,"w",(function(){return f})),i.d(e,"n",(function(){return y})),i.d(e,"i",(function(){return v})),i.d(e,"b",(function(){return w})),i.d(e,"c",(function(){return k})),i.d(e,"d",(function(){return P})),i.d(e,"e",(function(){return B})),i.d(e,"j",(function(){return C})),i.d(e,"k",(function(){return S})),i.d(e,"a",(function(){return E})),i.d(e,"r",(function(){return T})),i.d(e,"l",(function(){return j})),i.d(e,"m",(function(){return L})),i.d(e,"o",(function(){return N})),i.d(e,"p",(function(){return D})),i.d(e,"s",(function(){return A})),i.d(e,"f",(function(){return I})),i.d(e,"u",(function(){return M})),i.d(e,"q",(function(){return x})),i.d(e,"h",(function(){return V})),i.d(e,"v",(function(){return R}));var r=i("YFKU"),s=i("PT1i"),o=i("nDsj"),n=i("nc0P"),a=i("ivNn"),c=i("hY0g"),l=i.n(c),u=i("ogJP"),h=i("EBrf"),d=i("nEwK"),p=i("j0sD"),b=i("aIyQ"),_=i.n(b);function m(t){const e=new o.BehaviorSubject(t.value()),i=t=>{e.next(t)};return t.subscribe(i),{subject:e,unsubscribe:()=>t.unsubscribe(i)}}function g(t,e){return Object(u.deepEquals)(t,e)[0]}function f(t){return void 0!==t&&Boolean(t.showTotal)}function y(t){return t<1?Math.abs(Math.floor(Math.log10(t))):2}function v(t,e){if(void 0!==t)return t;if(void 0!==e){const t=Math.round(1/e);return String(t)+":1"}return null}function w(t,e,i){return null!==t?(void 0!==i?t*i:t)*e:0}function k(t,e,i,r,s){return null!==t?(void 0!==s?t*s:t)*e/r*i:0}function P(t,e){return void 0!==e?t*e:0}function B(t,e){const i=0!==e?100*t/e:0;return i>100?100:i}function C(t){if("number"==typeof t){const e=Object(h.splitThousands)((t||0).toFixed(2)," ");return Number.isInteger(t)||t>=1?e:function(t){return Number.isInteger(t)?t+"":t<1?function(t){const e=(t+"").split(".")[1]||"";let i=e.length;for(let t=0;t<e.length;t++)if("0"!==e[t]){i=t+1;break}return t.toFixed(i)}(t):t.toFixed(2)}(t)}return Object(h.splitThousands)(t," ")}const O=new d.VolumeFormatter(2);function S(t,e){return null!==t&&null!==e&&t/e>0?O.format(t/e):""}function E(t,e){const i=Object.assign({},t);return["trade","ask","bid"].forEach((t=>{const r=i[t];void 0!==r&&(i[t]=function(t,e){return e>1?t:Object(a.fixComputationError)(Math.round(t/e)*e)}(r,e))})),i}function T(t,e){if(0===e)return!1;const i=Object(a.fixComputationError)(e),r=new n.Big(t),s=new n.Big(i);return r.mod(s).eq(0)}function j(t){return Object(u.isNumber)(t.ask)?t.ask:Object(u.isNumber)(t.trade)?t.trade:0}function L(t){return Object(u.isNumber)(t.bid)?t.bid:Object(u.isNumber)(t.trade)?t.trade:0}function N(t){return Object(u.isNumber)(t.trade)?t.trade:0}function D(t,e){return 1===t?j(e):L(e)}function A(t){return null===t||void 0===t.ask||void 0===t.bid}function I(t,e,i){return 4===t?null===e||null===i:3===t?null===i:null===e}function M(t,e){switch(e){case p.b.IncDec:return t<0?"-":"+";case p.b.PlusValue:return String(t);case p.b.Clear:return"Clear";default:return"Default"}}const x={buy:{market:(t,e)=>window.t("Buy {qty} {symbol}{whitespaceNoBreak}MKT").format({qty:t,symbol:e,whitespaceNoBreak:" "}),stop:(t,e,i)=>window.t("Buy {qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP").format({qty:t,symbol:e,stopPrice:i,whitespaceNoBreak:" "}),limit:(t,e,i)=>window.t("Buy {qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT").format({qty:t,symbol:e,limitPrice:i,whitespaceNoBreak:" "}),stopLimit:(t,e,i,r)=>window.t("Buy {qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT").format({qty:t,symbol:e,stopPrice:i,limitPrice:r,whitespaceNoBreak:" "})},sell:{market:(t,e)=>window.t("Sell {qty} {symbol}{whitespaceNoBreak}MKT").format({qty:t,symbol:e,whitespaceNoBreak:" "}),stop:(t,e,i)=>window.t("Sell {qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP").format({qty:t,symbol:e,stopPrice:i,whitespaceNoBreak:" "}),limit:(t,e,i)=>window.t("Sell {qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT").format({qty:t,symbol:e,limitPrice:i,whitespaceNoBreak:" "}),stopLimit:(t,e,i,r)=>window.t("Sell {qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT").format({qty:t,symbol:e,stopPrice:i,limitPrice:r,whitespaceNoBreak:" "})}};function V(t,e,i,r){const s=[];return void 0!==i&&Array.isArray(i.customFields)&&i.customFields.forEach((i=>{if("TextWithCheckBox"===i.inputType&&s.push({id:i.id,type:i.inputType,inputType:i.customInfo.asterix?"password":"text",placeholder:i.placeHolder||"",title:i.title||"",checkboxTitle:i.customInfo.checkboxTitle,text:new l.a(i.value.text),checked:new l.a(i.value.checked),status:e,onControlFocused:new _.a}),"ComboBox"===i.inputType&&Array.isArray(i.items)){let e=i.items[0];const o=i.id;if(r&&o in r){const t=r[o],s=i.items.find((e=>e.value===t));void 0!==s&&(e=s)}s.push({id:i.id,type:i.inputType,title:i.title,items:i.preventModify&&t?[e]:i.items,selectedItem:new l.a(e.value),onControlFocused:new _.a,saveToSettings:i.saveToSettings})}})),s}async function R(t,e){if(void 0!==t.solutions){let i,o;if("changeSymbol"in t.solutions){const e=t.solutions.changeSymbol;i=Object(r.t)("Switch the symbol"),o=()=>s.linking.symbol.setValue(e)}else{const s=t.solutions.changeAccount,n=(await e.accountsMetainfo()).filter((t=>t.id===s))[0].name;i=Object(r.t)("Switch to {accountName}").replace("{accountName}",n),o=()=>e.setCurrentAccount(s)}return{title:i,apply:o}}}},"1R9w":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},s=function(t){function e(e){t.call(this),this.errors=e;var i=Error.call(this,e?e.length+" errors occurred during unsubscription:\n  "+e.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"");this.name=i.name="UnsubscriptionError",this.stack=i.stack,this.message=i.message}return r(e,t),e}(Error);e.UnsubscriptionError=s},"1rjR":function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i("HbRj");var r=i("YFKU"),s=i("VBos");const o={get(){return this},open:t=>Object(s.a)({title:Object(r.t)("Cancel order"),text:Object(r.t)("Are you sure you want to cancel order {orderId}?").replace("{orderId}",t),mainButtonIntent:"primary"}),multiple(t,e,i){let o=t;return void 0!==e&&(o=`${o} ${1===e?Object(r.t)("BUY"):Object(r.t)("SELL")}`),Object(s.a)({title:Object(r.t)("Cancel order"),text:Object(r.t)("Are you sure you want to cancel {qty} {side} orders?").replace("{qty}",String(i)).replace("{side}",o),mainButtonIntent:"primary"})}}},"2TBc":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i("Eyy1");class s{constructor(t){this._activeBroker=null,this._trading=t,this._trading.onConnectionStatusChange.subscribe(this,this._onStatusChange),this._onStatusChange(this._trading.connectStatus())}activeBroker(){return this._activeBroker}trading(){return this._trading}_stopService(){this.stopService(),Object(r.ensureNotNull)(this._activeBroker).currentAccountUpdate.unsubscribeAll(this)}_startService(){this.startService(),Object(r.ensureNotNull)(this._activeBroker).currentAccountUpdate.subscribe(this,this._onCurrentAccountUpdate)}_onStatusChange(t){const e=this._trading.activeBroker();this._activeBroker===e&&1===t||(null!==this._activeBroker&&(this._stopService(),this._activeBroker=null),null!==e&&1===t&&(this._activeBroker=e,this._startService(),this._lastAccountId=e.currentAccount()))}_onCurrentAccountUpdate(){const t=Object(r.ensureNotNull)(this._activeBroker);this._lastAccountId!==t.currentAccount()&&(this.stopService(),this.startService(),this._lastAccountId=t.currentAccount())}}},"4EEH":function(t,e,i){"use strict";var r=i("ENbT");function s(t){return t?1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}:r.noop}e.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return s(t)},e.pipeFromArray=s},"4c1C":function(t,e,i){"use strict";var r=i("tSeh"),s=i("nA+3"),o=i("78uX"),n=i("4EEH"),a=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var i=new t;return i.source=this,i.operator=e,i},t.prototype.subscribe=function(t,e,i){var r=this.operator,o=s.toSubscriber(t,e,i);if(r?r.call(o,this.source):o.add(this.source||!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}},t.prototype.forEach=function(t,e){var i=this;if(e||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?e=r.root.Rx.config.Promise:r.root.Promise&&(e=r.root.Promise)),!e)throw new Error("no Promise impl found");return new e((function(e,r){var s;s=i.subscribe((function(e){if(s)try{t(e)}catch(t){r(t),s.unsubscribe()}else t(e)}),r,e)}))},t.prototype._subscribe=function(t){return this.source.subscribe(t)},t.prototype[o.observable]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 0===t.length?this:n.pipeFromArray(t)(this)},t.prototype.toPromise=function(t){var e=this;if(t||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?t=r.root.Rx.config.Promise:r.root.Promise&&(t=r.root.Promise)),!t)throw new Error("no Promise impl found");return new t((function(t,i){var r;e.subscribe((function(t){return r=t}),(function(t){return i(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();e.Observable=a},"4hvi":function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var r=i("YFKU"),s=i("zM7N"),o=i("oiZD"),n=i("0rc0"),a=i("dct7"),c=i("D/08");async function l(t){var e;const{isTradableResult:l,activeBroker:u}=t,h=await Object(n.v)(l,u),[{showSimpleDialog:d},{SimpleConfirmDialog:p}]=await Promise.all([Promise.all([i.e(4),i.e(14),i.e(16),i.e(28),i.e(88),i.e(129),i.e(3),i.e(75),i.e("create-confirm-dialog")]).then(i.bind(null,"EcUf")),Promise.all([i.e(4),i.e(14),i.e(16),i.e(28),i.e(88),i.e(129),i.e(3),i.e(75),i.e("create-confirm-dialog")]).then(i.bind(null,"Hc1a"))]);d({text:null!==(e=l.reason)&&void 0!==e?e:Object(r.t)("Symbol cannot be traded"),title:Object(r.t)("Non-tradable symbol"),titleIcon:o.watchedTheme.value()===s.a.Light?a:c,mainButtonText:void 0!==h?h.title:Object(r.t)("Ok"),mainButtonIntent:"primary",showCancelButton:!1,onConfirm:t=>{void 0!==h&&h.apply(),t.dialogClose()}},p)}},"5det":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("YFKU"),s=i("8Lsi"),o=i("cJM1");async function n(t,e,n,a,c){const l=new o.a,u=Object(s.a)(e);if(c&&void 0!==u&&l.has(u))return!0;const{ConfirmDialogRenderer:h}=await Promise.all([i.e(4),i.e(14),i.e(16),i.e(28),i.e(88),i.e(129),i.e(3),i.e(75),i.e("create-confirm-dialog")]).then(i.bind(null,"4Qqi")),d=new h(l),p={title:t,message:e,closeButton:null!=a?a:Object(r.t)("No"),confirmButton:null!=n?n:Object(r.t)("Yes"),showDisableConfirmationsCheckbox:c};return(await d.open(p)).status}},"6aj4":function(t,e,i){t.exports={"trading-panel-content":"trading-panel-content-3q5skKoi","trading-panel-spinner":"trading-panel-spinner-3q5skKoi","trading-panel-handle":"trading-panel-handle-3q5skKoi"}},"78uX":function(t,e,i){"use strict";var r=i("tSeh");function s(t){var e,i=t.Symbol;return"function"==typeof i?i.observable?e=i.observable:(e=i("observable"),i.observable=e):e="@@observable",e}e.getSymbolObservable=s,e.observable=s(r.root),e.$$observable=e.observable},"8Lsi":function(t,e,i){"use strict";function r(t){return"string"==typeof t?t:Array.isArray(t)?t.join(""):void 0}i.d(e,"a",(function(){return r}))},"8Zmw":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},s=function(t){function e(e,i){t.call(this),this.subject=e,this.subscriber=i,this.closed=!1}return r(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}},e}(i("NTzu").Subscription);e.SubjectSubscription=s},"8wgr":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));const r={ACTIVE_BROKER:"trading.active_broker",FILTER_BROKER:"trading.filter_brokers_by_locale",PROPERTIES:"trading.chart.proterty",QTY:"trading.qty.",BROKERS_QTY:"trading.brokers.qty",PROFIT_VIEW_TYPE:"trading.dom.profitViewType",ORDER_WIDGET_MODE:"trading.orderWidgetMode.",TAKE_PROFIT:"trading.takeprofit.",STOP_LOSS:"trading.stoploss.",ORDER_DURATION:"trading.orderDuration.",DOM_DURATION:"trading.domDuration.",TRADING_PANEL_OPENED:"trading.tradingPanelOpened",TRADING_PANEL_ACTIVE_PAGE:"trading.tradingPanelActivePage",PANEL_WIDTH:"trading.panelWidth",PANEL_HEIGHT:"trading.panelHeight",ORDER_PANEL_SETTINGS:"trading.orderPanelSettings",FAVORITE_BROKERS:"trading.panelFavorite",REVIEW_DIALOG_WAS_SHOWED:"trading.reviewDialogShowedOnLogin",SHOW_TOOLTIP_FOR_SELECT_BROKER:"trading.showTooltipForSelectBroker",LOGIN_COUNTER:"trading.brokerLogInCounter",LOGOUT_COUNTER:"trading.brokerLogOutCounter",DISABLED_CONFIRMATIONS:"trading.disabledConfirmations"}},"8yf6":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},s=i("4c1C"),o=i("rfFC"),n=i("NTzu"),a=i("VpWK"),c=i("8Zmw"),l=i("qWnh"),u=function(t){function e(e){t.call(this,e),this.destination=e}return r(e,t),e}(o.Subscriber);e.SubjectSubscriber=u;var h=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return r(e,t),e.prototype[l.rxSubscriber]=function(){return new u(this)},e.prototype.lift=function(t){var e=new d(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,i=e.length,r=e.slice(),s=0;s<i;s++)r[s].next(t)},e.prototype.error=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,i=e.length,r=e.slice(),s=0;s<i;s++)r[s].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,i=t.slice(),r=0;r<e;r++)i[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),n.Subscription.EMPTY):this.isStopped?(t.complete(),n.Subscription.EMPTY):(this.observers.push(t),new c.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new s.Observable;return t.source=this,t},e.create=function(t,e){return new d(t,e)},e}(s.Observable);e.Subject=h;var d=function(t){function e(e,i){t.call(this),this.destination=e,this.source=i}return r(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):n.Subscription.EMPTY},e}(h);e.AnonymousSubject=d},"9pog":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("zXvd");const s=["","K","M","G","T","Y"];function o(t){if(t<1)return r.NumericFormatter.formatNoE(t);let e=0,i=+t;if(isFinite(i))for(;i>=1e3&&i%100==0;)e++,i/=1e3;return i+(e<s.length?s[e]:"e"+3*e)}},ASyk:function(t,e,i){t.exports={"tablet-normal-breakpoint":"screen and (max-width: 768px)","small-height-breakpoint":"screen and (max-height: 360px)","tablet-small-breakpoint":"screen and (max-width: 428px)"}},AvGy:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));const r=i("qFKp").CheckMobile.any()},C9TK:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("YFKU"),s=i("VBos");async function o(t,e,i,o){if(!await Object(s.a)({title:Object(r.t)("Reverse {positionId} position?").replace("{positionId}",t),text:Object(r.t)("Are you sure you want to reverse {positionId} position?").replace("{positionId}",t)+(o?" "+Object(r.t)("This will also close all active orders."):""),mainButtonText:Object(r.t)("Reverse position"),mainButtonIntent:"primary",cancelButtonText:Object(r.t)("Cancel")}))return!1;try{return await i()}catch(t){return e(Object(r.t)("Failed to reverse position"),function(t){let e="";return null!==t&&"object"==typeof t&&t.message?e=t.message:"string"==typeof t&&(e=t),e}(t)),!1}}},"D/08":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72" width="72" height="72" fill="none"><g clip-path="url(#clip0)"><path fill="#363A45" fill-rule="evenodd" clip-rule="evenodd" d="M62.1259 28.2153C61.4066 28.8157 61.0001 29.7273 61.0858 30.6604C61.6716 37.0347 59.7763 44.3291 55.3181 50.8221C46.9016 63.0797 32.5383 67.839 23.2366 61.4522C13.935 55.0654 13.2174 39.9512 21.6339 27.6935C26.4984 20.6088 33.3496 16.029 40.0619 14.6585C40.9752 14.472 41.731 13.8291 42.1024 12.9741C42.485 12.0934 42.9606 11.2346 43.5313 10.4123C47.906 4.1093 56.2129 2.33004 62.0853 6.4382C67.9578 10.5464 69.172 18.9863 64.7974 25.2892C64.0194 26.4103 63.1169 27.3882 62.1259 28.2153Z"/><rect width="47.2" height="34" fill="#1E222D" stroke="#B2B5BE" stroke-width="2" rx="3.8" x="12.4004" y="16"/><path stroke="#B2B5BE" stroke-linecap="round" stroke-width="2" d="M3.59961 54H67.1996"/><path fill="#B2B5BE" fill-rule="evenodd" clip-rule="evenodd" d="M29.1178 31.1324L30.8107 32.8253L32.225 31.4111L30.5321 29.7182L32.225 28.0253L30.8107 26.6111L29.1178 28.304L27.425 26.6111L26.0107 28.0253L27.7036 29.7182L26.0107 31.4111L27.425 32.8253L29.1178 31.1324Z"/><path fill="#B2B5BE" fill-rule="evenodd" clip-rule="evenodd" d="M43.5182 31.1324L45.2111 32.8253L46.6253 31.4111L44.9325 29.7182L46.6253 28.0253L45.2111 26.6111L43.5182 28.304L41.8253 26.6111L40.4111 28.0253L42.104 29.7182L40.4111 31.4111L41.8253 32.8253L43.5182 31.1324Z"/><path stroke="#B2B5BE" stroke-width="2" d="M30.5996 38.7H40.7996"/></g></svg>'},E9hm:function(t,e,i){"use strict";i.r(e),i.d(e,"defaultConfigFlags",(function(){return r})),i.d(e,"applyDefaultsToConfigFlags",(function(){return s}));const r={isSuspended:!1,supportDemoLiveSwitcher:!0,supportEditAmount:!0,supportMarketBrackets:!0,supportMarketOrders:!0,supportStopOrders:!0,supportLimitOrders:!0,supportStopLimitOrders:!1,supportPositions:!0,supportDOM:!0,supportModifyOrder:!0,supportModifyTrailingStop:!0,supportAddBracketsToExistingOrder:!0,supportVerifyLiveAccount:!0,supportReversePosition:!0,showNotificationsLog:!0,supportTwoFactorAuthorization:!1,supportDisplayBrokerNameInSymbolSearch:!0};function s(t){return Object.assign({},r,t)}},ENbT:function(t,e,i){"use strict";e.noop=function(){}},EOiv:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i("fBig");class s{constructor(t,e={}){this._loadingEl=null,this._parentEl=t,this._options=e,this._renderLoading()}toggleVisibility(t){null!==this._loadingEl&&this._loadingEl.classList.toggle(r.shown,t)}_renderLoading(){this._loadingEl=document.createElement("span"),this._loadingEl.classList.add(r.loader),this._options.className&&this._loadingEl.classList.add(this._options.className),this._loadingEl.innerHTML=`\n\t\t\t<span class="${r.loaderItem}"></span>\n\t\t\t<span class="${r.loaderItem}"></span>\n\t\t\t<span class="${r.loaderItem}"></span>\n\t\t`,this._parentEl.appendChild(this._loadingEl)}}},End0:function(t,e,i){"use strict";i.r(e),i("bSeV");var r=i("YFKU"),s=i("Eyy1"),o=i("ivNn"),n=i("Hgre"),a=i("JES+"),c=i("8wgr"),l=i("U/Is"),u=i("aIyQ"),h=i.n(u),d=i("txPx"),p=i("5kf6");const b=Object(d.getLogger)("Trading.RealtimeProvider");class _{constructor(t){this._results={},this._getter=t}get(t){return this._results[t]||(this._results[t]=this._getter(t)),this._results[t]}}class m{constructor(t,e,i,r,s){this._stopped=!1,this._subscribed=!1,this._provider=null,this._formatters=null,this._symbol=t,this._type=s,this._callback=e,this._providersCache=i,this._formattersCache=r,"Realtime"===this._type?this._handler=(t,i)=>{this._stopped||e(t,i,this._formatters)}:this._handler=(t,i)=>{this._stopped||e(t,i)},this._start().catch((t=>{}))}symbol(){return this._symbol}type(){return this._type}callback(){return this._callback}destroy(){this._ensureNotStopped(),this._subscribed&&("Realtime"===this._type?Object(s.ensureNotNull)(this._provider).unsubscribeRealtime(this._symbol,this._handler):Object(s.ensureNotNull)(this._provider).unsubscribeDOME(this._symbol,this._handler)),this._stopped=!0}async _start(){this._provider=await this._providersCache.get(this._symbol),this._ensureNotStopped(),this._formatters=await this._formattersCache.get(this._symbol),Object(s.ensure)(this._formatters),this._ensureNotStopped(),this._subscribed=!0,"Realtime"===this._type?this._provider.subscribeRealtime(this._symbol,this._handler):this._provider.subscribeDOME(this._symbol,this._handler)}_ensureNotStopped(){Object(s.assert)(!this._stopped,"Should not be stopped")}}class g{constructor(t,e,i,r){this.onStatusChanged=new h.a,this._subscriptions=[],this._currentBroker=null,this._activeBrokerGetter=t,this._suggestedQty=r,e.subscribe(this,this._connectionStatusChanged),i.subscribe(this,this._connectionStatusChanged),this._tvProvider=new l.a("RealtimeProvider"),this._connectionStatusChanged()}isTradable(t){return this._tradableCache.get(t)}subscribeRealtime(t,e){this._subscriptions.some((i=>i.symbol()===t&&i.callback()===e&&"Realtime"===i.type()))||this._subscriptions.push(new m(t,e,this._providersCache,this._formattersCache,"Realtime"))}unsubscribeRealtime(t,e){const i=this._subscriptions.findIndex((i=>i.symbol()===t&&i.callback()===e&&"Realtime"===i.type()));-1!==i?(this._subscriptions[i].destroy(),this._subscriptions.splice(i,1)):b.logWarn("Subscription not found")}subscribeDOME(t,e){this._subscriptions.some((i=>i.symbol()===t&&i.callback()===e&&"Dome"===i.type()))||this._subscriptions.push(new m(t,e,this._providersCache,this._formattersCache,"Dome"))}unsubscribeDOME(t,e){const i=this._subscriptions.findIndex((i=>i.symbol()===t&&i.callback()===e&&"Dome"===i.type()));-1!==i?(this._subscriptions[i].destroy(),this._subscriptions.splice(i,1)):b.logWarn("Subscription not found")}formatter(t){return this._formattersCache.get(t).then((t=>t.formatter))}spreadFormatter(t){return this._formattersCache.get(t).then((t=>t.spreadFormatter))}quantityFormatter(t){return this._formattersCache.get(t).then((t=>t.quantityFormatter))}symbolInfo(t){if(!t){const t={minTick:NaN,qty:{min:NaN,max:NaN,step:NaN},pipValue:NaN,pipSize:NaN,description:"no symbol"};return Promise.resolve(t)}return this._providersCache.get(t).then((e=>e!==this._tvProvider?e.symbolInfo(t).then((e=>e||this._tvProvider.symbolInfo(t))).catch((e=>this._tvProvider.symbolInfo(t))):this._tvProvider.symbolInfo(t)))}quotesSnapshot(t){return this._providersCache.get(t).then((e=>e.quotesSnapshot(t)))}activeBroker(){return null!==this._currentBroker&&this._currentBroker!==this._tvProvider?this._currentBroker:null}_isTradable(t){if(null===this._currentBroker||this._currentBroker===this._tvProvider)return Promise.resolve({tradable:!1});try{return Object(p.a)(this._currentBroker.isTradable(t),6e4,"isTradable Promise Timeout").catch((()=>Promise.resolve({tradable:!1})))}catch(t){return Promise.resolve({tradable:!1})}}_haveRealtime(t){return this._tradableCache.get(t)||Promise.resolve(null===this._currentBroker)}_connectionStatusChanged(){const t=this._activeBrokerGetter(),e=this._currentBroker,i=t&&1===t.connectionStatus()?t:null;if(this._createCaches(),e!==i){const t=this._subscriptions.map((t=>({symbol:t.symbol(),callback:t.callback(),type:t.type()})));this._unsubscribeAll(),this._currentBroker=i,this._subscribeAll(t),this._allSymbols().forEach((t=>{this._suggestedQty.changed.fire(t)})),this.onStatusChanged.fire()}}_allSymbols(){const t=new Set;return this._subscriptions.forEach((e=>t.add(e.symbol()))),Array.from(t)}_createCaches(){this._providersCache=new _((t=>this._provider(t))),this._tradableCache=new _((t=>this._isTradable(t))),this._formattersCache=new _((t=>this._providersCache.get(t).then((e=>Promise.all([e.formatter(t,!1),e.spreadFormatter(t),e.quantityFormatter(t)]))).then((([t,e,i])=>({formatter:t,spreadFormatter:e,quantityFormatter:i})))))}_provider(t){return this._haveRealtime(t).then((t=>t.tradable&&this._currentBroker&&1===this._currentBroker.connectionStatus()?this._currentBroker:this._tvProvider))}_unsubscribeAll(){this._subscriptions.forEach((t=>{t.destroy()})),this._subscriptions=[]}_subscribeAll(t){t.forEach((t=>{this._subscriptions.push(new m(t.symbol,t.callback,this._providersCache,this._formattersCache,t.type))}))}}var f=i("2TBc");class y extends f.a{constructor(t){super(t),this._userId=(window.user.id||"").toString(),window.loginStateChange&&window.loginStateChange.subscribe(this,this._onLoginStateChange)}trackOrderPlaced(t){this._trackOrderEvent("Placed",t)}startService(){Object(s.ensure)(this.activeBroker()).orderUpdate.subscribe(this,this._orderUpdate),this._trackTradingBrokerConnnected()}stopService(){Object(s.ensure)(this.activeBroker()).orderUpdate.unsubscribe(this,this._orderUpdate)}_orderUpdate(t,e){e||(5===t.status?this._trackOrderEvent("Rejected",t):2===t.status?this._trackOrderEvent("Executed",t):1===t.status&&this._trackOrderEvent("Canceled",t))}_trackOrderEvent(t,e){const i=this.activeBroker();e&&i&&i.symbolInfo(e.symbol).then((i=>{const r={amount:e.qty*(i.lotSize||1),instrumentType:i.type,eventName:"Order "+t,userId:this._userId};this._trackTradingOrder(r)}))}_trackTradingOrder(t){if(!this.activeBroker())throw new Error("no active broker")}_trackTradingBrokerConnnected(){const t=this.activeBroker();if(null!==t&&t.metainfo().id,!t)throw new Error("no active broker")}_onLoginStateChange(){this._userId=(window.user.id||"").toString()}}var v=i("Vdly"),w=i("4qhP"),k=i("9pog"),P=i("1AAW"),B=i("hY0g"),C=i.n(B),O=i("PT1i"),S=i("JWMC"),E=i("+xnd"),T=i("QloM");function j(t="default"){switch(t){case"danger":return E.a.Danger;case"attention":return E.a.Warning;case"success":return E.a.Success;default:return E.a.Default}}class L{constructor(t){this._chartWidgetCollection=t}proSymbol(){return O.linking.proSymbol.value()}showTradingProperties(){this._chartWidgetCollection.activeChartWidget.value().showGeneralChartProperties(T.TabNames.trading)}async showNotification(t,e,i,r){const s=await this._chartWidgetCollection.getToasts();if(null===s)return;let o="";"string"==typeof e&&(o=e),s.showSimpleToast({text:o,time:r,title:t,intent:j(i)})}showMaintenance(t){}showBrokerSideMaintenance(t){}trackEvent(t,e,i){Object(S.trackEvent)(t,e,i)}showReplayConfirmationDialog(){return Promise.resolve()}reconnectChartApi(t){}setBroker(t){const e=(null==t?void 0:t.metainfo().backendBrokerName)||(null==t?void 0:t.metainfo().id.toLowerCase())||"";this._chartWidgetCollection.setBroker(e)}}var N=i("2uTr"),D=i("Kxc7"),A=i("mrSG"),I=i("3+Gi"),M=(i("HbRj"),i("5det"));async function x(t,e,i){if(!await Object(M.a)(window.t("Close position"),i,window.t("Close position"),window.t("Cancel")))return!1;try{return await e()}catch(e){return t(window.t("Failed to close the position"),function(t){let e="";return null!==t&&"object"==typeof t&&t.message?e=t.message:"string"==typeof t&&(e=t),e}(e)),!1}}var V=i("C9TK"),R=i("1rjR"),q=i("QBLL");async function U(t,e,r){const s=await async function(t){const{PartiallyClosingDialogRenderer:e}=await i.e("partially-closing-dialog-renderer").then(i.bind(null,"+BC+")),r=new e;return new Promise((e=>{r.open(Object.assign(Object.assign({},t),{dialogActionHandler:e}))}))}(t);if(!s.status)return!1;try{return await e(s.qty)}catch(t){return r(window.t("Failed to close the position"),function(t){let e="";return null!==t&&"object"==typeof t&&t.message?e=t.message:"string"==typeof t&&(e=t),e}(t)),!1}}var F=i("q1tI"),W=i.n(F),Q=i("EBrf");function H(t){const{symbol:e,side:i,qty:s,price:o,id:n,closePositionCancelsOrders:a}=t,c=Object(Q.splitThousands)(s," "),l=Object(Q.splitThousands)(o," ");return F.createElement(F.Fragment,null,F.createElement("div",null,void 0!==n?Object(r.t)("Position ID {id}").replace("{id}",n):Object(r.t)("Position")),F.createElement("div",null,F.createElement("b",null,e)),F.createElement("div",null,F.createElement("b",null,`${i} ${c} @ ${l}`)),F.createElement("div",null,a&&" "+Object(r.t)("This will also close all active orders")))}i("4hvi");var z=i("0W4x");const $=Object(d.getLogger)("Trading.BrokerCommandsUI"),K={symbol:1,qty:1,side:1,type:1,seenPrice:1};class G{constructor(t,e,i,r,s,o){this._isClosePositionDialogLoading=!1,this._isCloseTradeDialogLoading=!1,this._activeBroker=t,this._guiAccessor=e,this._orderViewController=r,this._showErrorNotification=s,this._noConfirmEnabled=i,this._trackEvent=o}async placeOrder(t,e,i){var r;this._makeSureBrokerIsConnected();const s=e&&this._noConfirmEnabled.value(),o=this._guiAccessor&&s?this._guiAccessor.showReplayConfirmationDialog():Promise.resolve(!1);try{await o}catch(t){Promise.resolve(!1)}const n=await this._activeBroker.isTradable(t.symbol);if(s&&n.tradable&&function(t){for(const e in K)if(!(e in t))return!1;return!0}(t)){const e=this._activeBroker.metainfo().durations;return void 0===t.duration&&void 0!==e&&e.length>0&&(t.duration=null!==(r=Object(w.f)(t.type,e))&&void 0!==r?r:{type:e[0].value}),this._activeBroker.placeOrder(t)}{const e=this._activeBroker.metainfo();if(e.customUI&&void 0!==e.customUI.showOrderDialog)return e.customUI.showOrderDialog(t)}return this._orderViewController().then((e=>this._activeBroker?e.showOrderView(this._activeBroker,t,void 0,i):Promise.reject("Broker connection adapter is null")))}async modifyOrder(t,e,i,r){if(this._makeSureBrokerIsConnected(),t.flags&&t.flags.trailingStop)return $.logError("Attempt to modify trailing stop loss order"+t.id),this._showErrorNotification(window.t("Cannot Modify Order"),window.t("Trailing Stops cannot be modified")),Promise.resolve(!1);const s=await this._activeBroker.symbolInfo(t.symbol);t.limitPrice=void 0!==s.limitPriceStep&&void 0!==t.limitPrice?Object(z.k)(t.limitPrice,s.limitPriceStep,1,t.side):t.limitPrice,t.stopPrice=void 0!==s.stopPriceStep&&void 0!==t.stopPrice?Object(z.k)(t.stopPrice,s.stopPriceStep,2,t.side):t.stopPrice;const o=t.limitPrice,n=t.stopPrice,a=t.stopType,c=e&&this._noConfirmEnabled.value();let l=i||(1===t.type?1:2);if(t.parentId&&!D.enabled("always_pass_called_order_to_modify")){let e,r=this._activeBroker.orderById.bind(this._activeBroker);2===t.parentType&&(r=this._activeBroker.positionById.bind(this._activeBroker)),3===t.parentType&&(r=this._activeBroker.tradeById.bind(this._activeBroker));try{e=await r(t.parentId)}catch(t){e=void 0}if(e){l=i||(1===t.type?3:4);const r={takeProfit:o};if(a===I.a.TrailingStop?r.trailingStopPips=t.trailingStopPips:r.stopLoss=n,c&&(r.takeProfit=r.takeProfit||e.takeProfit,r.stopLoss=r.stopLoss||e.stopLoss,r.trailingStopPips=r.trailingStopPips||e.trailingStopPips),3===t.parentType)return c?this._activeBroker.editTradeBrackets(e.id,r):this._showTradeDialog(e,r,l);if(2===t.parentType&&t.qty===Math.abs(e.qty))return c?this._activeBroker.editPositionBrackets(e.id,r):this._showPositionDialog(e,r,l);const s=e;Object(w.h)(s.status)&&(t=Object.assign({},s),o&&(t.takeProfit=o),n&&(a===I.a.TrailingStop?t.trailingStopPips=r.trailingStopPips||t.trailingStopPips:t.stopLoss=n))}}if(c)return this._activeBroker.modifyOrder(t);{const e=this._activeBroker.metainfo();if(e.customUI&&void 0!==e.customUI.showOrderDialog)return e.customUI.showOrderDialog(t,l)}return this._orderViewController().then((e=>this._activeBroker?e.showOrderView(this._activeBroker,t,l,r):Promise.reject("Broker connection adapter is null")))}async closePosition(t){if(this._makeSureBrokerIsConnected(),this._noConfirmEnabled.value())return this._activeBroker.closePosition(t);{if(this._isClosePositionDialogLoading)return!1;const e=await this._obtainPositionClosingData(t);if(void 0===e)return!1;const{supportPartialClosePosition:i,position:r}=e,s=Object(A.a)(e,["supportPartialClosePosition","position"]);if(i){const i=i=>(i!==e.position.qty?this._trackEvent("","Close Position Dialog","partial"):this._trackEvent("","Close Position Dialog","full"),this._activeBroker.closePosition(t,i));return U(Object.assign(Object.assign({},s),{positionOrTrade:r}),i,this._showErrorNotification)}{const i=()=>this._activeBroker.closePosition(t);return x(this._showErrorNotification,i,e.message)}}}async closeTrade(t){if(this._makeSureBrokerIsConnected(),Object(s.assert)(!!this._activeBroker.config.supportTrades,"Broker doesn`t support trades"),this._noConfirmEnabled.value())return this._activeBroker.closeTrade(t);{if(this._isCloseTradeDialogLoading)return!1;const e=await this._obtainTradeClosingData(t);if(void 0===e)return!1;const{supportPartialCloseTrade:i,trade:r}=e,s=Object(A.a)(e,["supportPartialCloseTrade","trade"]);if(i){const e=async e=>(e!==r.qty?this._trackEvent("","Close Trade Dialog","partial"):this._trackEvent("","Close Trade Dialog","full"),this._activeBroker.closeTrade(t,e));return U(Object.assign(Object.assign({},s),{positionOrTrade:r}),e,this._showErrorNotification)}{const i=()=>this._activeBroker.closeTrade(t);return x(this._showErrorNotification,i,e.message)}}}editPositionBrackets(t,e,i,r){return this._makeSureBrokerIsConnected(),Object(s.assert)(!!this._activeBroker.config.supportPositionBrackets,"Broker doesn`t support brackets on positions"),r?Object(s.ensureDefined)(this._activeBroker.editPositionBrackets)(t,e):this._activeBroker.positionById(t).then((t=>this._activeBroker?this._showPositionDialog(Object(s.ensureDefined)(t),e,i):Promise.reject("Broker connection adapter is null")))}editTradeBrackets(t,e={},i,r){return r&&this._noConfirmEnabled.value()?this._activeBroker.editTradeBrackets(t):this._activeBroker.tradeById(t).then((t=>{if(!this._activeBroker)return Promise.reject("Broker connection adapter is null");const r=Object(s.ensureDefined)(t);return this._showTradeDialog(r,e,i)}))}reversePosition(t){return this._makeSureBrokerIsConnected(),this._activeBroker.metainfo().configFlags.supportMultiposition&&!this._activeBroker.config.supportNativeReversePosition?Promise.reject("Cannot reverse position on multiposition acount"):this._noConfirmEnabled.value()?this._activeBroker.reversePosition(t):this._activeBroker.positionById(t).then((e=>{if(!this._activeBroker)return Promise.reject("Broker connection adapter is null");const i=this._activeBroker.reversePosition.bind(this._activeBroker,t);return Object(V.a)(t,this._showErrorNotification,i,this._activeBroker.config.closePositionCancelsOrders)}))}async cancelOrder(t){if(this._makeSureBrokerIsConnected(),this._noConfirmEnabled.value())return this._activeBroker.cancelOrder(t);{const e=await this._activeBroker.orderById(t),i=this._activeBroker.cancelOrder.bind(this._activeBroker,t);if(e){if(e.parentId){const t=(await this._activeBroker.orders()).filter((t=>t.refNumber===e.refNumber));return this._activeBroker.metainfo().configFlags.supportCancellingBothBracketsOnly&&t.length>1?this._showCancelMultipleBracketsDialog(e.parentId,i):this._showCancelBracketsDialog(e.id,i)}return this._showCancelOrderDialog(e.id,i)}return Promise.reject("Failed to find order")}}cancelOrders(t,e){return this._makeSureBrokerIsConnected(),this._activeBroker.orders().then((i=>{if(!this._activeBroker)return Promise.reject("Broker connection adapter is null");const r=i.filter((i=>i.symbol===t&&(!e||i.side===e)&&function(t){return 4===t.status||3===t.status||6===t.status}(i)));if(!r.length)return Promise.resolve(!1);if(1===r.length)return this.cancelOrder(r[0].id);const s=r.map((t=>t.id));if(this._noConfirmEnabled.value())return this._activeBroker.cancelOrders(t,e,s);{const i=this._activeBroker.cancelOrders.bind(this._activeBroker);return this._showCancelMultipleOrdersDialog(t,e,s,i)}}))}_makeSureBrokerIsConnected(){Object(s.assert)(1===this._activeBroker.connectionStatus(),"Broker is not connected")}async _showPositionDialog(t,e={},i){const r=await this._activeBroker.isTradable(t.symbol);if(!r.tradable){const e=void 0!==r.reason?r.reason:window.t("Symbol {symbol} cannot be traded through {broker}.").format({symbol:t.symbol,broker:this._activeBroker.metainfo().title});return this._showErrorNotification(window.t("Cannot protect position"),e),Promise.resolve(!1)}{const r=this._activeBroker.metainfo();if(r.customUI&&void 0!==r.customUI.showPositionDialog)return r.customUI.showPositionDialog(t,{stopLoss:e.stopLoss||t.stopLoss,takeProfit:e.takeProfit||t.takeProfit},i)}return this._orderViewController().then((r=>this._activeBroker?r.showPositionView(this._activeBroker,t,{stopLoss:e.stopLoss,takeProfit:e.takeProfit,trailingStopPips:e.trailingStopPips},i||t.limitPrice&&3||t.stopPrice&&4):Promise.reject("Broker connection adapter is null")))}_showTradeDialog(t,e={},i){{const r=this._activeBroker.metainfo();if(r.customUI&&void 0!==r.customUI.showPositionDialog)return r.customUI.showPositionDialog(t,{stopLoss:e.stopLoss||t.stopLoss,takeProfit:e.takeProfit||t.takeProfit},i)}return this._orderViewController().then((r=>this._activeBroker?r.showTradeView(this._activeBroker,t,{stopLoss:e.stopLoss,takeProfit:e.takeProfit,trailingStopPips:e.trailingStopPips},i||t.limitPrice&&3||t.stopPrice&&4):Promise.reject("Broker connection adapter is null")))}_isMaintenance(){return isFeatureEnabled(Object(w.j)(this._activeBroker.metainfo().id))}_isBrokerSideMaintenance(){return isFeatureEnabled(Object(w.i)(this._activeBroker.metainfo().id))}_showCancelOrderDialog(t,e){return R.a.get().open(t).then((i=>i?e(t):Promise.resolve(!1)))}_showCancelMultipleOrdersDialog(t,e,i,r){const s=i.length;return R.a.get().multiple(t,e,s).then((s=>s?r(t,e,i):Promise.resolve(!1)))}async _showCancelBracketsDialog(t,e){return q.a.get().open(t).then((i=>i?e(t):Promise.resolve(!1)))}_showCancelMultipleBracketsDialog(t,e){return q.a.get().multiple(t).then((i=>i?e(t):Promise.resolve(!1)))}async _obtainPositionClosingData(t){try{this._isClosePositionDialogLoading=!0;const e=Object(s.ensureDefined)(await this._activeBroker.positionById(t)),{supportLots:i,qtyStep:r,minQty:o,qtyFormatter:n,priceFormatter:a}=await this._obtainPositionOrTradeClosingCommonData(e),c=this._activeBroker.metainfo().configFlags.supportPartialClosePosition,l=H({symbol:e.symbol,side:1===e.side?window.t("Long"):window.t("Short"),qty:n.format(e.qty),price:a.format(e.avgPrice),closePositionCancelsOrders:this._activeBroker.config.closePositionCancelsOrders});return this._isClosePositionDialogLoading=!1,{position:e,supportLots:i,qtyStep:r,minQty:o,supportPartialClosePosition:c,qtyFormatter:n,message:l}}catch(t){return void(this._isClosePositionDialogLoading=!1)}}async _obtainTradeClosingData(t){try{this._isCloseTradeDialogLoading=!0;const e=Object(s.ensureDefined)(await this._activeBroker.tradeById(t)),{supportLots:i,qtyStep:r,minQty:o,qtyFormatter:n,priceFormatter:a}=await this._obtainPositionOrTradeClosingCommonData(e),c=this._activeBroker.metainfo().configFlags.supportPartialCloseTrade,l=H({symbol:e.symbol,side:1===e.side?window.t("Long"):window.t("Short"),qty:n.format(e.qty),price:a.format(e.price),id:t,closePositionCancelsOrders:this._activeBroker.config.closePositionCancelsOrders});return this._isCloseTradeDialogLoading=!1,{trade:e,supportLots:i,qtyStep:r,minQty:o,supportPartialCloseTrade:c,qtyFormatter:n,message:l}}catch(t){return void(this._isCloseTradeDialogLoading=!1)}}async _obtainPositionOrTradeClosingCommonData(t){const e=await this._activeBroker.symbolInfo(t.symbol);return{supportLots:void 0!==e.lotSize,qtyStep:e.qty.step,minQty:e.qty.min,qtyFormatter:await this._activeBroker.quantityFormatter(t.symbol),priceFormatter:await this._activeBroker.formatter(t.symbol,!1)}}}var J=i("N22A");class Z{constructor(t,e){this._domePanel=null,this._resizerBridge=t,this._close=()=>{this.unmount(),e()}}mount(){return this._getDomPanel().then((t=>{t.setVisibility(!0)}))}unmount(){this._getDomPanel().then((t=>{t.setVisibility(!1)}))}async _getDomPanel(){if(null!==this._domePanel)return Promise.resolve(this._domePanel);const t=await Promise.all([i.e(4),i.e(14),i.e(18),i.e(22),i.e(26),i.e(56),i.e(63),i.e(67),i.e(91),i.e(110),i.e(3),i.e(7),i.e(17),i.e(29),i.e(53),i.e(52),i.e(83),i.e("dome-panel")]).then(i.bind(null,"nr7h")),e=await Object(J.waitTradingService)(),r=new t.DomePanel(e,this._resizerBridge);return r.setCloseHandler(this._close),this._domePanel=r,r}}class Y{mount(){return Promise.resolve()}unmount(){}}var X=i("vOQ2"),tt=i("/BH3"),et=i("6aj4");const it=D.enabled("show_order_panel_on_start");class rt{constructor(t){this.isOpened=new C.a(!1),this.isAvailable=new C.a(!0),this.activePage=new C.a(it?X.d.OrderPanel:X.d.DomPanel),this.isLoading=new C.a(!1),this._pages={},this._width=X.c,this._onLayoutResizeHandleMousedown=t=>{if(t.defaultPrevented||!t.cancelable)return;t.preventDefault();const e=Math.max(this._resizerBridge.width.value(),0);let i;i="touches"in t?t.touches[0].clientX:t.clientX;const r=t=>{let r;t.preventDefault(),r="touches"in t?t.touches[0].clientX:t.clientX;let s=e-(r-i);s<X.c?s=X.c:s>X.a&&(s=X.a),this._requestWidth(s)},s=()=>{document.removeEventListener("mousemove",r),document.removeEventListener("touchmove",r),document.removeEventListener("mouseup",s),document.removeEventListener("touchend",s),v.setValue(c.a.PANEL_WIDTH,this._width)};document.addEventListener("mousemove",r),document.addEventListener("touchmove",r,{passive:!1}),document.addEventListener("mouseup",s),document.addEventListener("touchend",s,{passive:!1})},this._resizerBridge=t,this._rootContainer=this._resizerBridge.container.value(),this.container=document.createElement("div"),this.container.classList.add(et["trading-panel-content"],"trading-panel-content"),this._rootContainer.appendChild(this.container),this._addSpinner(),this._addResizeHandler(),this._updateAvailable({width:this._resizerBridge.availWidth.value(),height:this._resizerBridge.availHeight.value()}),Object(P.combine)(((t,e)=>({width:t,height:e})),this._resizerBridge.availWidth,this._resizerBridge.availHeight).subscribe(this._updateAvailable.bind(this)),this.isLoading.subscribe(this._setLoading.bind(this)),this._rootContainer.style.overflow=this.isOpened.value()?"":"hidden"}addPage(t,e){this._pages[t]=e}isPageOpened(t){return this.isOpened.value()&&this.activePage.value()===t}setPage(t){this.isOpened.value()&&this.activePage.value()!==t&&this._pages[this.activePage.value()]&&this._pages[this.activePage.value()].unmount(),this.activePage.setValue(t),v.setValue(c.a.TRADING_PANEL_ACTIVE_PAGE,t)}openPage(t){this.setPage(t),this.open()}open(){this._pages[this.activePage.value()]&&(this._togglePanel(!0),this.isOpened.setValue(!0),this._pages[this.activePage.value()].mount())}close(){this.isOpened.setValue(!1),this._pages[this.activePage.value()]&&this._pages[this.activePage.value()].unmount(),this._togglePanel(!1)}_setLoading(t){t?this._rootContainer.appendChild(this._spinnerContainer):this._rootContainer.contains(this._spinnerContainer)&&this._rootContainer.removeChild(this._spinnerContainer)}_addSpinner(){this._spinnerContainer=document.createElement("div"),this._spinnerContainer.classList.add(et["trading-panel-spinner"]),i.e("spinner-renderer").then(i.bind(null,"lG9f")).then((t=>{t.render(this._spinnerContainer)}))}_addResizeHandler(){this._handle=document.createElement("div"),this._handle.classList.add(et["trading-panel-handle"]),this._rootContainer.appendChild(this._handle),this._handle.addEventListener("mousedown",this._onLayoutResizeHandleMousedown,{passive:!1}),this._handle.addEventListener("touchstart",this._onLayoutResizeHandleMousedown,{passive:!1}),this._width=v.getInt(c.a.PANEL_WIDTH)||X.c}_togglePanel(t){this._resizerBridge.negotiateWidth(t?this._width:0),this._resizerBridge.negotiateHeight(t?X.b:0),this._rootContainer.style.overflow=t?"":"hidden",v.setValue(c.a.TRADING_PANEL_OPENED,t)}_updateAvailable(t){this.isAvailable.setValue(t.width>=X.c&&t.height>=X.b)}_requestWidth(t){this._canOpen(t)&&this._resizerBridge.width.value()!==t&&(this._resizerBridge.negotiateWidth([{min:X.c,max:t}]),this._width=t)}_canOpen(t){return t+tt.tabsWidth<=this._resizerBridge.availWidth.value()}}var st=i("lxNp"),ot=i("hbEN"),nt=i("dOnf"),at=i("mNbo"),ct=i("+J+G");const lt=Object(d.getLogger)("Lib.Sound",{color:"#dea433"}),ut=[{title:window.t("Alarm Clock"),path:"alert/alarm_clock",soundForAlerts:!0,filePath:ct}],ht={};function dt(t){if(Object(at.a)("any"))return;if(!t)return;if(!/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(window.navigator.userAgent))return;if(Array.isArray(t)||(t=[t]),0===(t=t.filter((t=>{const e=pt(t);return!(!e||!e.el.load||e._mobilePreloadActive||(e._mobilePreloadActive=!0,0))}))).length)return void lt.logNormal("enableForMobile no sounds passed");const e=()=>{const r=[];Array.isArray(t)&&t.forEach((t=>{const e=pt(t);e.el.load();const i=e.play().catch((t=>{if("AbortError"!==t.name)throw lt.logError(`enableForMobile for "${e.el.src}" preload error: - ${t.message}`),t}));e.el.pause(),r.push(i)})),Promise.all(r).then((()=>{lt.logNormal("enableForMobile sounds initialized")})),i.forEach((t=>{document.removeEventListener(t,e,!0)}))},i=["click","touchend","keydown"];i.forEach((t=>{document.addEventListener(t,e,!0)}))}const pt=t=>{if(t in ht)return ht[t];lt.logNormal(`requested sound  ${t} not cached, building a new audio element`);const e=ut.find((e=>e.path===t));if(void 0===e)throw new Error(`Cannot find sound "${t}"`);const i=new Audio(e.filePath),r={el:i,playing:new C.a(!1),play:(e=0)=>r.playing.value()?(lt.logNormal("sound already playing"),Promise.reject("already playing")):(r.playing.setValue(!0),new Promise(((i,s)=>{let o=e>0;const n=()=>{(function(t){try{lt.logNormal(`"${t.el.src}" triggering html5 play method, readyState - ${t.el.readyState}; muted - ${t.el.muted}; volume - ${t.el.volume}; currentTime - ${t.el.currentTime}`);let e=t.el.play();return e||(e=Promise.resolve()),e}catch(e){return lt.logError(`play method for "${t.el.src}" catch error - ${e.message}`),Promise.reject(e)}})(r).catch((e=>{lt.logNormal(`stop counting sound "${t}"; as playing due to an error: ${e.message}`),r.stop(),s(e)}))};r._onEnded=()=>{o?n():(r.stop(),i())},r.el.addEventListener("ended",r._onEnded),o&&setTimeout((()=>{lt.logNormal(`"${t}" repeat timeout - ${e}s off`),o=!1}),1e3*e),n()}))),stop:()=>{r.el.pause(),r.playing.setValue(!1),r._onEnded&&r.el.removeEventListener("ended",r._onEnded)}};return ht[t]=r,["canplaythrough","error"].forEach((e=>{i.addEventListener(e,(()=>{lt.logNormal(`for sound "${t}", event - ${e} is fired`)}),!1)})),lt.logNormal("canPlayType - "+i.canPlayType("audio/mp3")),ht[t]};dt(ut.filter((t=>!!t.common)).map((t=>t.path)));var bt=i("IWXC");const _t=["qty","stopPrice","limitPrice","status","filledQty"];function mt(t,e){return t.enabled.value()&&(e.soundName=t.name),e}function gt(t){return 6===t||3===t}class ft extends f.a{constructor(t){super(t),this._orders=[],this._playSound=Object(ot.default)(this._playSoundImpl,50),dt(ut.filter((t=>!!t.soundForAlerts)).map((t=>t.path)))}startService(){const t=Object(s.ensure)(this.activeBroker());t.orders().then((t=>this._orders=Object(nt.deepCopy)(t))),t.orderUpdate.subscribe(this,this._orderUpdate)}stopService(){Object(s.ensure)(this.activeBroker()).orderUpdate.unsubscribe(this,this._orderUpdate)}_showNotification(t,e,i){D.enabled("trading_notifications")&&("error"===i?this.trading().showErrorNotification(t,e):this.trading().showSuccessNotification(t,e))}_formatter(t){return Object(bt.getQuoteSessionInstance)("simple").formatter(t)}_checkOrderModified(t,e){const i=this.activeBroker(),r=i&&i.metainfo().customNotificationFields||[],s=_t.concat(r);let o=!1;return s.forEach((i=>{o||function t(e,i,r){if(void 0===e||void 0===i)return!1;const s=r.indexOf(".");if(-1!==s){const o=r.substring(0,s);return t(e[o],i[o],r.substring(s+1))}return e[r]===i[r]}(t,e,i)||(o=!0)})),o}_generateNotificationsInfo(t,e){const i=[],r=t.statusMessage?": "+t.statusMessage:"",s=(1===t.side?window.t("Bought"):window.t("Sold")).toUpperCase(),o=this.trading().orderExecutedSoundParams;return e?(this._checkOrderModified(t,e)&&(1===t.status?i.push({text:window.t("cancelled"),notificationType:1}):5===t.status?i.push({text:window.t("rejected")+r,type:"error",notificationType:2}):2===t.status?i.push(mt(o,{side:s,text:window.t("executed"),notificationType:6})):e.filledQty!==t.filledQty?i.push(mt(o,{side:s,text:window.t("executed partially"),notificationType:4})):gt(t.status)&&i.push({text:window.t("modified"),notificationType:5})),Object.assign(e,t)):gt(t.status)?(this._orders.push(t),i.push({text:window.t("placed"),notificationType:0}),this.trading().trackEvent("","Order placed symbol",t.symbol)):1===t.status?i.push({text:window.t("cancelled"),notificationType:1}):5===t.status?(this._orders.push(t),i.push({text:window.t("rejected")+r,type:"error",notificationType:2})):2===t.status&&(this._orders.push(t),i.push({text:window.t("placed"),notificationType:0},mt(o,{side:s,text:window.t("executed"),emptyOrderType:!0,notificationType:6})),this.trading().trackEvent("","Order placed symbol",t.symbol)),i}_orderUpdate(t,e){const i=Object(nt.deepCopy)(t),r=this._orders.find((t=>t.id===i.id));if(e)return void(void 0===r&&this._orders.push(i));if(r&&Object(z.e)(r.status))return;const s=this._generateNotificationsInfo(i,r);0!==s.length&&this._formatter(i.symbol).then((t=>{const e=Object(z.l)(i.side,!0),r=i.qty,o=void 0!==i.filledQty&&i.filledQty>0?i.filledQty:void 0;let n="",a="";switch(i.type){case 2:n=i.avgPrice?" ("+Object(z.i)(i.type)+")":"",a=i.avgPrice?t.format(i.avgPrice):Object(z.i)(i.type);break;case 4:n=" "+window.t("(Limit) after {0} (Stop) crossed").format(t.format(i.stopPrice)),a=t.format(i.avgPrice||i.limitPrice);break;default:n=" ("+Object(z.i)(i.type)+")",a=t.format(i.avgPrice||i.limitPrice||i.stopPrice)}const c=void 0!==i.message?`${i.message.text.charAt(0).toUpperCase()}${i.message.text.substr(1)}`:"";s.forEach((({text:t,type:s,side:l,emptyOrderType:u,soundName:h,notificationType:d})=>{const p=4===d&&void 0!==o?o:r,b=Object(Q.splitThousands)(Math.abs(p)," ")+" "+(i.brokerSymbol||i.symbol)+" "+window.t("at")+" "+a,_=`${window.t("Order")} ${i.id} ${t}`,m=`${l||e} ${b} ${u?"":n}\n${c}`;void 0!==h&&this._playSound(h),this._showNotification(_,m,s)}))}))}_playSoundImpl(t){if(this._playingSound){if(this._playingSound===t)return;!function(t){if(Object(at.a)("any"))return;let e=[];t?e.push(pt(t)):e=Object.values(ht),e.forEach((t=>{t.stop()}))}(this._playingSound)}this._playingSound=t,function(t="notification/notification",e){Object(at.a)("any")?Promise.resolve():(lt.logNormal(`Sound play attempt for "${t}" duration-${e}s;`),pt(t).play(e))}(t),function(t,e){Object(at.a)("any")||pt(t).playing.subscribe((t=>{t||e()}),{once:!0})}(t,(()=>{delete this._playingSound}))}}var yt=i("fZEr"),vt=i("VBos"),wt=i("pPtI");let kt=0;class Pt{constructor(t,e,i,r,s){this._currentPointsetId=null,this._onUpdate=new h.a,this._requestPoints=[],this._gateway=t,this._pointsetSuffix=e,this._isGatewayConnected=this._gateway.isConnected().spawn(),this._isGatewayConnected.subscribe(this._updateByGatewayConnection.bind(this)),this._addPoints(i,r,s)}onUpdate(){return this._onUpdate}destroy(){this._isGatewayConnected.value()&&null!==this._currentPointsetId&&this._gateway.removePointset(this._currentPointsetId),this._requestPoints=[],this._currentPointsetId=null,this._isGatewayConnected.destroy()}_updateByGatewayConnection(t){t||(this._currentPointsetId=null,this._requestPoints=[])}_addPoints(t,e,i){this._isGatewayConnected.value()&&(Object(s.assert)(t.length>0,"Can't possible create point set for empty array of time points"),this._requestPoints=t.map((t=>[t.time_t,t.offset])),this._currentPointsetId=`pointset_${this._pointsetSuffix}_${++kt}`,this._gateway.createPointset(this._currentPointsetId,"turnaround",e,Object(wt.getServerInterval)(i),this._requestPoints,this._dataUpdate.bind(this)))}_dataUpdate(t){const e=[];for(const i of t.params.plots)e.push({time_t:this._requestPoints[i.index][0],index:i.value[0],barTime:i.value[1]});this._onUpdate.fire(e)}}var Bt=i("GOhO");function Ct(t){const e=t.mainSeries().data().first();return null===e?null:e.value[0]}var Ot=i("ogJP");const St=Object(d.getLogger)("Trading.Positions");function Et(t){const e=null===t?0:Math.round(100*t)/100;return e>0?"positive":e<0?"negative":"neutral"}class Tt extends f.a{constructor(){super(...arguments),this._positions=new Map,this._positionUpdate=new h.a,this._positionsRemoved=new h.a,this._displayMode=1,this._updatePositionPLHandler=this._updatePositionPL.bind(this)}destroy(){this.stopService()}positions(){return Array.from(this._positions.values())}find(t){return this._positions.get(t)||null}positionUpdate(){return this._positionUpdate}positionsRemoved(){return this._positionsRemoved}isDisplayModeTrades(){return 0===this._displayMode}async getCurrency(t){const e=Object(s.ensureNotNull)(this.activeBroker());try{const i=await e.symbolInfo(t);if(e.metainfo().configFlags.positionPLInInstrumentCurrency&&void 0!==i.currency)return i.currency;const r=await e.accountMetainfo();return Object(w.e)(i,r,!0)}catch(t){return""}}stopService(){this._clearPositions();const t=Object(s.ensureNotNull)(this.activeBroker());this.isDisplayModeTrades()?t.tradeUpdate.unsubscribeAll(this):t.positionUpdate.unsubscribeAll(this)}startService(){this._clearPositions(),this._displayMode=function(t){if(null===t)return 1;const e=t.metainfo().configFlags;return e.supportTrades?e.supportPositionBrackets?1:e.supportCloseTrade?0:1:1}(this.activeBroker()),this._requestPositions()}_clearPositions(){const t=Object(s.ensureNotNull)(this.activeBroker()),e=Array.from(this._positions.keys());for(const i of e)this.isDisplayModeTrades()?t.unsubscribeTradePL(i,this._updatePositionPLHandler):t.unsubscribePL(i,this._updatePositionPLHandler);this._positions.clear(),this._positionsRemoved.fire(e)}async _requestPositions(){const t=this.activeBroker();if(!t)return;const e=this.isDisplayModeTrades(),i=await(e?t.trades():t.positions());for(const t of i)this._addPosition(t);e?t.tradeUpdate.subscribe(this,this._addPosition):t.positionUpdate.subscribe(this,this._addPosition)}_addPosition(t){const e=t.id,i=this._positions.has(e),r=Object(s.ensureNotNull)(this.activeBroker());St.logDebug("Update position. Symbol:"+t.symbol+" , qty:"+t.qty);const o=this.isDisplayModeTrades();if(!t.qty)return void(i&&(o?r.unsubscribeTradePL(e,this._updatePositionPLHandler):r.unsubscribePL(e,this._updatePositionPLHandler),this._positions.delete(e),this._positionsRemoved.fire([e])));const n=this._getPositionData(t);this._positions.set(e,n),this._positionUpdate.fire(n),i||(o?r.subscribeTradePL(e,this._updatePositionPLHandler):r.subscribePL(e,this._updatePositionPLHandler))}_updatePositionPL(t,e){const i=Object(s.ensureDefined)(this._positions.get(t));i.pl=Object(Ot.isNumber)(e)?e:null,i.profitState=Et(e),this._positionUpdate.fire(i)}_getPositionData(t){const e=Object(s.ensureNotNull)(this.activeBroker()).metainfo().configFlags,i=this._positions.get(t.id),r=this.isDisplayModeTrades();let o="neutral";const n=t.pl||i&&i.pl||null;return null!==n&&(o=Et(n)),Object.assign(Object.assign(Object.assign({},void 0!==i?i:{}),t),{pl:n,price:Math.abs(r?t.price:t.avgPrice),qtyBySide:Math.abs(t.qty)*(1===t.side?1:-1),profitState:o,supportClose:Boolean(r?e.supportCloseTrade&&t.canBeClosed:e.supportClosePosition),supportReverse:Boolean(!r&&e.supportReversePosition),supportBrackets:Boolean(r?e.supportTradeBrackets:e.supportPositionBrackets)})}}const jt=Object(d.getLogger)("Trading.OrderSource");class Lt extends f.a{constructor(){super(...arguments),this._activeOrders=new Map,this._activeOrderUpdate=new h.a,this._activeOrdersRemoved=new h.a}destroy(){this.stopService()}orders(){return Object(s.ensureNotNull)(this.activeBroker()).orders()}find(t){return this._activeOrders.get(t)||null}activeOrders(){return Array.from(this._activeOrders.values())}activeOrdersUpdated(){return this._activeOrderUpdate}activeOrdersRemoved(){return this._activeOrdersRemoved}stopService(){this._clearOrders(),Object(s.ensureNotNull)(this.activeBroker()).orderUpdate.unsubscribeAll(this)}startService(){this._clearOrders(),this._requestOrders()}_clearOrders(){const t=Array.from(this._activeOrders.keys());this._activeOrders.clear(),this._activeOrdersRemoved.fire(t)}async _requestOrders(){const t=this.activeBroker();if(!t)return;const e=await t.orders();for(const t of e)this._addActiveOrder(t);t.orderUpdate.unsubscribeAll(this),t.orderUpdate.subscribe(this,this._addActiveOrder)}_addActiveOrder(t){if(2===t.type)return;const e=t.id,i=this._activeOrders.has(e);if(6!==t.status&&3!==t.status)return void(i&&(this._activeOrders.delete(e),this._activeOrdersRemoved.fire([e])));const r=this._getOrderData(t);this._activeOrders.set(e,r),this._activeOrderUpdate.fire(r)}_getOrderData(t){const e=Object(s.ensureNotNull)(this.activeBroker()).metainfo().configFlags,i=this._activeOrders.get(t.id),r=function(t){return 1===t.type?Object(s.ensureDefined)(t.limitPrice):Object(s.ensureDefined)(t.stopPrice)}(t);return Object(Ot.isNumber)(r)||jt.logError("order price is not defined"),Object.assign(Object.assign(Object.assign({},void 0!==i?i:{}),t),{price:r,isActive:6===t.status,considerFilledQty:!0,supportModify:Boolean(e.supportModifyOrder&&(e.supportTrailingStop&&e.supportModifyTrailingStop||t.stopType!==I.a.TrailingStop))})}}var Nt=i("QfUd"),Dt=i("kcTO");const At=window.t("A broker is not connected"),It=window.t("This symbol can't be traded through this broker"),Mt=window.t("No bids"),xt=window.t("No asks"),Vt=window.t("Buy Market"),Rt=window.t("Sell Market"),qt=window.t("Spread"),Ut=window.t("Amount"),Ft=window.t("Quantity"),Wt=D.enabled("broker_button");class Qt{constructor(t,e,i,r){this.ask=new C.a(null),this.askTooltip=new C.a(Vt),this.bid=new C.a(null),this.bidTooltip=new C.a(Rt),this.spread=new C.a(null),this.spreadTooltip=new C.a(qt),this.qty=new C.a(null),this.qtyTooltip=new C.a(""),this.brokerIconVisible=new C.a(!1),this.brokerIconUrl=new C.a(null),this.isQtyVisible=new C.a(!1),this.hasAskBidAdditionalPrecision=new C.a(!1),this.canTrade=new C.a(!0),this._globalVisibility=null,this._isSymbolTradableResult=new Nt.a(null),this._formatter=null,this._spreadFormatter=null,this._symbol=null,this._dataEvents=t,this._getSymbolName=e,this._realtimeProvider=i.realtimeProvider,this._suggestedQty=i.suggestedQty,this._onNeedSelectBroker=i.onNeedSelectBroker,this._toggleTradingWidget=i.toggleTradingWidget,this._brokerCommandsUI=i.brokerCommandsUI,this._updateRealtimeDataHandler=this._updateRealtimeData.bind(this),this._isBrokerConnected=Object(Bt.c)((()=>null!==this._realtimeProvider.activeBroker()),this._realtimeProvider.onStatusChanged),this._isBrokerConnected.subscribe(this._updateIsSymbolTraded.bind(this),{callWithLast:!0}),this._isBrokerConnected.subscribe(this._updateQtyTooltip.bind(this),{callWithLast:!0}),this._isBrokerConnected.subscribe(this._updateBrokerIcon.bind(this)),this.visible=new C.a(!1),this.visible.subscribe(this._toggleState.bind(this),{callWithLast:!0}),this._showSellBuyButtons=r.showSellBuyButtons.spawn(),this._showSellBuyButtons.subscribe(this._updateVisibility.bind(this),{callWithLast:!0}),this._isInstantMode=r.noConfirmEnabled.spawn(),this._themeName=r.themeName.spawn(),this._themeName.subscribe(this._updateBrokerIcon.bind(this),{callWithLast:!0}),this._tradePossibilityComputedWV=Object(P.combine)((()=>({})),this._isBrokerConnected,this._isSymbolTradableResult,this.ask,this.bid),this._tradePossibilityComputedWV.subscribe(this._updateTradePossibilityAndTooltip.bind(this),{callWithLast:!0}),this._isQtyVisibleComputedWV=Object(P.combine)((()=>({})),this.canTrade,this._isInstantMode),this._isQtyVisibleComputedWV.subscribe(this._updateIsQtyVisible.bind(this),{callWithLast:!0})}destroy(){var t;this._stop(),this._isBrokerConnected.destroy(),this._showSellBuyButtons.destroy(),null===(t=this._globalVisibility)||void 0===t||t.destroy(),this._isInstantMode.destroy(),this._tradePossibilityComputedWV.destroy(),this._isQtyVisibleComputedWV.destroy(),this._themeName.destroy()}setGlobalVisibility(t){Object(s.assert)(null===this._globalVisibility,"GlobalVisibility can be set only once"),this._globalVisibility=t.spawn(),this._globalVisibility.subscribe(this._updateVisibility.bind(this),{callWithLast:!0})}async tryToPlaceSellOrder(){await this._tryToPlaceOrder(parseFloat(Object(s.ensureNotNull)(this.bid.value())),-1)}async tryToPlaceBuyOrder(){await this._tryToPlaceOrder(parseFloat(Object(s.ensureNotNull)(this.ask.value())),1)}async getQtyInfo(){return null!==this._symbol&&this.canTrade.value()?(await this._realtimeProvider.symbolInfo(this._symbol)).qty:null}setQty(t){this.qty.setValue(String(t))}applyQty(){if(null===this._symbol||!this.canTrade.value())return;const t=this.qty.value();null!==t&&this._suggestedQty.setValue(this._symbol,Number(t))}_updateVisibility(){const t=(null===this._globalVisibility||this._globalVisibility.value())&&this._showSellBuyButtons.value();this.visible.setValue(t)}async _tryToPlaceOrder(t,e){if(null===this._realtimeProvider.activeBroker())return await this._toggleTradingWidget(),void this._onNeedSelectBroker.fire();const i=Number(this.qty.value())||1,r=this._isMarketOrderSupported()?2:1,o={symbol:Object(s.ensureNotNull)(this._symbol),qty:i,side:e,type:r,seenPrice:null};1===r&&(o.limitPrice=t),await Object(s.ensureNotNull)(this._brokerCommandsUI()).placeOrder(o,!0)}_toggleState(t){t?this._start():this._stop()}_start(){this._dataEvents.symbolResolved().subscribe(this,this._createTradedSymbol),this._dataEvents.symbolError().subscribe(this,this._createTradedSymbol),this._createTradedSymbol(),this._suggestedQty.changed.subscribe(this,this._updateQty)}_stop(){this._clearTradedSymbol(),this._symbol=null,this._dataEvents.symbolResolved().unsubscribeAll(this),this._dataEvents.symbolError().unsubscribeAll(this),this._suggestedQty.changed.unsubscribeAll(this)}_createTradedSymbol(){const t=this._getSymbolName();t!==this._symbol&&(this._clearTradedSymbol(),t.length>0&&this._initTradedSymbol(t))}_initTradedSymbol(t){this._symbol=t,this._updateIsSymbolTraded(),this._realtimeProvider.subscribeRealtime(this._symbol,this._updateRealtimeDataHandler)}_clearTradedSymbol(){this.ask.setValue(null),this.bid.setValue(null),this.spread.setValue(null),this.qty.setValue(null),null!==this._symbol&&(this._realtimeProvider.unsubscribeRealtime(this._symbol,this._updateRealtimeDataHandler),this._symbol=null,this._updateIsSymbolTraded())}_isMarketOrderSupported(){const t=this._realtimeProvider.activeBroker();return null===t||Boolean(t.metainfo().configFlags.supportMarketOrders)}_updateTradePossibilityAndTooltip(){this._updateCanTrade(),this._updateSellBuyTooltip()}_updateCanTrade(){let t=!1,e=!1;const i=this._isSymbolTradableResult.value();this._isBrokerConnected.value()&&null!==i&&i.tradable&&(e=!0,this.canTrade.value()||(t=!0)),this.canTrade.setValue(e),t&&null!==this._symbol&&this._updateQty(this._symbol)}_updateSellBuyTooltip(){const t=this._isSymbolTradableResult.value();let e=null,i=null,r=null;const s=null===this.ask.value(),o=null===this.bid.value();null===t||t.tradable?(s||o)&&(s&&(i=xt),o&&(r=Mt)):e=t.shortReason?t.shortReason:this._isBrokerConnected.value()?It:At,this.askTooltip.setValue(i||e||Vt),this.bidTooltip.setValue(r||e||Rt)}_updateRealtimeData(t,e,i){this._formatter=i.formatter,this._spreadFormatter=i.spreadFormatter;const r=e.ask,s=e.bid,n=Object(o.isNumber)(r)?this._formatter.format(r):null,a=Object(o.isNumber)(s)?this._formatter.format(s):null;this.ask.setValue(n),this.bid.setValue(a);const c=e.spread||Object(o.isNumber)(r)&&Object(o.isNumber)(s)&&r-s||0,l=Object(o.isNumber)(e.spread)?this._spreadFormatter:this._formatter;this.spread.setValue(l.format(c));let u=!1;Object(Dt.isFormatterHasForexAdditionalPrecision)(this._formatter)&&(u=this._formatter.hasForexAdditionalPrecision()),this.hasAskBidAdditionalPrecision.setValue(u)}async _updateIsSymbolTraded(){if(null===this._symbol)return void this._isSymbolTradableResult.setValue(null);const t=await this._realtimeProvider.isTradable(this._symbol);this._isSymbolTradableResult.setValue(Object(Ot.clone)(t))}async _updateQty(t){if(t!==this._symbol||!this.canTrade.value())return;let e=await this._suggestedQty.value(t);(!isFinite(e)||e<=0)&&(e=1),this.qty.setValue(""+Object(o.fixComputationError)(e))}_updateIsQtyVisible(){const t=this._isInstantMode.value()&&this.canTrade.value();this.isQtyVisible.setValue(t)}_updateQtyTooltip(){this.qtyTooltip.setValue(this._getQtyTooltip())}_getQtyTooltip(){const t=this._realtimeProvider.activeBroker();return null!==t&&t.metainfo().configFlags.showQuantityInsteadOfAmount?Ft:Ut}_updateBrokerIcon(){if(!Wt)return;let t;const e=this._realtimeProvider.activeBroker();if(null!==e){const i=e.metainfo();t="dark"===this._themeName.value()&&i.logoMiniBlackUrl?i.logoMiniBlackUrl:i.logoMiniUrl}this.brokerIconVisible.setValue(this._isBrokerConnected.value()),this.brokerIconUrl.setValue(t||null)}}i("LVLx");var Ht=i("MjAr"),zt=i("UXvI"),$t=i("EOiv"),Kt=i("AvGy"),Gt=i("qBrV"),Jt=i("N8pX"),Zt=i("0jws"),Yt=i("F+J5"),Xt=i("OKVU");const te=parseInt(Yt["css-value-padding"]);function ee(t,e,i,r){let o=t.querySelector("."+r);if(!i)return null!==o&&o.remove(),void Object(Gt.a)(t,e);null===o&&(o=document.createElement("span"),o.classList.add(r),t.appendChild(o)),Object(Gt.a)(Object(s.ensureNotNull)(o),e.slice(-1)),Object(Gt.a)(t,e.slice(0,-1))}class ie{constructor(t,e,i,r){this.element=document.createElement("div"),this._sellButtonEl=document.createElement("div"),this._sellButtonTextEl=document.createElement("span"),this._buyButtonEl=document.createElement("div"),this._buyButtonTextEl=document.createElement("span"),this._spreadQtyWrapper=document.createElement("div"),this._spreadEl=document.createElement("div"),this._qtyEl=document.createElement("div"),this._qtyTextEl=document.createElement("span"),this._brokerButtonEl=document.createElement("div"),this._brokerIconWrapEl=document.createElement("div"),this._isCalcOpened=!1,this._calcContainer=document.createElement("div"),this._sellLoader=new $t.a(this._sellButtonEl,{className:Jt.loader}),this._buyLoader=new $t.a(this._buyButtonEl,{className:Jt.loader}),this._windowResizeHandlerThrottle=Object(zt.default)(this._windowResizeHandler.bind(this),100),this._isHiddenByViewport=!1,this._mode=2,this._height=new C.a(0),this._resizeObserver=null,this._cachedBreakPoints={},this._parentWidth=0,this._getCurrentQty=()=>{const t=this._qty.value();return null!==t?Number(t):null},this._model=t,this._toggleMinimizeBottomWidgetBar=r,this._ask=this._model.ask.spawn(),this._ask.subscribe(this._updateBuyButton.bind(this)),this._bid=this._model.bid.spawn(),this._bid.subscribe(this._updateSellButton.bind(this)),this._spread=this._model.spread.spawn(),this._spread.subscribe(this._updateSpread.bind(this)),this._qty=this._model.qty.spawn(),this._qty.subscribe(this._updateQty.bind(this)),this._brokerIconVisible=this._model.brokerIconVisible.spawn(),this._brokerIconVisible.subscribe(this._updateBrokerIconImage.bind(this)),this._brokerIconUrl=this._model.brokerIconUrl.spawn(),this._brokerIconUrl.subscribe(this._updateBrokerIconImage.bind(this),{callWithLast:!0}),this._trackEvent=i,this._render(),this._askTooltip=this._model.askTooltip.spawn(),this._askTooltip.subscribe(this._updateButtonTooltip.bind(this,this._buyButtonEl),{callWithLast:!0}),this._bidTooltip=this._model.bidTooltip.spawn(),this._bidTooltip.subscribe(this._updateButtonTooltip.bind(this,this._sellButtonEl),{callWithLast:!0}),this._spreadTooltip=this._model.spreadTooltip.spawn(),this._spreadTooltip.subscribe(this._updateButtonTooltip.bind(this,this._spreadEl),{callWithLast:!0}),this._qtyTooltip=this._model.qtyTooltip.spawn(),this._qtyTooltip.subscribe(this._updateButtonTooltip.bind(this,this._qtyEl),{callWithLast:!0}),this._isVisible=this._model.visible.spawn(),this._isVisible.subscribe(this._updateVisibility.bind(this),{callWithLast:!0}),this._isQtyVisible=this._model.isQtyVisible.spawn(),this._isQtyVisible.subscribe(this._updateQtyVisibility.bind(this),{callWithLast:!0}),this._isLastDigitSup=this._model.hasAskBidAdditionalPrecision.spawn(),this._isLastDigitSup.subscribe(this._updateLastDigitSup.bind(this)),this._highButtonsMode=e.spawn(),this._highButtonsMode.subscribe(this._updateHighButtonsMode.bind(this),{callWithLast:!0}),this._canTrade=this._model.canTrade.spawn(),this._canTrade.subscribe(this._updateBgButtonsMode.bind(this),{callWithLast:!0}),this._sellButtonHandler=this._onSellButton.bind(this),this._buyButtonHandler=this._onBuyButton.bind(this),this._qtyHandler=this._toggleCalcVisibility.bind(this),this._brokerButtonHandler=this._onBrokerButton.bind(this),this._sellButtonEl.addEventListener("click",this._sellButtonHandler),this._buyButtonEl.addEventListener("click",this._buyButtonHandler),this._qtyEl.addEventListener("click",this._qtyHandler),this._brokerButtonEl.addEventListener("click",this._brokerButtonHandler),window.addEventListener("resize",this._windowResizeHandlerThrottle),this._windowResizeHandler()}destroy(){var t;this._ask.destroy(),this._askTooltip.destroy(),this._bid.destroy(),this._bidTooltip.destroy(),this._spread.destroy(),this._spreadTooltip.destroy(),this._qty.destroy(),this._qtyTooltip.destroy(),this._isVisible.destroy(),this._isQtyVisible.destroy(),this._isLastDigitSup.destroy(),this._highButtonsMode.destroy(),this._canTrade.destroy(),this._brokerIconUrl.destroy(),this._sellButtonEl.removeEventListener("click",this._sellButtonHandler),this._buyButtonEl.removeEventListener("click",this._buyButtonHandler),this._qtyEl.removeEventListener("click",this._qtyHandler),this._brokerButtonEl.removeEventListener("click",this._brokerButtonHandler),null===(t=this._resizeObserver)||void 0===t||t.disconnect(),this._resizeObserver=null,this.element.remove(),delete this.element,window.removeEventListener("resize",this._windowResizeHandlerThrottle)}updateModeByWidth(t){const e=this._cachedBreakPoints[0],i=this._cachedBreakPoints[1];this._mode=void 0!==e&&t<e?0:void 0!==i&&t<i?1:2,this._parentWidth=t,this.element.classList.toggle(Jt.column,1===this._mode),this._updateVisibility()}height(){return this._height}renderTo(t,e){void 0!==e?t.insertBefore(this.element,e):t.appendChild(this.element),null===this._resizeObserver&&(this._resizeObserver=new Ht.default(this._updateBreakPointsAndSize.bind(this))),this._resizeObserver.unobserve(this.element),this._resizeObserver.observe(this.element)}isHiddenByViewport(){return this._isHiddenByViewport}_render(){const t=this._bid.value()||"...";this._sellButtonTextEl.appendChild(document.createTextNode(t)),this._sellButtonTextEl.classList.add(Jt.buttonText),this._sellButtonEl.append(this._sellButtonTextEl),this._sellButtonEl.classList.add("apply-common-tooltip",Jt.button,Jt.sellButton);const e=this._spread.value()||"";this._spreadEl.appendChild(document.createTextNode(String(e))),this._spreadEl.classList.add("apply-common-tooltip",Jt.spread);const i=this._qty.value()||"";this._qtyTextEl.appendChild(document.createTextNode(i)),this._qtyEl.append(this._qtyTextEl),this._qtyEl.classList.add("apply-common-tooltip",Jt.button,Jt.qty),this._spreadQtyWrapper.classList.add(Jt.spreadQtyWrapper),this._spreadQtyWrapper.appendChild(this._spreadEl),this._spreadQtyWrapper.appendChild(this._qtyEl);const r=this._ask.value()||"...";this._buyButtonTextEl.appendChild(document.createTextNode(String(r))),this._buyButtonTextEl.classList.add(Jt.buttonText),this._buyButtonEl.append(this._buyButtonTextEl),this._buyButtonEl.classList.add("apply-common-tooltip",Jt.button,Jt.buyButton),this._brokerButtonEl.appendChild(this._brokerIconWrapEl),this._brokerIconWrapEl.classList.add(Jt.brokerButtonIconWrap),this._brokerButtonEl.classList.add(Jt.brokerButton),this.element.appendChild(this._sellButtonEl),this.element.appendChild(this._spreadQtyWrapper),this.element.appendChild(this._buyButtonEl),this.element.appendChild(this._brokerButtonEl),this.element.classList.add(Jt.wrapper),this.element.classList.toggle(Jt.touchMode,Kt.a),this.element.classList.toggle(Jt.notAvailableOnMobile,!1)}_updateBreakPointsAndSize(t){const e=t[0],i=2*te;2===this._mode&&(this._cachedBreakPoints[1]=Math.round(e.contentRect.width)+i),1===this._mode&&(this._cachedBreakPoints[0]=Math.round(e.contentRect.width)+i),this.updateModeByWidth(this._parentWidth);const r=e.contentRect.height>0?Math.round(e.contentRect.height)+i:0;this._height.setValue(r)}_updateBrokerIconImage(){const t=!this._brokerIconVisible.value();if(this._brokerButtonEl.classList.toggle(Zt.blockHidden,t),t)return;const e=this._brokerIconUrl.value(),i=null===e;this._brokerIconWrapEl.innerHTML=i?Xt:`<image src="${e}" alt="Account Manager" />`,this._brokerButtonEl.classList.toggle(Jt.brokerButtonDefault,i)}async _onSellButton(){if(null===this._bid.value())return;const t=this._highButtonsMode.value();this._trackEvent("Sell/Buy Buttons","Sell",t?"Instant":"Not Instant"),t&&this._canTrade.value()&&this._toggleLoaderVisibility(this._sellButtonEl,this._sellLoader,!0),await this._model.tryToPlaceSellOrder(),t&&this._canTrade.value()&&setTimeout((()=>this._toggleLoaderVisibility(this._sellButtonEl,this._sellLoader,!1)),300)}async _onBuyButton(){if(null===this._ask.value())return;const t=this._highButtonsMode.value();this._trackEvent("Sell/Buy Buttons","Buy",t?"Instant":"Not Instant"),t&&this._canTrade.value()&&this._toggleLoaderVisibility(this._buyButtonEl,this._buyLoader,!0),await this._model.tryToPlaceBuyOrder(),t&&this._canTrade.value()&&setTimeout((()=>this._toggleLoaderVisibility(this._buyButtonEl,this._buyLoader,!1)),300)}_onBrokerButton(){this._canShowMobileTrading()?async function(){(await Object(J.waitTradingService)()).getTradingPanelPopup().show()}():this._toggleMinimizeBottomWidgetBar()}_canShowMobileTrading(){var t;return isFeatureEnabled("trading_button")&&!(null===(t=window.TradingView.bottomWidgetBar)||void 0===t?void 0:t.isVisible().value())}_toggleLoaderVisibility(t,e,i){t.classList.toggle(Jt.loading,i),e.toggleVisibility(i)}_updateBuyButton(t){const e=null!==t&&this._isLastDigitSup.value();ee(this._buyButtonTextEl,""+(t||"..."),e,Jt.lastCharSup)}_updateSellButton(t){const e=null!==t&&this._isLastDigitSup.value();ee(this._sellButtonTextEl,""+(t||"..."),e,Jt.lastCharSup)}_updateSpread(t){const e=""+(t||"");Object(Gt.a)(this._spreadEl,e),this._updateVisibilityForSpreadQtyWrapper()}_updateQty(t){let e=""+(t||"");!this._isCalcOpened&&e.length>0&&(e=Object(k.a)(Number(e))),Object(Gt.a)(this._qtyTextEl,e)}_updateHighButtonsMode(t){this.element.classList.toggle(Jt.highButtons,t)}_updateBgButtonsMode(t){this.element.classList.toggle(Jt.withoutBg,!t)}_updateVisibilityForSpreadQtyWrapper(){const t=!this._isQtyVisible.value()&&null===this._spread.value();this._spreadQtyWrapper.classList.toggle(Zt.blockHidden,t)}_updateQtyVisibility(t){this._qtyEl.classList.toggle(Zt.blockHidden,!t),this._spreadQtyWrapper.classList.toggle(Jt.withoutQty,!t),this._updateVisibilityForSpreadQtyWrapper()}_updateVisibility(){const t=this._isVisible.value()&&0!==this._mode&&!this._isHiddenByViewport;this.element.classList.toggle(Zt.blockHidden,!t)}_updateLastDigitSup(){this._updateBuyButton(this._ask.value()),this._updateSellButton(this._bid.value())}_updateButtonTooltip(t,e){t.setAttribute("title",e)}_toggleCalcVisibility(){this._isCalcOpened=!this._isCalcOpened,this._renderCalc()}_closeCalc(){this._isCalcOpened=!1,this._updateQty(this._qty.value()),this._model.applyQty(),this._renderCalc()}_renderCalc(){Promise.all([i.e(4),i.e(18),i.e(22),i.e(87),i.e(3),i.e(17),i.e(29),i.e("trading-custom-widgets")]).then(i.bind(null,"Hmbi")).then((async t=>{const e=await this._model.getQtyInfo();null!==e&&t.render(this._isCalcOpened,this._calcContainer,Object.assign(Object.assign({},e),{withInput:!0,valueGetter:this._getCurrentQty,position:this._getCalcPosition(),targetEl:this._qtyEl,onClose:this._closeCalc.bind(this),onValueChange:this._model.setQty.bind(this._model),trackEventTarget:"Sell/Buy Buttons",trackEvent:this._trackEvent}))}))}_getCalcPosition(){const t=this._qtyEl.getBoundingClientRect();return{x:t.left,y:t.bottom+2}}_windowResizeHandler(){!1!==this._isHiddenByViewport&&(this._isHiddenByViewport=!1,this._updateVisibility())}}var re=i("7KDR");const se=window.t("Show Buy/Sell Buttons");class oe{constructor(t,e,i,r){this._showSellBuyButtons=r.showSellBuyButtons,this._trackEvent=i.trackEvent,this._model=new Qt(t,e,i,r),this._renderer=new ie(this._model,r.noConfirmEnabled,i.trackEvent,i.toggleMinimizeBottomWidgetBar)}destroy(){this._model.destroy(),this._renderer.destroy()}renderTo(t,e){this._renderer.renderTo(t,e)}setGlobalVisibility(t){this._model.setGlobalVisibility(t)}visibility(){return this._model.visible}updateWidgetModeBySize(t){this._renderer.updateModeByWidth(t.w)}contextMenuActions(){return this._renderer.isHiddenByViewport()?[]:[new re.Action({checkable:!0,checked:this._showSellBuyButtons.value(),label:se,onExecute:()=>{const t=!this._showSellBuyButtons.value();this._showSellBuyButtons.setValue(t),this._trackEvent("SellBuyButtonsWidget context menu","Show Sell/Buy Button",t?"Check":"Uncheck")}})]}height(){return this._renderer.height()}}var ne=i("i8i4"),ae=i("sQaR"),ce=i("g89m"),le=i("T7lC");const ue=W.a.forwardRef(((t,e)=>W.a.createElement("div",{ref:e,className:le.popupWrapper},t.children)));var he=i("+EG+");const de=new C.a(0),pe=(()=>{let t,e,r=null,s=null;return async(o,n,a)=>{const c=null==o?void 0:o.currentAccount();if(null===r||s!==o||t!==c){null==e||e.remove();const{AccountManager:l}=await Promise.resolve().then(i.bind(null,"zAqB")),u={container:n,height:de,visible:new C.a(!0)};r=n,s=o,t=c,e=new l(o,u,0,a)}else n.appendChild(r)}})(),be=new C.a(null);function _e(t){const e=Object(F.useRef)(null),i=Object(F.useContext)(he.b);return Object(F.useEffect)((()=>{be.setValue(i)}),[i]),Object(F.useEffect)((()=>(null!==e.current&&(window.addEventListener("resize",r),r(),pe(t.broker,e.current,be.readonly())),()=>{window.removeEventListener("resize",r)})),[]),W.a.createElement(ue,{ref:e});function r(){null!==e.current&&de.setValue(e.current.clientHeight)}}var me=i("jPOK"),ge=i("zAqB"),fe=i("TI9Z"),ye=i("yqjg");const ve=Object(r.t)("Trading");class we extends ae.a{constructor(t){super(),this._title=ve,this._isSubscribed=!1,this._handleClose=()=>{ne.unmountComponentAtNode(this._container),this._setVisibility(!1)},this._trading=t}show(){this._isSubscribed||(this._isSubscribed=!0,this._onStatusChange(this._trading.connectStatus()),this._trading.onConnectionStatusChange.subscribe(this,this._onStatusChange)),this._setVisibility(!0),this._renderComponent()}hide(){this._handleClose()}destroy(){this._isSubscribed=!1,this._trading.onConnectionStatusChange.unsubscribe(this,this._onStatusChange),this._handleClose()}_onStatusChange(t){this._connectStatus!==t&&(this._connectStatus=t,window.navigator.onLine?(2===t&&this._renderSpinner(),3!==t&&4!==t?1===t&&this._renderAccountManager():this._renderSpinner()):this._renderOfflineScreen())}_renderComponent(){ne.render(F.createElement(ce.a,{headerClassName:fe.header,dataName:"trading-dialog",isOpened:this.visible().value(),onClose:this._handleClose,fullScreen:!0,showSeparator:!1,draggable:!1,title:this._title,render:()=>this._content}),this._container)}_renderSpinner(){this._title=ve,this._changeDialogContent(F.createElement(me.a,null))}_renderOfflineScreen(){this._title=ve,this._changeDialogContent(F.createElement(ye.a,null))}async _renderBrokerSelectScreen(){}async _renderAccountManager(){const t=await Object(ge.makeAccountManagerHeaderDropdownsProps)(this._trading);if(this._title=ve,void 0!==t){const{AccountManagerHeaderDropdowns:e}=await Promise.resolve().then(i.bind(null,"Z4QD"));this._title=F.createElement(e,Object.assign({},t))}this._content=F.createElement(_e,{broker:this._trading.activeBroker()}),this._renderComponent()}_changeDialogContent(t){this._content=F.createElement(ue,null,t),this._renderComponent()}}var ke=i("cJM1"),Pe=i("MXV9"),Be=i("dXtN"),Ce=i("hJUO");i.d(e,"showSellBuyButtonsDefault",(function(){return Le})),i.d(e,"Trading",(function(){return Ne}));const Oe=Object(d.getLogger)("Trading.Core"),Se={1:"Connected",2:"Connecting",3:"Disconnected",4:"Error"};var Ee;!function(t){t[t.Paper=43000516466]="Paper",t[t.CQG=43000516372]="CQG",t[t.OANDA=43000516375]="OANDA",t[t.FOREXCOM=43000516374]="FOREXCOM"}(Ee||(Ee={}));const Te={enabled:new C.a(!1),name:"alert/alarm_clock"},je=D.enabled("buy_sell_buttons"),Le=!0;class Ne{constructor(t){this.accountType=new C.a,this.onBrokerChange=new h.a,this.onBrokerLoading=new h.a,this.onConnectionStatusChange=new h.a,this.onNewNotification=new h.a,this.onNeedSelectBroker=new h.a,this.onNotificationsChanged=new h.a,this.showSellBuyButtons=new C.a,this.noConfirmEnabled=new C.a,this.showOnlyRejectionNotifications=new C.a,this.showPricesWithZeroVolume=new C.a,this.showSpread=new C.a,this.orderExecutedSoundParams=Te,this._activeBroker=null,this._orderViewController=null,this._orderControllerPromise=null,this._brokerCommandsUI=null,this._showPricesWithZeroVolume=new C.a,this._showSpread=new C.a,this._offlineListener=this._offlineHandler.bind(this),this._onlineListener=this._onlineHandler.bind(this),this._notifications=[],this._account=null,this._domPanelVisibility=new C.a(!1),this._orderPanelVisibility=new C.a(!1),this._switchingBroker=!1,this._accountVerificationPromise=null,this._chartWidgetCollection=null,this._updateAccountId=()=>{this._account=Object(s.ensureNotNull)(this._activeBroker).currentAccount(),this.onNotificationsChanged.fire(this.getNotifications())},this._resizerBridge=t,this._realtimeProvider=new g((()=>this.activeBroker()),this.onBrokerChange,this.onConnectionStatusChange,this.suggestedQty()),this._positionService=new Tt(this),this._ordersService=new Lt(this),this._tradingStat=new y(this),this.tradingPanelPopup=new we(this),this.tradingPanel=new rt(t);const e=new Z(t,(()=>this.tradingPanel.close()));this.tradingPanel.addPage(X.d.DomPanel,e);const i=new Y;this.tradingPanel.addPage(X.d.OrderPanel,i);const r=v.getValue(c.a.TRADING_PANEL_ACTIVE_PAGE),o=v.getBool(c.a.TRADING_PANEL_OPENED,D.enabled("show_order_panel_on_start"));r&&this.tradingPanel.activePage.setValue(r),o&&this.tradingPanel.open(),this.tradingPanel.isPageOpened(X.d.OrderPanel)&&this.tradingPanel.isAvailable.value()&&this.setOrderPanelVisibility(!0),Object(P.combine)((()=>({})),this.tradingPanel.activePage,this.tradingPanel.isOpened).subscribe((()=>{this._domPanelVisibility.setValue(this.tradingPanel.isPageOpened(X.d.DomPanel)),this._orderPanelVisibility.setValue(this.tradingPanel.isPageOpened(X.d.OrderPanel))}))}setChartWidgetCollection(t){Object(s.assert)(null===this._chartWidgetCollection,"ChartWidgetCollection can be set only once"),this._chartWidgetCollection=t,this._guiAccessor=new L(t),new ft(this),this._loadState(),v.onSync.subscribe(this,this._loadState);const e=()=>{this._save()};this.showSellBuyButtons.subscribe(e),this.noConfirmEnabled.subscribe(e),this.showOnlyRejectionNotifications.subscribe(e),this._showPricesWithZeroVolume.subscribe(e),this._showSpread.subscribe(e),this.orderExecutedSoundParams.enabled.subscribe(e),window.addEventListener("offline",this._offlineListener),window.addEventListener("online",this._onlineListener),this.bindShortcuts(),this._registerCustomSources(t),this._registerCustomWidgets(t)}showPricesWith(){return{zeroVolume:this._showPricesWithZeroVolume,spread:this._showSpread}}domPanelVisibility(){return this._domPanelVisibility}orderPanelVisibility(){return this._orderPanelVisibility}realtimeProvider(){return this._realtimeProvider}toggleTradingWidget(){return window.TradingView.bottomWidgetBar?window.TradingView.bottomWidgetBar.activateTradingTab():Promise.resolve()}toggleMinimizeBottomWidgetBar(){if(window.TradingView.bottomWidgetBar)return window.TradingView.bottomWidgetBar.toggleMinimize()}tradingWizard(){return this._tradingWizard}showTradingProperties(){this._gui()&&this._gui().showTradingProperties()}brokersList(){return n.brokersList()}brokersPlans(){return this._getBrokerPlans()}activeBroker(){return this._activeBroker}brokerCommandsUI(){return this._brokerCommandsUI}trackEvent(t,e,i){const r=t?`[${t}] ${e}`:e;if(this._gui()){const t=this._activeBroker?this._activeBroker.metainfo().id+" Trading":"Trading No Broker",e=this._activeBroker?this._activeBroker.currentAccountType():void 0;this._gui().trackEvent(t,r,i||e)}}async selectBroker(t,e){await this._selectBrokerInternal(t,!0,e),this.tradingPanelPopup.visible().value()&&this.tradingPanelPopup.hide()}pickDefaultBroker(){if(this._activeBroker)return;let t=null;const e=this.brokersList().filter((t=>!t.configFlags.isSuspended));if(1===e.length)t=e[0].id;else{const i=v.getValue(c.a.ACTIVE_BROKER);i&&e.some((t=>t.id===i))&&(t=i)}t&&this.selectBroker(t)}async defaultContextMenuActions(t,{onlyMainActions:e=!1,gaOrigin:i="Chart Context Menu"}={}){const s=await this.suggestedQty().value(t.symbol),o=t.value||void 0,{bid:n,ask:a}=await this.realtimeProvider().quotesSnapshot(t.symbol),c=[];if(null!==t.value&&void 0!==a&&void 0!==n&&(t.value>=a||t.value<=n)){const e=(n+a)/2;c.push(...await this._makeSubActions(t,s,e,i))}return c.push({name:"trade-new-order",action:()=>{this.trackEvent(i,"New Order"),this._checkAndOpenOrderDialog({limitPrice:o,qty:s,stopPrice:o,symbol:t.symbol})},text:Object(N.appendEllipsis)(r.t("Create New Order")),statName:"NewOrder"}),!e&&D.enabled("property_pages")&&(c.push({separator:!0}),c.push({name:"trade-properties",action:()=>{this.trackEvent(i,"Trading Properties"),this.showTradingProperties()},text:Object(N.appendEllipsis)(r.t("Trading Settings")),icon:Pe,statName:"Properties"})),c}defaultDropdownMenuActions(t){const e=[],i=this.activeBroker(),s=t||{tradingProperties:!0,restoreConfirmations:i&&i.metainfo().configFlags.supportConfirmations,showHowToUse:i&&i.metainfo().configFlags.supportHowToUse};return D.enabled("property_pages")||(s.tradingProperties=!1),s.tradingProperties&&e.push({action:()=>{this.showTradingProperties(),this.trackEvent("Bottom Panel Dropdown","Trading Properties")},text:Object(N.appendEllipsis)(r.t("Trading Settings")),icon:Pe}),s.restoreConfirmations&&e.push({action:()=>{this._showRestoreConfirmations(),this.trackEvent("Bottom Panel Dropdown","Restore confirmations")},text:Object(N.appendEllipsis)(r.t("Restore confirmations"))}),e}chartContextMenuActions(t,e){return(this._activeBroker&&1===this._activeBroker.connectionStatus()?this._activeBroker.chartContextMenuActions(t,e):this.defaultContextMenuActions(t,e)).then((t=>Object(w.c)(t)))}connectStatus(){return this._activeBroker?this._activeBroker.connectionStatus():3}bindShortcuts(){if(this._hotkeys)return;this._hotkeys=st.createGroup({desc:"Trading"});const t=t=>{const e=this._gui().proSymbol();this.suggestedQty().value(e).then((i=>{this.realtimeProvider().quotesSnapshot(e).then((({bid:r,ask:s})=>{const o={price:void 0!==r&&void 0!==s?(r+s)/2:NaN,qty:i,side:t,symbol:e,type:2,seenPrice:null};this.trackEvent("Shortcut",-1===t?"Sell":"Buy"),this._checkAndPlaceOrder(o)}))}))};this._hotkeys.add({desc:"Buy",hotkey:st.Modifiers.Shift+66,handler:()=>t(1)}),this._hotkeys.add({desc:"Sell",hotkey:st.Modifiers.Shift+83,handler:()=>t(-1)})}suggestedQty(){if(!this._suggestedQty){const t=new h.a;this._suggestedQty={changed:t,setValue:(e,i)=>{this._setSymbolQty(e,i),t.fire(e)},value:t=>this.realtimeProvider().symbolInfo(t).then((e=>{const i=this._getSymbolQty(t)||this._getOldSymbolQty(t),r=void 0!==e.qty.default?e.qty.default:e.qty.min;return i?Object(o.alignTo)(Math.max(Math.min(e.qty.max,+i),e.qty.min),e.qty.step):r}))}}return this._suggestedQty}formatter(t){return this.realtimeProvider().formatter(t)}showSuccessNotification(t,e,i=1e4){this.showOnlyRejectionNotifications.value()||this._showNotification(t,e,"success",i),D.enabled("show_trading_notifications_history")&&this._addNotificationRow(t,e,"success",i),this._log(t,e)}showErrorNotification(t,e,i=25e3){this._showNotification(t,e,"danger",i),D.enabled("show_trading_notifications_history")&&this._addNotificationRow(t,e,"danger",i),this._log(t,e)}getNotifications(){return this._notifications.filter((t=>t.account===this._account&&t.broker===(this._activeBroker?this._activeBroker.metainfo().id:null)))}setDomPanelVisibility(t){t?this.tradingPanel.openPage(X.d.DomPanel):this.tradingPanel.close()}setOrderPanelVisibility(t){this._getOrderViewController().then((e=>{t?e.openPanel():e.closePanel()}))}orderViewController(){return Object(s.ensureNotNull)(this._orderViewController)}tradingStat(){return this._tradingStat}async verifyBrokerLiveAccount(){return this._verifyLiveAccount(),null!==this._accountVerificationPromise?this._accountVerificationPromise:Promise.reject("Account verification is not needed")}getTradingPanelPopup(){return this.tradingPanelPopup}_getOrderViewController(){return null===this._orderViewController?this._createOrderController().then((()=>this._getOrderViewController())):Promise.resolve(this._orderViewController)}_getSymbolQty(t){const e=this._getBrokerSymbolsQty();if(e)return e[t]}_getOldSymbolQty(t){const e=v.getFloat(c.a.QTY+t);return void 0!==e&&(this._setSymbolQty(t,e),v.remove(c.a.QTY+t)),e}_getBrokerSymbolsQty(){if(!this._activeBroker)return;const t=this._activeBroker.metainfo().id;return v.getJSON(c.a.BROKERS_QTY,{})[t]}_setSymbolQty(t,e){if(this._activeBroker){const i=this._activeBroker.metainfo().id,r=v.getJSON(c.a.BROKERS_QTY,{});r[i]||(r[i]={}),r[i][t]=e,v.setJSON(c.a.BROKERS_QTY,r)}}async _selectBrokerInternal(t,e,i=!1,s){if(!0!==this._switchingBroker){if(t!==(this._activeBroker?this._activeBroker.metainfo().id:null)){if(this._activeBroker){const t=this._activeBroker&&this._activeBroker.disconnectWarningMessage(),o=()=>this._showReviewDialogIfNeeded(3,{disconnectType:a.DisconnectType.LogOut});null===t?(o(),this._logOut(e,i,s)):Object(yt.showConfirm)({title:r.t("Log Out Confirmation"),text:t,mainButtonText:r.t("Log Out"),mainButtonIntent:"danger",cancelButtonText:r.t("Cancel"),onConfirm:({dialogClose:t})=>{o(),this._logOut(e,i,s),t()},onCancel:({dialogClose:t})=>{o(),t()}})}if(null!=t){let e;this._switchingBroker=!0;try{const r=await n.createBrokerConnection(this,t,e);this._initBroker(r,i)}catch(t){Oe.logError(t)}}else e&&setTimeout((()=>{v.remove(c.a.ACTIVE_BROKER)})),this.onBrokerChange.fire(null),this._brokerCommandsUI=null,this._accountVerificationPromise=null}}else Oe.logWarn(`Broker is already selected, but a new broker id: ${t} was received.`)}_initBroker(t,e){this._activeBroker&&(Oe.logWarn("Another one connecting broker detected. Disconnect it."),this._activeBroker.disconnect(e),this._activeBroker.destroy()),this._switchingBroker=!1,this._activeBroker=t,t.connectionStatusUpdate.subscribe(this,this._connectionListener),this._brokerCommandsUI=new G(this._activeBroker,this._guiAccessor,this.noConfirmEnabled,this._getOrderViewController.bind(this),this.showErrorNotification.bind(this),this.trackEvent.bind(this)),t.tryRestoreSession(),v.setValue(c.a.ACTIVE_BROKER,t.metainfo().id),this.onBrokerChange.fire(this._activeBroker),this._getOrderViewController(),this._updateConnectionStatus(this.connectStatus())}_gui(){return this._guiAccessor}_addNotificationRow(t,e,i,r){const s={id:this._notifications.length,account:this._account,broker:this._activeBroker?this._activeBroker.metainfo().id:null,time:new Date,title:t,text:e,type:i};this._notifications.push(s),this.onNewNotification.fire(s)}_offlineHandler(){this._selectBrokerInternal(null,!1,!1,{disconnectType:a.DisconnectType.Offline}),Oe.logNormal("The connection to the Internet was interrupted")}_onlineHandler(){const t=v.getValue(c.a.ACTIVE_BROKER);t&&(this._selectBrokerInternal(t,!1),Oe.logNormal("The connection to the Internet was restored"))}_showNotification(t,e,i,r){this._gui()&&this._gui().showNotification(t,e,i,r)}_showReviewDialogIfNeeded(t,e){null!==this._activeBroker&&this._activeBroker}_connectionListener(t,e){const i=this.connectStatus();this._showReviewDialogIfNeeded(t,e),3===t&&e&&e.disconnectType===a.DisconnectType.LogOut&&this._selectBrokerInternal(null,!1,!1,e),this._updateConnectionStatus(i,!0,e)}_updateOrderPanelSpinnerState(){const t=this._orderViewController,e=2===this.connectStatus(),i=null!==t&&t.stateChanging.value();this.tradingPanel.isLoading.setValue(e||i)}_updateConnectionStatus(t,e=!0,i){var r;this._updateOrderPanelSpinnerState(),this.onConnectionStatusChange.fire(t,i),this._log("Connection status",Se[t]);const s=this._activeBroker;if(e){const t=this._activeBroker?this._activeBroker.metainfo().id:void 0;v.setValue(c.a.ACTIVE_BROKER,t,{forceFlush:!0})}this._activeBroker?1===t?(this._account=this._activeBroker.currentAccount(),this._guiAccessor.setBroker(this._activeBroker)):(this._accountVerificationPromise=null,null!==this._account&&this._activeBroker.currentAccountUpdate.unsubscribe(this,this._updateAccountId)):this._guiAccessor.setBroker(null),null===(r=this._loginDialogRenderer)||void 0===r||r.then((e=>{s===this._activeBroker&&e.updateStatus(s,t,i)}))}_verifyLiveAccount(){if(null!==this._accountVerificationPromise)return;const t=Object(s.ensureNotNull)(this._activeBroker);t.metainfo().configFlags.supportVerifyLiveAccount&&(t.currentAccountType(),a.AccountType.Live)}_save(){v.setJSON(c.a.PROPERTIES,{showSellBuyButtons:+!!this.showSellBuyButtons.value(),noConfirmEnabled:+!!this.noConfirmEnabled.value(),qweqrq:+!!this.showOnlyRejectionNotifications.value(),showPricesWithZeroVolume:+!!this._showPricesWithZeroVolume.value(),showSpread:+!!this._showSpread.value(),orderExecutedSoundParams:JSON.stringify({enabled:+!!this.orderExecutedSoundParams.enabled.value(),name:this.orderExecutedSoundParams.name})})}_loadState(){const t=v.getJSON(c.a.PROPERTIES,{});if(this.showSellBuyButtons.setValue(void 0!==t.showSellBuyButtons?!!t.showSellBuyButtons:Le),this.noConfirmEnabled.setValue(!!t.noConfirmEnabled),this.showOnlyRejectionNotifications.setValue(!!t.qweqrq),this._showPricesWithZeroVolume.setValue(!t.hasOwnProperty("showPricesWithZeroVolume")||t.showPricesWithZeroVolume),this._showSpread.setValue(!t.hasOwnProperty("showSpread")||t.showSpread),t.hasOwnProperty("orderExecutedSoundParams")){const e=JSON.parse(t.orderExecutedSoundParams);this.orderExecutedSoundParams.enabled.setValue(!!e.enabled),this.orderExecutedSoundParams.name=e.name}}_log(t,e){Oe.logNormal(`${this._activeBroker?this._activeBroker.metainfo().id+" Trading: ":""}${t} - ${e}`)}_makeSureCanTrade(){var t;const e=this.activeBroker(),i=this.brokerCommandsUI(),r=Boolean(null===(t=window.TradingView.bottomWidgetBar)||void 0===t?void 0:t.isVisible().value());return e&&i?1===e.connectionStatus()||(r?this.toggleTradingWidget():this.tradingPanelPopup.show(),!1):(r?this.toggleTradingWidget().then((()=>this.onNeedSelectBroker.fire())):this.tradingPanelPopup.show(),!1)}_checkAndPlaceOrder(t,e=!0){this._makeSureCanTrade()&&Object(s.ensureNotNull)(this.brokerCommandsUI()).placeOrder(t,e)}_checkAndOpenOrderDialog(t){this._makeSureCanTrade()&&Object(s.ensureNotNull)(this.brokerCommandsUI()).placeOrder(t)}_makeSubAction(t,e,i,s,o,n,a){const c=1===e?Ce:Be,l=1===e?"Buy":"Sell",u=1===i?"Limit":"Stop",h=l+u,d={BuyLimit:r.t("Buy {symbol} Limit {qty} @ {value}").format({symbol:t.displaySymbol,qty:Object(k.a)(n),value:o}),SellStop:r.t("Sell {symbol} Stop {qty} @ {value}").format({symbol:t.displaySymbol,qty:Object(k.a)(n),value:o}),SellLimit:r.t("Sell {symbol} Limit {qty} @ {value}").format({symbol:t.displaySymbol,qty:Object(k.a)(n),value:o}),BuyStop:r.t("Buy {symbol} Stop {qty} @ {value}").format({symbol:t.displaySymbol,qty:Object(k.a)(n),value:o})};return{name:`trade-${l}-${u}`.toLowerCase(),action:()=>{this.trackEvent(a,`${l} ${u}`);const r=1===i?"limitPrice":"stopPrice",o={qty:n,side:e,symbol:t.symbol,type:i,seenPrice:null};null!==s&&(o[r]=s),this._checkAndPlaceOrder(o)},icon:c,text:d[h],statName:h}}_createOrderController(){return null===this._orderControllerPromise&&(this._orderControllerPromise=Promise.all([i.e("moment"),i.e("order-view-controller")]).then(i.bind(null,"3bpA")).then((({OrderViewController:t})=>new t({resizerBridge:this._resizerBridge,onNeedSelectBroker:this.onNeedSelectBroker,realtimeProvider:this.realtimeProvider(),suggestedQty:this.suggestedQty(),trackEvent:this.trackEvent.bind(this),toggleTradingWidget:this.toggleTradingWidget.bind(this),showErrorNotification:this.showErrorNotification.bind(this)},{container:this.tradingPanel.container,isAvailable:this.tradingPanel.isAvailable,isOpened:this.tradingPanel.isOpened,activePage:this.tradingPanel.activePage,close:this.tradingPanel.close.bind(this.tradingPanel),openPage:this.tradingPanel.openPage.bind(this.tradingPanel)}))).then((t=>{this._orderControllerPromise=null,this._orderViewController=t,this._orderViewController.stateChanging.subscribe((()=>this._updateOrderPanelSpinnerState()))}))),this._orderControllerPromise}async _registerCustomSources(t){!async function(t,e){const r=await i.e("trading-custom-sources").then(i.bind(null,"bydf"));t.addCustomSource("bidask",((i,s)=>new r.BidAsk(i,s,e.realtimeProvider(),(()=>{t.activeChartWidget.value().showGeneralChartProperties(T.TabNames.symbol)}))))}(t,this),async function(t,e){const[r,s,o]=await Promise.all([i.e("trading-custom-sources").then(i.bind(null,"fA+p")),i.e("trading-custom-sources").then(i.bind(null,"KSBC")),i.e("trading-custom-sources").then(i.bind(null,"EgV8"))]);t.addCustomSource("executions",((t,i)=>{const n=i.mainSeries(),a=n.dataEvents(),c=Object(Bt.b)(i.isInReplay.bind(i),i.onInReplayStateChanged()),l=Object(Bt.b)((()=>n.isConvertedToOtherCurrency()||n.isConvertedToOtherUnit()),n.symbolResolved()),u=Object(Bt.a)(((t,e,i)=>i&&!e),c,l,i.properties().tradingProperties.showExecutions),h=function(t,e,i){return e=>{const r=i.seriesSource().symbolInstanceId(),s=i.interval();return null===r?null:new Pt(t,"executions",e,r,s)}}(i.chartApi(),0,n),d=Object(Bt.c)(Ct.bind(null,i),a.barReceived()),p=new r.ExecutionsService(e,a,function(t){return()=>{const e=t.symbolInfo();return null!==e?e.pro_name||e.full_name:t.proSymbol()}}(n)),b=new s.ExecutionsPointsManager(p,h,d);return new o.ExecutionsSource(t,i,e,u,b)}))}(t,this);const e=await Promise.all([i.e("trading-custom-sources").then(i.bind(null,"J1Ip")),i.e("trading-custom-sources").then(i.bind(null,"QOhU"))]);new e[0].PositionsManager(this._positionService,t,{brokerCommandsUI:this.brokerCommandsUI.bind(this),trackEvent:this.trackEvent.bind(this)}),new e[1].OrdersManager(this._ordersService,this._positionService,t,{activeBroker:this.activeBroker.bind(this),onConnectionStatusChange:this.onConnectionStatusChange,brokerCommandsUI:this.brokerCommandsUI.bind(this),trackEvent:this.trackEvent.bind(this)})}_registerCustomWidgets(t){je&&function(t,e){t.addCustomWidgetToLegend(((t,i)=>{const r=t.mainSeries();return new oe(r.dataEvents(),function(t){return()=>{const e=t.symbolInfo();return null!==e?e.pro_name||e.full_name||e.name||"":t.proSymbol()}}(r),{onNeedSelectBroker:e.onNeedSelectBroker,realtimeProvider:e.realtimeProvider(),suggestedQty:e.suggestedQty(),trackEvent:e.trackEvent.bind(e),toggleTradingWidget:e.toggleTradingWidget.bind(e),brokerCommandsUI:e.brokerCommandsUI.bind(e),toggleMinimizeBottomWidgetBar:()=>e.toggleMinimizeBottomWidgetBar()},{showSellBuyButtons:e.showSellBuyButtons,noConfirmEnabled:e.noConfirmEnabled,themeName:i})}),{block:0,position:0})}(t,this)}async _makeSubActions(t,e,i,r){const s=[],n=this.activeBroker();let a,c,l,u,h,d,p,b,_,m=null===n,g=null===n;if(null!==n&&1===n.connectionStatus()&&(_=await n.isTradable(t.symbol)),null!==n&&_&&_.tradable&&null!==t.value){const e=n.metainfo().configFlags,i=await n.symbolInfo(t.symbol),r=(f=t.value,y=i.minTick,Object(o.fixComputationError)(Math.round(f/y)*y));a=r,l=r,u=r,c=r,m=Boolean(e.supportLimitOrders),g=Boolean(e.supportStopOrders),void 0!==i.limitPriceStep&&(a=Object(z.k)(t.value,i.limitPriceStep,1,1),l=Object(z.k)(t.value,i.limitPriceStep,1,-1)),void 0!==i.stopPriceStep&&(u=Object(z.k)(t.value,i.stopPriceStep,2,1),c=Object(z.k)(t.value,i.stopPriceStep,2,-1));const s=await n.formatter(t.symbol,!1);h=s.format(a),d=s.format(c),p=s.format(l),b=s.format(u)}else a=l=u=c=t.value,h=d=p=b=t.formattedValue;var f,y;return null!==t.value&&t.value<=i?(m&&s.push(this._makeSubAction(t,1,1,a,h,e,r)),g&&s.push(this._makeSubAction(t,-1,3,c,d,e,r))):null!==t.value&&t.value>=i&&(m&&s.push(this._makeSubAction(t,-1,1,l,p,e,r)),g&&s.push(this._makeSubAction(t,1,3,u,b,e,r))),s}_initPaidBrokersByUserRegion(){this._brokersListPromise=fetch("/api/v1/brokers/trading_panel",{method:"GET"}).then((t=>t.json())).catch((t=>{Oe.logWarn("Failed to fetch brokers info: "+t)}))}async _getBrokerPlans(){let t=[];try{if(t=await this._brokersListPromise,!Array.isArray(t))throw new Error("Request result is not valid")}catch(t){Oe.logError("Failed to fetch broker list by user region: "+t.message)}return t}async _checkCQGCredentials(t){}_showSupportDialog(t){t in Ee?showSupportDialog({initialState:SolutionCategoryName.Trading,solutionId:Ee[t]}):showSupportDialog({initialState:SolutionCategoryName.Trading})}async _showRestoreConfirmations(){const t=await Object(vt.a)({title:r.t("Restore confirmations"),text:r.t("Are you confirming you'd like to restore order confirmations, which you've previously disabled?"),mainButtonIntent:"primary"});null!==this._activeBroker&&t&&(new ke.a).clear()}_logOut(t,e,i){const r=Object(s.ensureNotNull)(this._activeBroker);r.connectionStatusUpdate.unsubscribe(this,this._connectionListener),r.disconnect(e||!t),r.destroy(),this._activeBroker=null,this._updateConnectionStatus(3,t,i)}}},"F+J5":function(t,e,i){t.exports={"css-value-padding":"4px"}},GOhO:function(t,e,i){"use strict";var r=i("+DwS"),s=i("tc+8"),o=i.n(s);function n(t,e){const i=new o.a(t()),r={};return i.destroy=()=>{e.unsubscribeAll(r)},e.subscribe(r,(()=>{i.setValue(t())})),i}var a=i("m/cY");function c(t,...e){const i=()=>t(...e.map((t=>t.value()))),r=Object(a.a)(i()),s=()=>r.setValue(i()),o={};for(const t of e)t.subscribe(o,s);return r.destroy=()=>{e.forEach((t=>t.unsubscribeAll(o)))},r}i.d(e,"c",(function(){return r.a})),i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return c}))},Hgre:function(t,e,i){"use strict";i.r(e);var r=i("YFKU"),s=i("Kxc7"),o=i("Eyy1");class n{constructor(t,e,i){this._symbol=null,this._side=null,this._realtimeData=null,this._avgPrice=null,this._positionId=t,this._adapter=e,this._host=i,this._adapter.positionById(t).then((t=>{const e=Object(o.ensureDefined)(t);this._symbol=e.symbol,this._side=e.side,this._onPositionChanged(e),this._onRealtimeBinded=this._onRealtime.bind(this),this._adapter.subscribeRealtime(this._symbol,this._onRealtimeBinded),this._adapter.positionUpdate.subscribe(this,this._onPositionChanged)}))}stop(){this._symbol&&this._adapter.unsubscribeRealtime(this._symbol,this._onRealtimeBinded),this._adapter.positionUpdate.unsubscribe(this,this._onPositionChanged)}_updatePL(){if(!this._realtimeData||!this._realtimeData.trade||!this._avgPrice)return;const t=(this._realtimeData.trade-Math.abs(this._avgPrice))*(1===this._side?1:-1);this._host.plUpdate(this._positionId,t)}_onRealtime(t,e){this._realtimeData=e,this._updatePL()}_onPositionChanged(t){this._avgPrice=t.avgPrice,this._updatePL()}}var a=i("ogJP"),c=i("aIyQ"),l=i.n(c);class u{constructor(t){this._objects={},this._started=!1,this._isObjectsRequestActual=!1,this._ordersPromise=null,this._getter=t,this.updateDelegate=new l.a,this.partialUpdateDelegate=new l.a}start(){this._started||(this._started=!0,this._ordersPromise=this._requestObjects())}stop(){this._objects={},this._started=!1,this._ordersPromise=null,this._isObjectsRequestActual=!1}update(t,e){this._started&&(this._isObjectsRequestActual?this._isObjectsRequestActual=!1:(this._objects[t.id]=t,this._onObjectUpdated(t,e)))}partialUpdate(t,e){if(!this._started)return;if(this._isObjectsRequestActual)return void(this._isObjectsRequestActual=!1);let i,r;Object(a.isObject)(t)?(i=t.id,r=t):(i=t,r=Object(o.ensure)(e));const s=this._objects[i];s&&(Object.assign(s,r),this.partialUpdateDelegate.fire(s,r))}fullUpdate(){this._started&&(this._isObjectsRequestActual?this._isObjectsRequestActual=!1:this._ordersPromise=this._requestObjects())}getObjects(){return this._ordersPromise||Promise.resolve(Object.values(this._objects))}_onObjectUpdated(t,e){this.updateDelegate.fire(t,e)}_onAllObjectsUpdated(){this._objectsCache().forEach((t=>this.updateDelegate.fire(t,!0)))}_objectsCache(){return Object.values(this._objects)}async _requestObjects(){let t=[];do{this._isObjectsRequestActual=!0,t=await this._getter()}while(!this._isObjectsRequestActual);return this._objects=("id",t.reduce(((t,e)=>(t[e.id]=e,t)),{})),this._ordersPromise=null,this._isObjectsRequestActual=!1,this._onAllObjectsUpdated(),t}}var h=i("txPx"),d=i("5kf6");class p extends u{constructor(t,e){super(t),this._brokerConfigGetter=e}_onObjectUpdated(t,e){this._patchTrades(this._objectsCache().filter((e=>e.symbol===t.symbol&&0!==e.qty)),t,e),super._onObjectUpdated(t,e)}_onAllObjectsUpdated(){this._patchTrades(this._objectsCache().filter((t=>0!==t.qty))),super._onAllObjectsUpdated()}_patchTrades(t,e,i){const r=this._brokerConfigGetter();let s;s=r.requiresFIFOCloseTrades?r.fifoOnlyForSameQty?m:_:b;const o=s(t);for(const t of o)e!==t&&super._onObjectUpdated(t,i)}}function b(t){const e=[];for(const i of t)i.canBeClosed||(i.canBeClosed=!0,e.push(i));return e}function _(t){const e={};for(const i of t){let t=e[i.symbol];void 0===t&&(t={oldest:null,all:[]},e[i.symbol]=t),(null===t.oldest||t.oldest.date>i.date)&&(t.oldest=i),t.all.push(i)}const i=[];for(const t of Object.keys(e)){const r=Object(o.ensureDefined)(e[t]);for(const t of r.all){const e=r.oldest===t,s=e!==t.canBeClosed;t.canBeClosed=e,s&&i.push(t)}}return i}function m(t){const e={};for(const i of t){let t=e[i.symbol];void 0===t&&(t={},e[i.symbol]=t);let r=t[i.qty];void 0===r&&(r={oldest:null,all:[]},t[i.qty]=r),(null===r.oldest||r.oldest.date>i.date)&&(r.oldest=i),r.all.push(i)}const i=[];for(const t of Object.keys(e)){const r=Object(o.ensureDefined)(e[t]);for(const t of Object.keys(r)){const e=Object(o.ensureDefined)(r[t]);for(const t of e.all){const r=e.oldest===t,s=r!==t.canBeClosed;t.canBeClosed=r,s&&i.push(t)}}}return i}var g=i("Lj6W"),f=i("25b6"),y=i("dOnf"),v=i("4qhP");function w(t,e){return{symbol:e.symbol,type:2,side:1===e.side?-1:1,qty:Math.abs(t),seenPrice:null,isClose:!0}}var k=i("/udZ");const P=Object(h.getLogger)("Trading.BrokerConnectionAdapter");function B(t){Object(o.assert)("object"!=typeof t,"Expected not an object")}function C(t,e){return t.type===e.type&&t.qty===e.qty&&t.limitPrice===e.limitPrice&&t.stopPrice===e.stopPrice&&t.takeProfit===e.takeProfit&&t.stopLoss===e.stopLoss&&t.trailingStopPips===e.trailingStopPips}class O{constructor(t,e,i,r,s,o){this.connectionStatusUpdate=new l.a,this.executionUpdate=new l.a,this.tradingOperationFinished=new l.a,this.currentAccountUpdate=new l.a,this._brokerPlan=null,this._subscriptions={},this._lastFireResult={},this._fakeDomeSubscriptions={},this._formattersCache={},this._spreadFormattersCache={},this._quantityFormattersCache={},this._tradesCache=null,this._profitLossEmitters={},this._fakePositionUpdateDelegate=null,this._realtimeSubscriptionState=[],this._loggedInManually=!1,this._pendingSubscriptions=[],this.config=Object.assign({},t.configFlags),this._brokerMetainfo=this._patchMetainfo(t),this._brokerPlan=o||null,this._brokerConnection=e,this._host=i,this._tradingStat=s,this._brokerLogger=Object(h.getLogger)("Trading."+this._brokerMetainfo.id+".Connection"),i.setBrokerConnectionAdapter(this),this._initializeConnectProtection(),this._positionsCache=e.positions?new u((()=>e.positions?e.positions():Promise.resolve([]))):null,this._tradesCache=e.trades?new p((()=>e.trades?e.trades():Promise.resolve([])),(()=>this.config)):null,this._ordersCache=new u((()=>e.orders()));const n=t=>{1===t?(null!==this._positionsCache&&this._positionsCache.start(),this._ordersCache.start(),this._tradesCache&&this._tradesCache.start()):(null!==this._positionsCache&&this._positionsCache.stop(),this._ordersCache.stop(),this._tradesCache&&this._tradesCache.stop())};this.connectionStatusUpdate.subscribe(null,n),n(this.connectionStatus()),t.configFlags.supportPLUpdate||(this._brokerConnection.subscribePL=t=>{this._profitLossEmitters[t]=this._createProfitLossEmitter(t)},this._brokerConnection.unsubscribePL=t=>{const e=this._profitLossEmitters[t];e&&(e.stop(),this._profitLossEmitters[t]=null)}),this._originalDOMESubscriptionMethods={subscribeDOME:e.subscribeDOME,unsubscribeDOME:e.unsubscribeDOME},this._patchBrokerSubscribeUnsubscribeDOMEMethods(),this.connectionStatusUpdate.subscribe(null,(t=>{1===t&&this._patchBrokerSubscribeUnsubscribeDOMEMethods()})),t.configFlags.supportPositions||(this._fakePositionUpdateDelegate=new l.a),this._brokerRealtimeAdapter=r}tryRestoreSession(){if(this._brokerConnection.tryRestoreSession)return this._brokerConnection.tryRestoreSession()}get orderUpdate(){return this._ordersCache.updateDelegate}get positionUpdate(){return null===this._fakePositionUpdateDelegate?Object(o.ensure)(this._positionsCache).updateDelegate:this._fakePositionUpdateDelegate}get tradeUpdate(){return Object(o.ensure)(this._tradesCache).updateDelegate}get orderPartialUpdate(){return this._ordersCache.partialUpdateDelegate}get positionPartialUpdate(){return null===this._fakePositionUpdateDelegate?Object(o.ensure)(this._positionsCache).partialUpdateDelegate:this._fakePositionUpdateDelegate}get tradePartialUpdate(){return Object(o.ensure)(this._tradesCache).partialUpdateDelegate}onOrderUpdate(t){this._ordersCache.update(t)}onOrderPartialUpdate(t,e){this._ordersCache.partialUpdate(t,e)}onPositionUpdate(t,e){if(Object(o.assert)(!!this.config.supportPositions,"Broker doesn`t support positions"),0===t.qty){const e=this._lastFireResult[t.symbol];e&&delete e.PL}Object(o.ensure)(this._positionsCache).update(t,e)}onPositionPartialUpdate(t,e){Object(o.assert)(!!this.config.supportPositions,"Broker doesn`t support positions"),Object(o.ensure)(this._positionsCache).partialUpdate(t,e)}onTradeUpdate(t,e){if(Object(o.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),0===t.qty){const e=this._lastFireResult[t.symbol];e&&delete e.TradePL}Object(o.ensure)(this._tradesCache).update(t,e)}onTradePartialUpdate(t,e){Object(o.ensure)(this._tradesCache).partialUpdate(t,e)}onCurrentAccountChanged(){null!==this._positionsCache&&this._positionsCache.fullUpdate(),this._ordersCache.fullUpdate(),this._tradesCache&&this._tradesCache.fullUpdate();const t=this.currentAccount();this.currentAccountUpdate.fire(t)}patchConfig(t){Object(g.migrateConfigFlags)(t),Object.assign(this.config,t),Object.assign(this._brokerMetainfo.configFlags,t),this._brokerMetainfo=this._patchMetainfo(this._brokerMetainfo)}async getOrderDialogOptions(t){return void 0!==this._brokerConnection.getOrderDialogOptions?this._brokerConnection.getOrderDialogOptions(t):void 0}getPositionDialogOptions(){return void 0!==this._brokerConnection.getPositionDialogOptions?this._brokerConnection.getPositionDialogOptions():void 0}chartContextMenuActions(t,e){return this._brokerConnection.chartContextMenuActions(t,e)}buttonDropdownActions(){return this._host.buttonDropdownActions()}connectionStatus(){return this._brokerConnection.connectionStatus()}isConnected(){return 1===this._brokerConnection.connectionStatus()}signIn(t,e,i,r){return this._brokerLogger.logNormal("Try to login with username: "+t),this._loggedInManually=!0,this._brokerConnection.signIn(t,e,i,r)}loggedInManually(){return this._loggedInManually}disconnect(t=!1){try{return this._brokerConnection.disconnect(t)}catch(t){P.logWarn("Failed to disconnect")}}currentAccount(){return this._brokerConnection.currentAccount?this._brokerConnection.currentAccount():""}currentAccountType(){return this._brokerConnection.currentAccountType?this._brokerConnection.currentAccountType():void 0}metainfo(){return this._brokerMetainfo}brokerPlan(){return this._brokerPlan}bro(){return this._brokerConnection}fireSubscription(t,e,i,r){if(void 0===this._lastFireResult[e]&&(this._lastFireResult[e]={Realtime:null,PL:null,Equity:null,DOME:null,TradePL:null,PipValue:null,MarginAvailable:null,CryptoBalance:null}),Object(o.ensure)(this._lastFireResult[e])[t]={data:i,time:Date.now()},void 0===this._subscriptions[e])return;const s=Object(o.ensure)(this._subscriptions[e]);Object(o.ensure)(s[t]).forEach((t=>t(e,i,r)))}positions(t){return this.config.supportPositions?(this._makeSureBrokerIsConnected(),this._positions().then((e=>e.filter((e=>void 0===t||e.symbol===t))))):Promise.resolve([])}disconnectWarningMessage(){return this._brokerConnection.disconnectWarningMessage?this._brokerConnection.disconnectWarningMessage():null}trades(t){return this._makeSureBrokerIsConnected(),Object(o.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),this._trades().then((e=>e.filter((e=>void 0===t||e.symbol===t))))}positionById(t){return this._brokerConnection.positionById?this._brokerConnection.positionById(t):this.positions().then((e=>e.find((e=>e.id===t)))).then((t=>t))}tradeById(t){return Object(o.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),this.trades().then((e=>e.find((e=>e.id===t)))).then((t=>Object(o.ensure)(t)))}orders(t){return this._makeSureBrokerIsConnected(),this._orders().then((e=>e.filter((e=>void 0===t||e.symbol===t))))}ordersHistory(){return this._makeSureBrokerIsConnected(),this.config.supportOrdersHistory&&this._brokerConnection.ordersHistory?this._brokerConnection.ordersHistory():Promise.resolve([])}executions(t){return this._makeSureBrokerIsConnected(),this._brokerConnection.executions(t)}orderById(t){return this._makeSureBrokerIsConnected(),this._brokerConnection.orders().then((e=>e.find((e=>e.id===t))))}accountManagerInfo(){return this._brokerConnection.accountManagerInfo()}isTradable(t){return this._makeSureBrokerIsConnected(),this._brokerConnection.isTradable(t).then((e=>("object"!=typeof e&&(e={tradable:e}),e.tradable||void 0!==e.reason||(e.reason=Object(r.t)("Symbol {symbol} cannot be traded through {broker}.").replace("{symbol}",Object(f.b)(t)).replace("{broker}",this._brokerMetainfo.title)),e)))}formatter(t,e=!0){return this._makeSureBrokerIsConnected(),this._formattersCache[t]||(this._formattersCache[t]=this._brokerConnection.formatter&&this._brokerConnection.formatter(t,e)||this._host.defaultFormatter(t,e)),Object(d.a)(this._formattersCache[t],1e4,"formatter not received")}spreadFormatter(t){return this._makeSureBrokerIsConnected(),this._spreadFormattersCache[t]||(this._spreadFormattersCache[t]=this._brokerConnection.spreadFormatter&&this._brokerConnection.spreadFormatter(t)||this._host.defaultFormatter(t,!1)),Object(d.a)(this._spreadFormattersCache[t],1e4,"spreadFormatter not received")}quantityFormatter(t){return this._makeSureBrokerIsConnected(),this._quantityFormattersCache[t]||(this._quantityFormattersCache[t]=this._brokerConnection.quantityFormatter&&this._brokerConnection.quantityFormatter(t)||this._host.quantityFormatter()),Object(d.a)(this._quantityFormattersCache[t],1e4,"quantityFormatter not received")}placeOrder(t,e){return this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.placeOrder(t,e),!0,Object(r.t)("Order rejected"),(()=>{Object(o.ensureNotNull)(this._tradingStat).trackOrderPlaced(t),this._host.trackEvent("","SilentMode",this._host.silentOrdersPlacement().value()?"On":"Off")}))}previewOrder(t){if(!this._brokerConnection.previewOrder)throw new Error("Order preview is not supported");return this._brokerConnection.previewOrder(t)}modifyOrder(t,e){return this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.modifyOrder(t,e),!0,Object(r.t)("Failed to modify order")).then((e=>e&&this._waitForOrderModification(t)))}cancelOrder(t){return B(t),this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.cancelOrder(t),!0,Object(r.t)("Failed to cancel order"))}cancelOrders(t,e,i){return this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.cancelOrders(t,e,i),!0,Object(r.t)("Failed to cancel one or more orders"))}async closePosition(t,e){B(t),this._makeSureBrokerIsConnected(),Object(o.assert)(void 0===e||!!this.config.supportPartialClosePosition,"Broker doesn`t support partial position closing");const i=Object(o.ensureDefined)(await this.positionById(t));if(0===i.qty)return this._host.showNotification(Object(r.t)("Failed to close the position"),Object(r.t)("The position you are trying to close has been already closed."),0),!1;if(void 0===e||e<=Math.abs(i.qty)){const s=w(null!=e?e:Math.abs(i.qty),i);return this.config.supportClosePosition&&this._brokerConnection.closePosition?this.processErrors(this._brokerConnection.closePosition(t,e),!0,Object(r.t)("Failed to close position"),(()=>Object(o.ensureNotNull)(this._tradingStat).trackOrderPlaced(s))):this.processErrors(this._brokerConnection.placeOrder(s),!0,Object(r.t)("Failed to close position"),(()=>Object(o.ensureNotNull)(this._tradingStat).trackOrderPlaced(s)))}return this._host.showNotification(Object(r.t)("Failed to close the position"),Object(r.t)("The position you are trying to close has been changed."),0),!1}async closeTrade(t,e){var i;B(t),this._makeSureBrokerIsConnected(),Object(o.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),Object(o.assert)(void 0===e||null!==(i=this.config.supportPartialCloseTrade)&&void 0!==i&&i,"Broker doesn`t support partial position closing");const s=Object(o.ensureDefined)(await this.tradeById(t));if(0===s.qty)return this._host.showNotification(Object(r.t)("Failed to close the position"),Object(r.t)("The position you are trying to close has been already closed."),0),!1;if(void 0===e||e<=Math.abs(s.qty)){if(this._brokerConnection.closeTrade){const i=w(null!=e?e:Math.abs(s.qty),s);return this.processErrors(this._brokerConnection.closeTrade(t,e),!0,Object(r.t)("Failed to close position"),(()=>Object(o.ensureNotNull)(this._tradingStat).trackOrderPlaced(i)))}throw new Error("Method closeTrade is not implemented")}return this._host.showNotification(Object(r.t)("Failed to close the position"),Object(r.t)("The position you are trying to close has been changed."),0),!1}reversePosition(t){if(B(t),this._makeSureBrokerIsConnected(),this.config.supportMultiposition&&!this.config.supportNativeReversePosition)throw new Error("Cannot reverse position on multiposition account");let e;const i=new Promise((i=>{var r;null===(r=this._positionsCache)||void 0===r||r.getObjects().then((r=>{var s;const o=Object.assign({},r.find((e=>e.id===t)));if(0===Object.keys(o).length||0===o.qty)return this._brokerLogger.logError("Failed to reverse position: Position not found"),void i(!1);e=t=>{var r;t.symbol===o.symbol&&t.side!==o.side&&(null===(r=this._positionsCache)||void 0===r||r.updateDelegate.unsubscribe(this,e),i(!0))},null===(s=this._positionsCache)||void 0===s||s.updateDelegate.subscribe(this,e),this._reversePosition(t).then((t=>{var r;t||(null===(r=this._positionsCache)||void 0===r||r.updateDelegate.unsubscribe(this,e),i(!1))}))}))}));return Object(d.a)(i,3e4,"Timeout").catch((t=>{var i;return this._brokerLogger.logError("Failed to reverse position: "+Object(k.c)(t)),null===(i=this._positionsCache)||void 0===i||i.updateDelegate.unsubscribe(this,e),!1}))}editPositionBrackets(t,e,i){if(this._makeSureBrokerIsConnected(),this._brokerConnection.editPositionBrackets)return this.processErrors(this._brokerConnection.editPositionBrackets(t,e,i),!0,Object(r.t)("Failed to modify Stop Loss / Take Profit"));throw new Error("Method editPositionBrackets is not implemented")}editTradeBrackets(t,e){if(this._makeSureBrokerIsConnected(),Object(o.assert)(!!this.config.supportTradeBrackets,"Broker doesn`t support brackets on trades"),this._brokerConnection.editTradeBrackets)return this.processErrors(this._brokerConnection.editTradeBrackets(t,e),!0,Object(r.t)("Failed to modify Stop Loss / Take Profit"));throw new Error("Method editTradeBrackets is not implemented")}async subscribeRealtime(t,e){this._makeSureBrokerIsConnected();const i={symbol:t,listener:e,provider:0};this._realtimeSubscriptionState.push(i);const r=await this.symbolInfo(t),s=this._realtimeSubscriptionState.findIndex((i=>i.symbol===t&&i.listener===e));if(-1!==s)return void 0!==r.hasQuotes&&!1===r.hasQuotes?(this._realtimeSubscriptionState[s].provider=1,Object(o.ensure)(this._brokerRealtimeAdapter).subscribeRealtime(t,e)):(this._realtimeSubscriptionState[s].provider=2,this._addSubscription("Realtime",t,e))}quotesSnapshot(t){let e=null;return Object(d.a)(new Promise((i=>{const r=(t,s)=>{e=s,s&&(s.ask||s.bid)&&(this.unsubscribeRealtime(t,r),i(s))};this.subscribeRealtime(t,r)})),1e4,"quotesSnapshot not received").catch((t=>{if(null!==e)return e;throw t}))}subscribeDOME(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("DOME",t,e)}subscribePipValue(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("PipValue",t,e)}subscribePL(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("PL",t,e)}subscribeTradePL(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("TradePL",t,e)}subscribeCryptoBalance(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("CryptoBalance",t,e)}subscribeEquity(t){return this._makeSureBrokerIsConnected(),this._addSubscription("Equity","Equity",t)}subscribeMarginAvailable(t){return this._makeSureBrokerIsConnected(),this._addSubscription("MarginAvailable","MarginAvailable",t)}unsubscribeRealtime(t,e){const i=this._realtimeSubscriptionState.findIndex((i=>i.symbol===t&&i.listener===e));-1!==i&&(1===this._realtimeSubscriptionState[i].provider?Object(o.ensure)(this._brokerRealtimeAdapter).unsubscribeRealtime(t,e):this._removeSubscription("Realtime",t,e),this._realtimeSubscriptionState.splice(i,1))}unsubscribeDOME(t,e){this._removeSubscription("DOME",t,e)}unsubscribePipValue(t,e){this._removeSubscription("PipValue",t,e)}unsubscribePL(t,e){this._removeSubscription("PL",t,e)}unsubscribeTradePL(t,e){this._removeSubscription("TradePL",t,e)}unsubscribeCryptoBalance(t,e){this._removeSubscription("CryptoBalance",t,e)}unsubscribeEquity(t){this._removeSubscription("Equity","Equity",t)}unsubscribeMarginAvailable(t){this._removeSubscription("MarginAvailable","MarginAvailable",t)}async accountMetainfo(){const t=await this.accountsMetainfo(),e=this.currentAccount(),i=t.find((t=>t.id===e));if(void 0===i)throw new Error("accountMetainfo not received");return i}accountsMetainfo(){return Object(d.a)(this._brokerConnection.accountsMetainfo(),1e4,"accountsMetainfo not received")}setCurrentAccount(t){if(void 0===this._brokerConnection.setCurrentAccount)throw new Error(this._brokerMetainfo.title+" doesn't support sub-accounts");this._brokerConnection.setCurrentAccount(t)}symbolInfo(t){return Object(d.a)(this._brokerConnection.symbolInfo(t),1e4,"symbolInfo not received")}async getPositionCurrency(t){try{const e=await this._brokerConnection.symbolInfo(t);if(this._brokerMetainfo.configFlags.positionPLInInstrumentCurrency&&void 0!==e.currency)return e.currency;const i=await this.accountMetainfo();return Object(v.e)(e,i,!0)}catch(t){return void P.logError(t)}}bugReportInfo(){function t(t){return JSON.parse(JSON.stringify(t))}function e(t){if("object"!=typeof t)return t;if(Object(a.isArray)(t))return t.map(e);const i={};for(const e in t)"object"!=typeof t[e]&&(i[e]=t[e]);return i}return Promise.all([this.orders(),this.positions(),this.config.supportTrades?this.trades():Promise.resolve([])]).then((i=>({activeBroker:this.metainfo().title,orders:e(t(i[0])),positions:e(t(i[1])),trades:e(t(i[2])),silentOrdersPlacement:this._host.silentOrdersPlacement().value(),floatingPanel:Object(o.ensureNotNull)(this._host.sellBuyButtonsVisibility()).value(),account:this.currentAccount(),accountType:this.currentAccountType(),lastUpdates:this._lastFireResult,time:Date.now(),brokerSpecific:this._brokerConnection.bugReportInfo?this._brokerConnection.bugReportInfo():null})))}processErrors(t,e,i,o){if(!Object(a.isPromise)(t))throw new Error("Broker incorrectly implements API, should return Promise");return t.then(o).then((t=>"boolean"!=typeof t||t)).catch((t=>{let o="";return"string"==typeof t?o=t:"object"==typeof t&&"string"==typeof t.message&&(o=Object(f.d)(t.message)),e&&s.enabled("trading_notifications")?(0!==o.length&&("."!==o.slice(-1)&&(o+="."),o+=" "),o+=Object(r.t)("To learn more, please contact your broker."),this._host.showNotification(i||"",o,0)):P.logWarn(t),Promise.resolve(!1)})).then((t=>(this.tradingOperationFinished.fire(t),t)))}setDurations(t){this._brokerMetainfo.durations=t.slice()}setSymbolSearchId(t){this._brokerMetainfo.backendBrokerName=t}getRealtimeDataCheckParams(){return this._brokerConnection.getRealtimeDataCheckParams?this._brokerConnection.getRealtimeDataCheckParams():{}}getVerifyLiveAccountParams(){if(void 0===this._brokerConnection.getVerifyLiveAccountParams)throw new Error(`Method getVerifyLiveAccountParams for broker ${this._brokerMetainfo.id} is not implemented`);return this._brokerConnection.getVerifyLiveAccountParams()}unhideSymbolSearchGroups(){return this._brokerConnection.unhideSymbolSearchGroups?this._brokerConnection.unhideSymbolSearchGroups():[]}destroy(){void 0!==this._brokerConnection.destroy&&this._brokerConnection.destroy()}currentBroker(){return this._brokerMetainfo.id}_initializeConnectProtection(){let t=null;this.connectionStatusUpdate.subscribe(null,(e=>{if(t&&(clearTimeout(t),t=null),2===e){const e=Object(v.g)(this.config.authorizationType)?18e4:6e4;t=setTimeout((()=>{this._host.selectBroker(),this._host.showNotification(Object(r.t)("Authorization Error"),Object(r.t)("The connection attempt failed. Please try again later."))}),e)}}))}_fakeSubscribeDOME(t){this._fakeDomeSubscriptions[t]=(t,e)=>{const i=e.ask||e.trade,r=e.bid||e.trade,s={snapshot:!0,asks:i?[{price:i,volume:e.ask_size||1/0}]:[],bids:r?[{price:r,volume:e.bid_size||1/0}]:[]};this._host.domeUpdate(t,s)},this.subscribeRealtime(t,this._fakeDomeSubscriptions[t])}_fakeUnsubscribeDOME(t){this.unsubscribeRealtime(t,this._fakeDomeSubscriptions[t])}_isMaintenance(){return isFeatureEnabled(Object(v.j)(this._brokerMetainfo.id))}_isBrokerSideMaintenance(){return isFeatureEnabled(Object(v.i)(this._brokerMetainfo.id))}_patchBrokerSubscribeUnsubscribeDOMEMethods(){const t=!this._brokerMetainfo.configFlags.supportLevel2Data;this._brokerConnection.subscribeDOME=t?t=>{this._fakeSubscribeDOME(t)}:this._originalDOMESubscriptionMethods.subscribeDOME,this._brokerConnection.unsubscribeDOME=t?t=>{this._fakeUnsubscribeDOME(t)}:this._originalDOMESubscriptionMethods.unsubscribeDOME}_createProfitLossEmitter(t){return new n(t,this,this._host)}_patchMetainfo(t){const e=Object(y.deepCopy)(t);return e.configFlags.supportNativeReversePosition=!this.config.supportMultiposition||this.config.supportNativeReversePosition,e.configFlags.supportClosePosition=!0,e.configFlags.supportPLUpdate=!0,e}_addSubscription(t,e,i){this._pendingSubscriptions.push({brokerMethodName:t,symbol:e,listener:i});const r=this._lastFireResult[e];if(void 0!==r&&void 0!==r[t]&&null!==r[t]&&i(e,r[t].data),!this._removePendingSubscription({brokerMethodName:t,symbol:e,listener:i}))return;void 0===this._subscriptions[e]&&(this._subscriptions[e]={Realtime:[],PL:[],Equity:[],DOME:[],TradePL:[],PipValue:[],MarginAvailable:[],CryptoBalance:[]});const s=Object(o.ensure)(this._subscriptions[e]),n=s[t].length>0;if(s[t].push(i),!n&&(s[t].length>0||"CryptoBalance"===t)){const i="subscribe"+t;this._brokerConnection[i]&&this._brokerConnection[i](e)}}_removePendingSubscription(t){const e=this._pendingSubscriptions.findIndex((e=>e.symbol===t.symbol&&e.brokerMethodName===t.brokerMethodName&&e.listener===t.listener));return-1!==e&&(this._pendingSubscriptions.splice(e,1),!0)}_removeSubscription(t,e,i){if(this._removePendingSubscription({brokerMethodName:t,symbol:e,listener:i}))return;if(void 0===this._subscriptions[e])return;const r=Object(o.ensure)(this._subscriptions[e]),s=r[t].indexOf(i);if(s>-1&&r[t].splice(s,1),0===r[t].length){const i="unsubscribe"+t;this._brokerConnection[i]&&this._brokerConnection[i](e)}}_positions(){return this._positionsCache?this._positionsCache.getObjects():Promise.resolve([])}_trades(){return this._tradesCache?this._tradesCache.getObjects():Promise.resolve([])}_orders(){return this._ordersCache.getObjects()}_makeSureBrokerIsConnected(){Object(o.assert)(1===this.connectionStatus(),"Broker is not connected")}_placeReversePositionOrder(t){const e=w(2*t.qty,t);return this.placeOrder(e)}_reversePosition(t){return this.config.supportNativeReversePosition&&this._brokerConnection.reversePosition?this.processErrors(this._brokerConnection.reversePosition(t),!0,window.t("Failed to reverse position")):this.positionById(t).then((t=>{const e=Object(o.ensureDefined)(t);return this.processErrors(this._placeReversePositionOrder(e),!0,Object(r.t)("Failed to reverse position"),(()=>Object(o.ensureNotNull)(this._tradingStat).trackOrderPlaced()))}))}async _waitForOrderModification(t){const e=await this.orderById(t.id);return!!C(t,Object(o.ensureDefined)(e))||new Promise((e=>{const i=()=>this.orderUpdate.unsubscribe(this,r),r=r=>{(t.id===r.id||C(t,r))&&(e(!0),i(),clearTimeout(s))};this.orderUpdate.subscribe(this,r);const s=setTimeout((()=>{e(!1),this._brokerLogger.logError("Failed to modify order: timeout waiting for new order"),i()}),3e4)}))}}var S=i("nc0P"),E=i("Vdly"),T=i.n(E),j=i("hY0g"),L=i.n(j),N=i("jCNj"),D=i("zXvd"),A=i("cUJV"),I=i("IWXC");const M=Object(h.getLogger)("Trading.CredentialsWebStorage");class x{constructor(t){this._storage=t}setItem(t,e){try{const i=Object(a.isObject)(e)?JSON.stringify(e):String(e);this._storage.setItem(t,i)}catch(e){M.logError(`Unable to save credentials using key ${t}: ${e.message}`)}}getItem(t,e=null){let i=e;const r=this._storage.getItem(t);if(null===r)return i;try{i=JSON.parse(r)}catch(t){i=r}return i}removeItem(t){this._storage.removeItem(t)}}class V extends x{constructor(){super(localStorage)}}class R extends x{constructor(){super(sessionStorage)}}class q{constructor(t,e){this._localStorageProvider=null,this._sessionStorageProvider=null,this._brokerId=t.toLowerCase(),this._rememberCredentials=e}save(t,e){this._currentStorageProvider().setItem(`${this._brokerId}.${t}`,e)}load(t,e){return this._currentStorageProvider().getItem(`${this._brokerId}.${t}`,e)}clear(t){this._currentStorageProvider().removeItem(`${this._brokerId}.${t}`)}_currentStorageProvider(){return this._rememberCredentials.value()?(null===this._localStorageProvider&&(this._localStorageProvider=new V),this._localStorageProvider):(null===this._sessionStorageProvider&&(this._sessionStorageProvider=new R),this._sessionStorageProvider)}}class U{constructor(t){this._settingsKey=`trading.${t}.rememberCredentials`}value(){return T.a.getBool(this._settingsKey,!0)}setValue(t){T.a.setValue(this._settingsKey,t)}}var F=i("kcTO"),W=i("fZEr"),Q=i("5det"),H=i("VBos"),z=i("1rjR"),K=i("QBLL"),G=i("C9TK");class J{constructor(t,e){var i;this._setDefaultDropdownActionsBound=this._setDefaultDropdownActions.bind(this),this._trading=t,this._metainfo=e,this._setDefaultDropdownActionsBound=this._setDefaultDropdownActions.bind(this),this._defaultDropdownActions=!0,this._credentialsStorage=new q(this._metainfo.id,new U(this._metainfo.id)),this._setDefaultDropdownActions(),null!==this._trading&&(null===(i=this.sellBuyButtonsVisibility())||void 0===i||i.subscribe(this._setDefaultDropdownActionsBound),Object(o.ensureNotNull)(this.orderPanelVisibility()).subscribe(this._setDefaultDropdownActionsBound),Object(o.ensureNotNull)(this.domPanelVisibility()).subscribe(this._setDefaultDropdownActionsBound))}getLogger(){return Object(h.getLogger)("Trading."+this._metainfo.id)}translate(t){return t}setBrokerConnectionAdapter(t){this._adapter=t}patchConfig(t){this._adapter.patchConfig(t)}showOrderDialog(t,e){return Object(o.ensureNotNull)(this._trading).orderViewController().showOrderView(this._adapter,t,e)}showPositionBracketsDialog(t,e,i){return Object(o.ensureNotNull)(this._trading).orderViewController().showPositionView(this._adapter,t,e,i)}showCancelOrderDialog(t,e){return z.a.get().open(t).then((t=>{t&&this._adapter.processErrors(e(),!0,$.t("Failed to cancel order"))}))}showCancelMultipleOrdersDialog(t,e,i,r){return z.a.get().multiple(t,e,i).then((t=>{t&&this._adapter.processErrors(r(),!0,$.t("Failed to cancel one or more orders"))}))}showCancelBracketsDialog(t,e){return K.a.get().open(t).then((t=>{t&&this._adapter.processErrors(e(),!0,$.t("Failed to cancel brackets"))}))}showCancelMultipleBracketsDialog(t,e){return K.a.get().multiple(t).then((t=>{t&&this._adapter.processErrors(e(),!0,$.t("Failed to cancel brackets"))}))}showReversePositionDialog(t,e){return Object(G.a)(t,Object(o.ensureNotNull)(this._trading).showErrorNotification,e)}showMessageDialog(t,e,i=!1){i?Object(W.showWarning)({title:t,html:e}):Object(W.showWarning)({title:t,text:e})}showConfirmDialog(t,e,i,r,s){return Object(Q.a)(t,e,i,r,s)}showSimpleConfirmDialog(t,e,i,r,s){return Object(H.a)({title:t,text:Array.isArray(e)?e.join(" "):e,mainButtonText:i,mainButtonIntent:"primary",cancelButtonText:r,showDisableConfirmationsCheckbox:s})}setDurations(t){this._adapter.setDurations(t)}setSymbolSearchId(t){this._adapter.setSymbolSearchId(t)}activateBottomWidget(){return null!==this._trading?this._trading.toggleTradingWidget():Promise.reject("Activate bottom widget failed: trading is not defined")}trackEvent(t,e,i){null!==this._trading&&this._trading.trackEvent(t,e,i)}defaultFormatter(t,e){return Object(I.getQuoteSessionInstance)("simple").formatter(t,e)}numericFormatter(t){return Promise.resolve(new D.NumericFormatter(t))}quantityFormatter(t){return Promise.resolve(new A.a(t))}selectBroker(){null!==this._trading&&this._trading.selectBroker(null)}showTradingProperties(){null!==this._trading&&this._trading.showTradingProperties()}async getSymbolType(t){return(await Z(t)).type}async getSymbolMinTick(t){const e=await Z(t);return Number(Object(S.Big)(e.minmov).div(e.pricescale))}suggestedQty(){return Object(o.ensureNotNull)(this._trading).suggestedQty()}silentOrdersPlacement(){return Object(o.ensureNotNull)(this._trading).noConfirmEnabled}sellBuyButtonsVisibility(){return null!==this._trading&&s.enabled("buy_sell_buttons")?this._trading.showSellBuyButtons:null}domPanelVisibility(){return null!==this._trading?this._trading.domPanelVisibility():null}orderPanelVisibility(){return null!==this._trading?this._trading.orderPanelVisibility():null}showPricesWithZeroVolume(){return Object(o.ensureNotNull)(this._trading).showPricesWith().zeroVolume}showNotification(t,e,i=0){null!==this._trading&&(0===i?this._trading.showErrorNotification(t,e):this._trading.showSuccessNotification(t,e))}connectionStatusUpdate(t,e){this._adapter.connectionStatusUpdate.fire(t,e),1===t&&this._setDefaultDropdownActions()}orderUpdate(t){this._adapter.onOrderUpdate(t)}positionUpdate(t,e){this._adapter.onPositionUpdate(t,e)}tradeUpdate(t,e){this._adapter.onTradeUpdate(t,e)}orderPartialUpdate(t,e){this._adapter.onOrderPartialUpdate(t,e)}positionPartialUpdate(t,e){this._adapter.onPositionPartialUpdate(t,e)}tradePartialUpdate(t,e){this._adapter.onTradePartialUpdate(t,e)}executionUpdate(t){this._adapter.executionUpdate.fire(t)}currentAccountUpdate(){this._adapter.onCurrentAccountChanged()}realtimeUpdate(t,e){this._adapter.fireSubscription("Realtime",t,e)}domeUpdate(t,e){this._adapter.fireSubscription("DOME",t,e)}pipValueUpdate(t,e){this._adapter.fireSubscription("PipValue",t,e)}plUpdate(t,e){this._adapter.fireSubscription("PL",t,e)}tradePLUpdate(t,e){this._adapter.fireSubscription("TradePL",t,e)}equityUpdate(t){this._adapter.fireSubscription("Equity","Equity",t)}marginAvailableUpdate(t){this._adapter.fireSubscription("MarginAvailable","MarginAvailable",t)}cryptoBalanceUpdate(t,e){this._adapter.fireSubscription("CryptoBalance",t,e)}setButtonDropdownActions(t){var e;null!==this._trading&&this._defaultDropdownActions&&(this._defaultDropdownActions=!1,null===(e=this.sellBuyButtonsVisibility())||void 0===e||e.unsubscribe(this._setDefaultDropdownActionsBound),Object(o.ensureNotNull)(this.orderPanelVisibility()).unsubscribe(this._setDefaultDropdownActionsBound),Object(o.ensureNotNull)(this.domPanelVisibility()).unsubscribe(this._setDefaultDropdownActionsBound)),this._buttonDropdownActions=t}buttonDropdownActions(){return this._buttonDropdownActions}defaultContextMenuActions(...t){return null!==this._trading?this._trading.defaultContextMenuActions(...t):Promise.resolve([])}defaultDropdownMenuActions(t){return null!==this._trading?this._trading.defaultDropdownMenuActions(t):[]}get factory(){return{createDelegate:()=>new l.a,createWatchedValue:t=>new L.a(t),createPriceFormatter:(t,e,i,r)=>new F.PriceFormatter(t,e,i,r)}}get settings(){return{save:(t,e)=>T.a.setJSON(`${this._metainfo.id}.${t}`,e),load:(t,e)=>T.a.getJSON(`${this._metainfo.id}.${t}`,e),clear:(t,e)=>T.a.remove(`${this._metainfo.id}.${t}`,e)}}get credentialsStorage(){return{save:(t,e)=>this._credentialsStorage.save(t,e),load:(t,e)=>this._credentialsStorage.load(t,e),clear:t=>this._credentialsStorage.clear(t)}}createMapper(t){let e=null;return e={tvToBroker:t=>t,brokerToTv:t=>t},e}createMapperSync(t,e){let i=null;{const t=Promise.resolve();i={ready:()=>t,tvToBroker:t=>t,brokerToTv:t=>t}}return i}convertTimezone(t,e,i){const r=N.get_timezone(e),s=N.get_timezone(i),o=N.cal_to_utc(r,t);return N.utc_to_cal(s,o)}language(){return window.language}getUserSpecificHash(){return window.user.private_channel||""}activateFXCMCFD(){T.a.setValue("fxcm_cfd",!0)}async isFractional(t){return(await Z(t)).fractional}_setDefaultDropdownActions(){null!==this._trading&&this._defaultDropdownActions&&(this._buttonDropdownActions=this.defaultDropdownMenuActions())}}function Z(t){return Object(I.getQuoteSessionInstance)("full").snapshot(t)}var Y=i("U/Is"),X=i("E9hm");i.d(e,"addBroker",(function(){return et})),i.d(e,"brokersList",(function(){return it})),i.d(e,"createBrokerConnection",(function(){return rt}));const tt=[];function et(t,e){t.configFlags=Object(X.applyDefaultsToConfigFlags)(t.configFlags),tt.push({metainfo:t,createBrokerFunction:e})}function it(){return tt.map((t=>t.metainfo))}function rt(t,e,i){return new Promise((r=>{const s=tt.filter((t=>t.metainfo.id===e))[0],o=new J(t,s.metainfo);s.createBrokerFunction(o,(e=>{const n=new Y.a(s.metainfo.id);r(new O(s.metainfo,e,o,n,t&&t.tradingStat(),i))}))}))}},"I92+":function(t,e,i){var r=i("rjQZ");t.exports=function(t){return t=r(t^=t>>>16,2246822507),t=r(t^=t>>>13,3266489909),(t^=t>>>16)>>>0}},ItnF:function(t,e,i){t.exports={dialog:"dialog-2cMrvu9r",wrapper:"wrapper-2cMrvu9r",separator:"separator-2cMrvu9r"}},LVLx:function(t,e,i){"use strict";(t=>{function e(t){return t instanceof Node?t:document.createTextNode(String(t))}for(const i of t){if(i.hasOwnProperty("append"))return;Object.defineProperty(i,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(...t){if(1===t.length)return void this.appendChild(e(t[0]));const i=document.createDocumentFragment();for(const r of t)i.appendChild(e(r));this.appendChild(i)}})}})([Element.prototype,Document.prototype,DocumentFragment.prototype])},N8pX:function(t,e,i){t.exports={"css-value-padding":"4px",wrapper:"wrapper-3RnThD8T",notAvailableOnMobile:"notAvailableOnMobile-3RnThD8T",column:"column-3RnThD8T",button:"button-3RnThD8T",sellButton:"sellButton-3RnThD8T",buyButton:"buyButton-3RnThD8T",brokerButton:"brokerButton-3RnThD8T",highButtons:"highButtons-3RnThD8T",withoutBg:"withoutBg-3RnThD8T",lastCharSup:"lastCharSup-3RnThD8T",spreadQtyWrapper:"spreadQtyWrapper-3RnThD8T",spread:"spread-3RnThD8T",withoutQty:"withoutQty-3RnThD8T",qty:"qty-3RnThD8T",loader:"loader-3RnThD8T",loading:"loading-3RnThD8T",buttonText:"buttonText-3RnThD8T",brokerButtonIconWrap:"brokerButtonIconWrap-3RnThD8T",brokerButtonDefault:"brokerButtonDefault-3RnThD8T",touchMode:"touchMode-3RnThD8T",buttons:"buttons-3RnThD8T"}},NTzu:function(t,e,i){"use strict";var r=i("luwt"),s=i("rkVw"),o=i("xqEh"),n=i("PBwO"),a=i("s4BY"),c=i("1R9w"),l=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var i=this._parent,l=this._parents,h=this._unsubscribe,d=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var p=-1,b=l?l.length:0;i;)i.remove(this),i=++p<b&&l[p]||null;if(o.isFunction(h)&&n.tryCatch(h).call(this)===a.errorObject&&(e=!0,t=t||(a.errorObject.e instanceof c.UnsubscriptionError?u(a.errorObject.e.errors):[a.errorObject.e])),r.isArray(d))for(p=-1,b=d.length;++p<b;){var _=d[p];if(s.isObject(_)&&n.tryCatch(_.unsubscribe).call(_)===a.errorObject){e=!0,t=t||[];var m=a.errorObject.e;m instanceof c.UnsubscriptionError?t=t.concat(u(m.errors)):t.push(m)}}if(e)throw new c.UnsubscriptionError(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var i=e;switch(typeof e){case"function":i=new t(e);case"object":if(i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if("function"!=typeof i._addParent){var r=i;(i=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(i),i._addParent(this),i},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}},t.prototype._addParent=function(t){var e=this._parent,i=this._parents;e&&e!==t?i?-1===i.indexOf(t)&&i.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();function u(t){return t.reduce((function(t,e){return t.concat(e instanceof c.UnsubscriptionError?e.errors:e)}),[])}e.Subscription=l},OKVU:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 16" width="20" height="16" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M7.5 2.5C7.5 1.67 8.17 1 9 1h2c.83 0 1.5.67 1.5 1.5v.15h-5V2.5zm6 0v.15H17a2.5 2.5 0 0 1 2.5 2.5v8.35A2.5 2.5 0 0 1 17 16H3a2.5 2.5 0 0 1-2.5-2.5V5.15A2.5 2.5 0 0 1 3 2.65h3.5V2.5A2.5 2.5 0 0 1 9 0h2a2.5 2.5 0 0 1 2.5 2.5zm-12 2.65c0-.83.67-1.5 1.5-1.5h14c.83 0 1.5.67 1.5 1.5v8.35c0 .83-.67 1.5-1.5 1.5H3a1.5 1.5 0 0 1-1.5-1.5V5.15zM9.25 6.5a1.75 1.75 0 1 0 0 3.5h1.5a.75.75 0 0 1 0 1.5h-1.5a.75.75 0 0 1-.75-.75h-1c0 .97.78 1.75 1.75 1.75h.25v1h1v-1h.25a1.75 1.75 0 1 0 0-3.5h-1.5a.75.75 0 0 1 0-1.5h1.5c.41 0 .75.34.75.75h1c0-.97-.78-1.75-1.75-1.75h-.25v-1h-1v1h-.25z"/></svg>'},OZBO:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i("q1tI");const s=i.n(r).a.createContext({setHideClose:()=>{}})},PBwO:function(t,e,i){"use strict";var r,s=i("s4BY");function o(){try{return r.apply(this,arguments)}catch(t){return s.errorObject.e=t,s.errorObject}}e.tryCatch=function(t){return r=t,o}},QBLL:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("YFKU"),s=i("VBos");const o={get(){return this},open:t=>Object(s.a)({title:Object(r.t)("Cancel bracket"),text:Object(r.t)("Are you sure you want to cancel {orderId}bracket?").replace("{orderId}",""!==t?t+" ":""),mainButtonIntent:"primary"}),multiple:t=>Object(s.a)({title:Object(r.t)("Cancel bracket"),text:Object(r.t)("Are you sure you want to cancel {orderId}brackets?").replace("{orderId}",""!==t?t+" ":""),mainButtonIntent:"primary"})}},Qros:function(t,e,i){"use strict";e.empty={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}}},T7lC:function(t,e,i){t.exports={popupWrapper:"popupWrapper-1kEHryCX"}},TI9Z:function(t,e,i){t.exports={headerDropdown:"headerDropdown-3ziJQeAy",header:"header-3ziJQeAy"}},VBos:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i("cJM1");async function s(t){const e=new r.a;if(t.showDisableConfirmationsCheckbox&&e.has(t.text))return!0;const[{showSimpleDialog:s},{SimpleConfirmDialog:o}]=await Promise.all([Promise.all([i.e(4),i.e(14),i.e(16),i.e(28),i.e(88),i.e(129),i.e(3),i.e(75),i.e("create-confirm-dialog")]).then(i.bind(null,"EcUf")),Promise.all([i.e(4),i.e(14),i.e(16),i.e(28),i.e(88),i.e(129),i.e(3),i.e(75),i.e("create-confirm-dialog")]).then(i.bind(null,"Hc1a"))]);return new Promise((i=>{s(Object.assign(Object.assign({},t),{disabledConfirmations:e,onConfirm:e=>{i(!0),void 0!==t.onConfirm&&t.onConfirm(),e.dialogClose()},onClose:()=>{i(!1),void 0!==t.onClose&&t.onClose()}}),o)}))}},VpWK:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},s=function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.ObjectUnsubscribedError=s},WLST:function(t,e,i){"use strict";t.exports=function(t){for(var e=[],i=t.length,r=0;r<i;r++){var s=t.charCodeAt(r);if(s>=55296&&s<=56319&&i>r+1){var o=t.charCodeAt(r+1);o>=56320&&o<=57343&&(s=1024*(s-55296)+o-56320+65536,r+=1)}s<128?e.push(s):s<2048?(e.push(s>>6|192),e.push(63&s|128)):s<55296||s>=57344&&s<65536?(e.push(s>>12|224),e.push(s>>6&63|128),e.push(63&s|128)):s>=65536&&s<=1114111?(e.push(s>>18|240),e.push(s>>12&63|128),e.push(s>>6&63|128),e.push(63&s|128)):e.push(239,191,189)}return new Uint8Array(e).buffer}},XiJV:function(t,e,i){t.exports={separator:"separator-3No0pWrk"}},ZX3N:function(t,e,i){var r=i("rjQZ"),s=i("I92+"),o=i("WLST"),n=new Uint32Array([3432918353,461845907]);function a(t,e){return t<<e|t>>>32-e}t.exports=function(t,e){if(e=e?0|e:0,"string"==typeof t&&(t=o(t)),!(t instanceof ArrayBuffer))throw new TypeError("Expected key to be ArrayBuffer or string");var i=new Uint32Array([e]);return function(t,e){for(var i=t.byteLength/4|0,s=new Uint32Array(t,0,i),o=0;o<i;o++)s[o]=r(s[o],n[0]),s[o]=a(s[o],15),s[o]=r(s[o],n[1]),e[0]=e[0]^s[o],e[0]=a(e[0],13),e[0]=r(e[0],5)+3864292196}(t,i),function(t,e){var i=t.byteLength/4|0,s=t.byteLength%4,o=0,c=new Uint8Array(t,4*i,s);switch(s){case 3:o^=c[2]<<16;case 2:o^=c[1]<<8;case 1:o^=c[0]<<0,o=a(o=r(o,n[0]),15),o=r(o,n[1]),e[0]=e[0]^o}}(t,i),function(t,e){e[0]=e[0]^t.byteLength,e[0]=s(e[0])}(t,i),i.buffer}},cJM1:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var r=i("Vdly"),s=i.n(r),o=i("ZX3N"),n=i.n(o),a=i("8wgr");const c=/[0-9]+([\.,][0-9]+)*([\.,][0-9]+)?|\.[0-9]+/gm,l=/[A-Z]+/gm,u=a.a.DISABLED_CONFIRMATIONS;class h{add(t){const e=this._getAll(),i=this._makeMessageHash(t);e.add(i),s.a.setJSON(u,Array.from(e))}has(t){const e=this._getAll(),i=this._makeMessageHash(t);return e.has(i)}clear(){s.a.remove(u)}_getAll(){return new Set(s.a.getJSON(u))}_makeMessageHash(t){const e=t.replace(c,"").replace(l,"");return i=n()(e),btoa(String.fromCharCode.apply(null,new Uint8Array(i)));var i}}},dXtN:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M19.9792 12.2892C19.7396 12.0142 19.3241 11.9812 19.044 12.2149L14.3924 16.098L14.072 16.3655L13.7516 16.098L9.10009 12.2149C8.82008 11.9812 8.40456 12.0142 8.16495 12.2892C7.92467 12.565 7.94981 12.9825 8.22144 13.2275L14.0721 18.504L19.9227 13.2275C20.1943 12.9825 20.2195 12.565 19.9792 12.2892ZM18.4032 11.4472C19.1009 10.8648 20.1362 10.9471 20.7332 11.6323C21.3318 12.3195 21.2692 13.3597 20.5924 13.9701L14.407 19.5486L14.0721 19.8506L13.7373 19.5486L7.55171 13.9701C6.87492 13.3597 6.81229 12.3195 7.41096 11.6323C8.00796 10.9471 9.04326 10.8648 9.74094 11.4473L14.072 15.0628L18.4032 11.4472Z"/></svg>'},dct7:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72" width="72" height="72" fill="none"><g clip-path="url(#clip0)"><path fill="#F0F3FA" fill-rule="evenodd" clip-rule="evenodd" d="M62.1259 28.2153C61.4066 28.8157 61.0001 29.7273 61.0858 30.6604C61.6716 37.0347 59.7763 44.3291 55.3181 50.8221C46.9016 63.0797 32.5383 67.839 23.2366 61.4522C13.935 55.0654 13.2174 39.9512 21.6339 27.6935C26.4984 20.6088 33.3496 16.029 40.0619 14.6585C40.9752 14.472 41.731 13.8291 42.1024 12.9741C42.485 12.0934 42.9606 11.2346 43.5313 10.4123C47.906 4.1093 56.2129 2.33004 62.0853 6.4382C67.9578 10.5464 69.172 18.9863 64.7974 25.2892C64.0194 26.4103 63.1169 27.3882 62.1259 28.2153Z"/><rect width="47.2" height="34" fill="#fff" stroke="#1E222D" stroke-width="2" rx="3.8" x="12.4004" y="16"/><path stroke="#1E222D" stroke-linecap="round" stroke-width="2" d="M3.59961 54H67.1996"/><path fill="#000" fill-rule="evenodd" clip-rule="evenodd" d="M29.1178 31.1324L30.8107 32.8253L32.225 31.4111L30.5321 29.7182L32.225 28.0253L30.8107 26.6111L29.1178 28.304L27.425 26.6111L26.0107 28.0253L27.7036 29.7182L26.0107 31.4111L27.425 32.8253L29.1178 31.1324Z"/><path fill="#000" fill-rule="evenodd" clip-rule="evenodd" d="M43.5182 31.1324L45.2111 32.8253L46.6253 31.4111L44.9325 29.7182L46.6253 28.0253L45.2111 26.6111L43.5182 28.304L41.8253 26.6111L40.4111 28.0253L42.104 29.7182L40.4111 31.4111L41.8253 32.8253L43.5182 31.1324Z"/><path stroke="#000" stroke-width="2" d="M30.5996 38.7H40.7996"/></g></svg>'},fBig:function(t,e,i){t.exports={loader:"loader-HRZE_iH8",loaderItem:"loaderItem-HRZE_iH8","loader-animation":"loader-animation-HRZE_iH8",shown:"shown-HRZE_iH8",touchMode:"touchMode-HRZE_iH8"}},g89m:function(t,e,i){"use strict";var r=i("q1tI"),s=i.n(r),o=i("Eyy1"),n=i("TSYQ"),a=i.n(n),c=i("/3z9"),l=i("d700"),u=i("WXjp"),h=i("02pg"),d=i("uhCe"),p=i("/KDZ"),b=i("pafz"),_=i("ZjKI"),m=i("FQhm"),g=i("Iivm"),f=i("OZBO"),y=i("zztK"),v=i("px1m");function w(t){const{title:e,subtitle:i,showCloseIcon:o=!0,onClose:n,renderBefore:c,renderAfter:l,draggable:u,className:h}=t,[d,p]=Object(r.useState)(!1);return s.a.createElement(f.a.Provider,{value:{setHideClose:p}},s.a.createElement("div",{className:a()(v.container,h,i&&v.unsetAlign)},c,s.a.createElement("div",{"data-dragg-area":u,className:v.title},s.a.createElement("div",{className:v.ellipsis},e),i&&s.a.createElement("div",{className:a()(v.ellipsis,v.subtitle)},i)),l,o&&!d&&s.a.createElement(g.a,{className:v.close,icon:y,onClick:n,"data-name":"close","data-role":"button"})))}var k=i("ItnF");i.d(e,"a",(function(){return C}));const P={vertical:20},B={vertical:0};class C extends s.a.PureComponent{constructor(){super(...arguments),this._controller=null,this._reference=null,this._renderChildren=(t,e)=>(this._controller=t,this.props.render({requestResize:this._requestResize,centerAndFit:this._centerAndFit,isSmallWidth:e})),this._handleReference=t=>this._reference=t,this._handleClose=()=>{this.props.onClose()},this._handleKeyDown=t=>{var e;if(!t.defaultPrevented&&27===(this.props.onKeyDown&&this.props.onKeyDown(t),Object(c.hashFromEvent)(t))){if(t.defaultPrevented)return;if(this.props.forceCloseOnEsc&&this.props.forceCloseOnEsc())return void this._handleClose();const{activeElement:i}=document,r=Object(o.ensureNotNull)(this._reference);if(null!==i){if(t.preventDefault(),"true"===(e=i).getAttribute("data-haspopup")&&"true"!==e.getAttribute("data-expanded"))return void this._handleClose();if(Object(l.b)(i))return void r.focus();if(r.contains(i))return void this._handleClose()}}},this._requestResize=()=>{null!==this._controller&&this._controller.recalculateBounds()},this._centerAndFit=()=>{null!==this._controller&&this._controller.centerAndFit()}}componentDidMount(){m.subscribe(_.CLOSE_POPUPS_AND_DIALOGS_COMMAND,this._handleClose,null)}componentWillUnmount(){m.unsubscribe(_.CLOSE_POPUPS_AND_DIALOGS_COMMAND,this._handleClose,null)}focus(){Object(o.ensureNotNull)(this._reference).focus()}getElement(){return this._reference}contains(t){var e,i;return null!==(i=null===(e=this._reference)||void 0===e?void 0:e.contains(t))&&void 0!==i&&i}render(){const{className:t,headerClassName:e,isOpened:i,title:r,dataName:o,onClickOutside:n,additionalElementPos:c,additionalHeaderElement:l,backdrop:_,shouldForceFocus:m=!0,showSeparator:g,subtitle:f,draggable:y=!0,fullScreen:v=!1,showCloseIcon:C=!0,rounded:O=!0,isAnimationEnabled:S,growPoint:E,dialogTooltip:T}=this.props,j="after"!==c?l:void 0,L="after"===c?l:void 0;return s.a.createElement(p.a,{rule:d.a.SmallHeight},(c=>s.a.createElement(p.a,{rule:d.a.TabletSmall},(l=>s.a.createElement(u.a,{rounded:!(l||v)&&O,className:a()(k.dialog,t),isOpened:i,reference:this._handleReference,onKeyDown:this._handleKeyDown,onClickOutside:n,onClickBackdrop:n,fullscreen:l||v,guard:c?B:P,boundByScreen:l||v,shouldForceFocus:m,backdrop:_,draggable:y,isAnimationEnabled:S,growPoint:E,name:this.props.dataName,dialogTooltip:T},s.a.createElement("div",{className:k.wrapper,"data-name":o,"data-dialog-name":"string"==typeof r?r:""},void 0!==r&&s.a.createElement(w,{draggable:y&&!(l||v),onClose:this._handleClose,renderAfter:L,renderBefore:j,subtitle:f,title:r,showCloseIcon:C,className:e}),g&&s.a.createElement(h.a,{className:k.separator}),s.a.createElement(b.a.Consumer,null,(t=>this._renderChildren(t,l||v)))))))))}}},hJUO:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M19.9792 16.6205C19.7396 16.8955 19.3241 16.9285 19.044 16.6948L14.3924 12.8117L14.072 12.5442L13.7516 12.8117L9.10009 16.6947C8.82008 16.9285 8.40456 16.8955 8.16495 16.6205C7.92467 16.3447 7.94981 15.9272 8.22144 15.6822L14.0721 10.4057L19.9227 15.6822C20.1943 15.9272 20.2195 16.3447 19.9792 16.6205ZM18.4032 17.4624C19.1009 18.0448 20.1362 17.9626 20.7332 17.2774C21.3318 16.5902 21.2692 15.55 20.5924 14.9396L14.407 9.36109L14.0721 9.05908L13.7373 9.36109L7.55171 14.9396C6.87492 15.55 6.81229 16.5902 7.41096 17.2774C8.00796 17.9626 9.04326 18.0448 9.74094 17.4624L14.072 13.8468L18.4032 17.4624Z"/></svg>'},j0sD:function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return n}));var r,s=i("q1tI"),o=i("wIdT");!function(t){t[t.PlusValue=0]="PlusValue",t[t.IncDec=1]="IncDec",t[t.Clear=2]="Clear",t[t.Default=3]="Default"}(r||(r={}));class n extends s.PureComponent{constructor(t){super(t),this._createClickHandler=(t,e=r.Default)=>()=>{this.props.onClick(t,e)}}render(){let t;switch(this.props.type){case r.PlusValue:case r.IncDec:t=this.props.value;break;case r.Clear:t="clear";break;case r.Default:t="default"}return s.createElement("div",{className:o.button,"data-value":t,onClick:this._createClickHandler(this.props.value,this.props.type)},this.props.icon||this.props.value)}}},jPOK:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("q1tI"),s=i("TSYQ"),o=i("Owlf");function n(t){const e=s("tv-spinner","tv-spinner--shown","tv-spinner--size_"+(t.size||o.a));return r.createElement("div",{className:e,style:t.style,role:"progressbar"},r.createElement("div",{className:"tv-spinner__spinner-layer"},r.createElement("div",{className:"tv-spinner__background tv-spinner__width_element"}),r.createElement("div",{className:"tv-spinner__circle-clipper tv-spinner__width_element tv-spinner__circle-clipper--left"}),r.createElement("div",{className:"tv-spinner__circle-clipper tv-spinner__width_element tv-spinner__circle-clipper--right"})))}i("SzKR")},luwt:function(t,e,i){"use strict";e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}},"nA+3":function(t,e,i){"use strict";var r=i("rfFC"),s=i("qWnh"),o=i("Qros");e.toSubscriber=function(t,e,i){if(t){if(t instanceof r.Subscriber)return t;if(t[s.rxSubscriber])return t[s.rxSubscriber]()}return t||e||i?new r.Subscriber(t,e,i):new r.Subscriber(o.empty)}},nDsj:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},s=i("8yf6"),o=i("VpWK"),n=function(t){function e(e){t.call(this),this._value=e}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var i=t.prototype._subscribe.call(this,e);return i&&!i.closed&&e.next(this._value),i},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.ObjectUnsubscribedError;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(s.Subject);e.BehaviorSubject=n},px1m:function(t,e,i){t.exports={"small-height-breakpoint":"screen and (max-height: 360px)",container:"container-2sL5JydP",unsetAlign:"unsetAlign-2sL5JydP",title:"title-2sL5JydP",subtitle:"subtitle-2sL5JydP",ellipsis:"ellipsis-2sL5JydP",close:"close-2sL5JydP"}},qBrV:function(t,e,i){"use strict";function r(t,e){null===t.firstChild?t.textContent=e:t.firstChild.nodeValue=e}i.d(e,"a",(function(){return r}))},qWnh:function(t,e,i){"use strict";var r=i("tSeh").root.Symbol;e.rxSubscriber="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber},rfFC:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},s=i("xqEh"),o=i("NTzu"),n=i("Qros"),a=i("qWnh"),c=function(t){function e(e,i,r){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=n.empty;break;case 1:if(!e){this.destination=n.empty;break}if("object"==typeof e){if(u(e)){var s=e[a.rxSubscriber]();this.syncErrorThrowable=s.syncErrorThrowable,this.destination=s,s.add(this)}else this.syncErrorThrowable=!0,this.destination=new l(this,e);break}default:this.syncErrorThrowable=!0,this.destination=new l(this,e,i,r)}}return r(e,t),e.prototype[a.rxSubscriber]=function(){return this},e.create=function(t,i,r){var s=new e(t,i,r);return s.syncErrorThrowable=!1,s},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},e}(o.Subscription);e.Subscriber=c;var l=function(t){function e(e,i,r,o){var a;t.call(this),this._parentSubscriber=e;var c=this;s.isFunction(i)?a=i:i&&(a=i.next,r=i.error,o=i.complete,i!==n.empty&&(c=Object.create(i),s.isFunction(c.unsubscribe)&&this.add(c.unsubscribe.bind(c)),c.unsubscribe=this.unsubscribe.bind(this))),this._context=c,this._next=a,this._error=r,this._complete=o}return r(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var i=function(){return t._complete.call(t._context)};e.syncErrorThrowable?(this.__tryOrSetError(e,i),this.unsubscribe()):(this.__tryOrUnsub(i),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},e.prototype.__tryOrSetError=function(t,e,i){try{e.call(this._context,i)}catch(e){return t.syncErrorValue=e,t.syncErrorThrown=!0,!0}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(c);function u(t){return t instanceof c||"syncErrorThrowable"in t&&t[a.rxSubscriber]}},rjQZ:function(t,e,i){"use strict";t.exports=Math.imul||function(t,e){var i=65535&t,r=65535&e;return i*r+((t>>>16&65535)*r+i*(e>>>16&65535)<<16>>>0)|0}},rkVw:function(t,e,i){"use strict";e.isObject=function(t){return null!=t&&"object"==typeof t}},s4BY:function(t,e,i){"use strict";e.errorObject={e:{}}},tSeh:function(t,e,i){"use strict";(function(t){var i="undefined"!=typeof window&&window,r="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,s=i||void 0!==t&&t||r;e.root=s,function(){if(!s)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(this,i("yLpj"))},uhCe:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i("ASyk");const s={SmallHeight:r["small-height-breakpoint"],TabletSmall:r["tablet-small-breakpoint"],TabletNormal:r["tablet-normal-breakpoint"]}},vOQ2:function(t,e,i){"use strict";var r;i.d(e,"d",(function(){return r})),i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return n})),function(t){t.DomPanel="domPanel",t.OrderPanel="orderPanel"}(r||(r={}));const s=400,o=315,n=451},wIdT:function(t,e,i){t.exports={button:"button-2Rly_LHp"}},xqEh:function(t,e,i){"use strict";e.isFunction=function(t){return"function"==typeof t}},zztK:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17" fill="none"><path stroke="currentColor" stroke-width="1.2" d="M1 1l15 15m0-15L1 16"/></svg>'}}]);