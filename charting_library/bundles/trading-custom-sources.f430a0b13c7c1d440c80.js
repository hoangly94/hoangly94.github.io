(window.webpackJsonp=window.webpackJsonp||[]).push([["trading-custom-sources"],{"//HS":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var o=i("jFln");function r(t,e,i,r,s,n,a){t.save(),t.strokeStyle=r;const l=t.lineWidth%2?.5:0;t.translate(e+l,i+l),s&&t.scale(1,-1),Object(o.drawArrow)(t,0,0,0,n,a),t.restore()}},"14ox":function(t,e,i){"use strict";i.d(e,"a",(function(){return C}));var o=i("Eyy1"),r=i("aO4+"),s=i("jFln"),n=i("ikwP"),a=i("zDbI"),l=i("VdBB"),c=i("//lt"),d=i("gAom"),h=i("u+0B"),u=i("XlJ7");function _(t,e,i,o,r,s,a,l){t.save(),t.textAlign="center",t.textBaseline="middle",t.fillStyle=a,t.font=l,t.translate(o,r+s),Object(n.drawScaled)(t,e,()=>{t.fillText(i,0,0)}),t.restore()}function b(t,e,i,o,r,s){t.save(),t.fillStyle=s,t.fillRect(e,i,o,r),t.restore()}let f;class C{constructor(){this._data=null,this._height=19,this._heightBody=19,this._bodyBorderRadius=2,this._prevPixelRatio=null,this._font=null,this._textWidthCache=new h.a,this._cache=null,this._wasSourceMoved=!1}setData(t){var e;const i=(null===(e=this._data)||void 0===e?void 0:e.fontSize)||null,o=(null==t?void 0:t.fontSize)||null;this._data=t,i!==o&&(this._textWidthCache.reset(),this._font=null===o?null:Object(u.makeFont)(o,a.CHART_FONT_FAMILY,"","normal")),this._cache=null}hitTest(t,e){if(null===this._data||this._data.disabled)return null;const i=e.pixelRatio,o=this._cachedCoordinates(e),r=Math.round(t.x*i),s=Math.round(t.y*i),n=r>=o.body.left,a=r<=o.body.right,d=n&&a;if(!(s>=o.top&&s<=o.bottom)||!d)return null;let h={};if(void 0!==this._data.callbacks.onMove){const t=t=>{var e;(null===(e=this._data)||void 0===e?void 0:e.callbacks.onMove)&&this._data.callbacks.onMove(t),this._wasSourceMoved=!0},e=()=>{var t;this._wasSourceMoved&&(null===(t=this._data)||void 0===t?void 0:t.callbacks.onFinishMove)&&this._data.callbacks.onFinishMove(),this._wasSourceMoved=!1};h={cursorType:c.PaneCursorType.Pointer,pressedMouseMoveHandler:t,touchMoveHandler:t,mouseUpHandler:e,touchEndHandler:e}}const u=this._data.callbacks.onContextMenu,_=Object.assign({cursorType:c.PaneCursorType.Default,hideCrosshairLinesOnHover:!0},h),b=Math.round(o.body.left/i),f=Math.round(o.top/i);if(n&&r<o.text.left&&void 0!==this._data.callbacks.onModify){const t=Math.round(o.text.left/i);return new l.HitTestResult(l.HitTestResult.CUSTOM,Object.assign(Object.assign({itemIndex:0},_),{cursorType:c.PaneCursorType.Default,contextMenuHandler:u,clickHandler:this._data.callbacks.onModify,tapHandler:this._data.callbacks.onModify,tooltip:{extendMargin:!0,text:this._data.qty.title,rect:{x:b,y:f,w:t-b,h:this._height}}}))}if(r>=o.text.left&&r<o.close.left)return new l.HitTestResult(l.HitTestResult.CUSTOM,Object.assign(Object.assign({},_),{contextMenuHandler:u}));if(r>=o.close.left&&a&&void 0!==this._data.callbacks.onClose){const t=Math.round(o.body.right/i),e=Math.round(o.close.left/i);return new l.HitTestResult(l.HitTestResult.CUSTOM,Object.assign(Object.assign({itemIndex:1},_),{contextMenuHandler:u,cursorType:c.PaneCursorType.Default,clickHandler:this._data.callbacks.onClose,
tapHandler:this._data.callbacks.onClose,tooltip:{extendMargin:!0,text:this._data.close.title,rect:{x:e,y:f,w:t-e,h:this._height}}}))}return null}drawBackground(t,e){null===this._data||this._data.hovered||this._data.selected||this._drawLinesWithBackground(t,e)}draw(t,e){if(null===this._data)return;const i=e.pixelRatio,o=this._cachedCoordinates(e);if(!this._isDataVisibleInViewport(e))return;(this._data.hovered||this._data.selected)&&this._drawLinesWithBackground(t,e);const r=o.body.right-o.body.left,s=o.body.bottom-o.body.top,n=o.body.top+o.borderWidth,a=s-2*o.borderWidth,l=o.borderRadius-o.borderWidth;Object(d.drawRoundRectWithInnerBorder)(t,o.body.left,o.body.top,r,s,"transparent",o.borderRadius,o.borderWidth,this._data.borderColor,this._data.borderStyle);const c=(o.body.top+o.body.bottom)/2;let h=o.body.left+o.borderWidth;if(0!==o.qty.width){const e=this._data.qty.active;Object(d.drawRoundRectWithInnerBorder)(t,o.qty.left,n,o.qty.width,a,this._data.qty.backgroundColor,[l,0,0,l]),e.visible&&Object(d.drawRoundRectWithInnerBorder)(t,o.qty.left,n,o.qty.width,a,e.backgroundColor,[l,0,0,l]);const r=o.qty.left+o.qty.width/2;this._drawQuantityText(t,i,r,c),h+=o.qty.width,b(t,h,n,o.borderWidth,a,this._data.qty.dividerColor),h+=o.borderWidth}if(0!==o.text.width){const e=0!==o.close.width?0:[0,l,l,0];Object(d.drawRoundRectWithInnerBorder)(t,o.text.left,n,o.text.width,a,this._data.text.backgroundColor,e);const r=o.text.left+o.text.width/2;this._drawBodyText(t,i,r,c),h+=o.text.width,b(t,h,n,o.borderWidth,a,this._data.text.dividerColor),h+=o.borderWidth}if(0!==o.close.width){const e=o.body.right-h-o.borderWidth,r=this._data.close.active;Object(d.drawRoundRectWithInnerBorder)(t,h,n,e,a,this._data.close.backgroundColor,[0,l,l,0]),r.visible&&Object(d.drawRoundRectWithInnerBorder)(t,h,n,e,a,r.backgroundColor,[0,l,l,0]),this._drawCloseButton(t,i,h,o.body.top,o.close.width,s,o.borderWidth)}}_cachedCoordinates(t){const e=t.pixelRatio;return(null===this._cache||this._prevPixelRatio!==e||this._cache.cssWidth!==t.cssWidth)&&(this._prevPixelRatio!==e&&(this._textWidthCache.reset(),this._prevPixelRatio=e),f||function(){const t=document.createElement("canvas");t.width=0,t.height=0,f=Object(o.ensureNotNull)(t.getContext("2d"))}(),this._cache=this._calculateCache(t)),Object(o.ensureNotNull)(this._cache)}_calculateCache(t){const e=t.pixelRatio,i=Math.round(t.cssWidth*e),r=Object(o.ensureNotNull)(this._data),s=Math.max(1,Math.floor(1*e)),n=this._bodyBorderRadius,a=Math.max(n,Math.floor(n*e)),l=this._quantityWidth(f),c=Math.round(l*e),d=this._textWidth(f),h=Math.round(d*e),u=r.callbacks.onClose?this._closeWidth():0,_=Math.round(u*e),b=s*((l&&1)+(d&&1)),C=c+h+_+b+2*s,p=this._calcAllWidth(t.pixelRatio,c,h,_,b,s);let v=Math.round(this._heightBody*e);const x=Math.max(1,Math.floor(e));v%2!=x%2&&(v+=1)
;const y=Math.round(r.y*e),g=Math.floor(y+x/2-v/2)-Math.floor(.5*e),m=Math.round((this._height-this._heightBody)/2*e),w=g-m,k=v+2*m,O=i-p,S=Math.round(r.line.width*e),P=Math.max(S/100*i,1),F=Math.round(i-Math.min(O,P)),M=F-C,D=M+c+(c&&s)+(c&&s),T=D+h+(h&&s);return{borderWidth:s,borderRadius:a,cssWidth:t.cssWidth,yMid:y,top:w,bottom:w+k,left:0,right:i,body:{left:M,right:F,top:g,bottom:g+v},qty:{width:c,left:M+(c&&s)},text:{width:h,left:D},close:{width:_,left:T}}}_calcAllWidth(t,e,i,o,r,s){return e+i+o+r+2*s}_isDataVisibleInViewport(t){if(null===this._data)return!1;const e=Math.ceil(this._height/2);return this._data.y>=-e&&this._data.y<=t.cssHeight+e}_drawLinesWithBackground(t,e){const i=Object(o.ensureNotNull)(this._data),r=e.pixelRatio,n=this._cachedCoordinates(e),a=Math.round(e.physicalWidth);t.save(),t.strokeStyle=i.line.color,t.lineWidth=Math.max(1,Math.floor(i.line.thickness*r)),Object(s.setLineStyle)(t,i.line.style),Object(d.drawHorizontalLine)(t,n.yMid,n.body.right,a),i.line.extend&&Object(d.drawHorizontalLine)(t,n.yMid,0,n.body.left),t.restore()}_textWidth(t){const e=Object(o.ensureNotNull)(this._data);t.save(),t.font=Object(o.ensureNotNull)(this._font);const i=Math.ceil(this._textWidthCache.measureText(t,e.text.text));return t.restore(),i?Math.round(14+i):0}_closeWidth(){return 23}_drawBodyText(t,e,i,r){const s=Object(o.ensureNotNull)(this._data).text,n=this._textWidthCache.yMidCorrection(t,Object(o.ensureNotNull)(this._data).qty.text)*e;_(t,e,s.text,i,r,n,s.textColor,Object(o.ensureNotNull)(this._font))}_drawQuantityText(t,e,i,r){const s=Object(o.ensureNotNull)(this._data).qty,n=this._textWidthCache.yMidCorrection(t,s.text)*e;_(t,e,s.text,i,r,n,s.textColor,Object(o.ensureNotNull)(this._font))}_drawCloseButton(t,e,i,n,a,l,c){const d=Object(o.ensureNotNull)(this._data).close;t.save(),t.lineWidth=c,t.strokeStyle=d.iconColor;const h=n+l,u=Math.max(1,Math.ceil(7*e)),_=Math.round((a-u)/2),b=Math.round((l-u)/2);Object(s.drawPoly)(t,[new r.Point(i+_,n+b),new r.Point(i+_+u,h-b)],!0),Object(s.drawPoly)(t,[new r.Point(i+_+u,n+b),new r.Point(i+_,h-b)],!0),t.restore()}_quantityWidth(t){const e=Object(o.ensureNotNull)(this._data);t.save(),t.font=Object(o.ensureNotNull)(this._font);const i=Math.ceil(this._textWidthCache.measureText(t,e.qty.text));return t.restore(),Math.round(Math.max(this._height,14+i))}}},EgV8:function(t,e,i){"use strict";i.r(e);var o=i("oV8k"),r=i("Kxc7"),s=i("Eyy1"),n=i("Y7w9"),a=i("XPit"),l=i("k9/m"),c=i("VdBB"),d=i("//HS");class h{constructor(){this._data={points:[],arrowHeight:0}}setData(t){this._data=t}hitTest(t){for(const e of this._data.points){const i=Math.round(e.x),o=Math.round(e.y),r=4;let s,n;if(e.arrowUp?(s=o,n=o+this._data.arrowHeight):(s=o-this._data.arrowHeight,n=o),t.x>=i-2&&t.x<=i+2&&t.y>=s&&t.y<=n&&""!==e.tooltip)return new c.HitTestResult(c.HitTestResult.CUSTOM,{tooltip:{text:e.tooltip,rect:{x:i-2,y:s,w:r,h:n-s}}})}return null}draw(t,e){const i=e.pixelRatio;t.save(),t.lineWidth=Math.max(1,Math.floor(t.lineWidth*i))
;const o=Math.max(1,Math.round(4*i)),r=Math.max(1,Math.round(this._data.arrowHeight*i));for(const s of this._data.points){const e=Math.round((s.x-2)*i),n=Math.round(s.y*i);Object(d.a)(t,e,n,s.arrowColor,!s.arrowUp,r,o)}t.restore()}}class u{constructor(t,e){this._invalidated=!0,this._points=[],this._renderer=new h,this._chartModel=t,this._source=e}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}_updateImpl(){this._points=[],this._renderer.setData({points:[],arrowHeight:0});const t=this._chartModel.timeScale().visibleBarsStrictRange();if(null===t)return;const e=this._source.points();if(0===e.length)return;const i=Object(n.lowerbound)(e,t.firstBar(),(t,e)=>t.index<e,0),o=Object(n.upperbound)(e,t.lastBar(),(t,e)=>e.index>t,i);if(i>=o)return;const r=this._chartModel.mainSeries().priceScale().isInverted(),a=new Map;for(let n=i;n<o;n++){const t=e[n],i=a.get(t.index)||_(r);if(void 0===i.x){const e=this._getXCoordinate(t.index);if(null===e)continue;i.x=e}const o=t.isBuyDirection!==r,l=o?"arrowUp":"arrowDown",c=o?1:-1,d=i[l].y;if(void 0===d){const e=this._getYCoordinate(t.index,t.isBuyDirection);if(null===e)continue;i[l].y=e+11*c}else i[l].y=d+19*c;a.set(t.index,i),this._points.push({x:Object(s.ensureDefined)(i.x),y:Object(s.ensureDefined)(i[l].y),arrowUp:o,arrowColor:i[l].color,tooltip:t.tooltip})}this._renderer.setData({points:this._points,arrowHeight:8})}_getXCoordinate(t){const e=this._chartModel.mainSeries().bars().lastIndex();return null===e||t>e?null:this._chartModel.timeScale().indexToCoordinate(t)}_getYCoordinate(t,e){let i=null;const o=this._chartModel.mainSeries(),r=o.priceSource(),s=null!==r?r:e?"low":"high",n=Object(a.barFunction)(s),c=o.nearestData(t,l.PlotRowSearchMode.NearestLeft);if(void 0!==c){const t=n(c.value);if(!Number.isNaN(t)){const e=o.firstValue();null!==e&&(i=this._chartModel.mainSeries().priceScale().priceToCoordinate(t,e))}}return i}}function _(t){let e,i;return t?(e="#e75656",i="#4094e8"):(e="#4094e8",i="#e75656"),{x:void 0,arrowUp:{y:void 0,color:e},arrowDown:{y:void 0,color:i}}}i.d(e,"ExecutionsSource",(function(){return b}));class b extends o.a{constructor(t,e,i,o,r){super(t,e),this._paneViews=[],this._executionsPointsManager=r,this._executionsPointsManager.existingPointsChanged().subscribe(this,this.updateAllViews),this._showExecutions=o,this._paneViews.push(new u(e,this))}destroy(){this._executionsPointsManager.existingPointsChanged().unsubscribeAll(this),this._executionsPointsManager.destroy(),this._showExecutions.destroy()}points(){return this._executionsPointsManager.existingPoints()}updateAllViews(){if(this._showExecutions.value())for(const t of this._paneViews)t.update()}paneViews(t){return t.containsMainSeries()?window.TradingView.printing&&!r.enabled("snapshot_trading_drawings")?[]:this._showExecutions.value()?this._paneViews:[]:[]}}},J1Ip:function(t,e,i){"use strict";i.r(e)
;var o=i("Eyy1"),r=i("QfUd"),s=i("vTIA"),n=i("GOhO"),a=i("Cf1E"),l=i("txPx"),c=i("uDRY"),d=i("almi"),h=i("NJqN"),u=i("EBrf"),_=i("Ialn"),b=i("2uTr"),f=i("fAa4"),C=i("VdBB"),p=i("//lt"),v=i("//HS"),x=i("jFln"),y=i("gAom"),g=i("14ox");class m extends g.a{constructor(){super(...arguments),this._height=19,this._heightBody=19,this._bodyBorderRadius=2,this._lastTextWidth=0}hitTest(t,e){var i;if(null===this._data||this._data.disabled)return null;const o=e.pixelRatio,r=this._cachedCoordinates(e),s=Math.round(t.x*o),n=Math.round(t.y*o),a=s>=r.reverse.left,l=s<=r.body.right,c=a&&l;if(!(n>=r.top&&n<=r.bottom)||!c)return null;if(void 0!==(null===(i=this._data)||void 0===i?void 0:i.callbacks.onReverse)){const t=r.reverse.left+r.reverse.width;if(s>=r.reverse.left&&s<t){const t=Math.round(r.reverse.left/o),e=Math.round(r.reverse.width/o),i=Math.round(r.top/o);return new C.HitTestResult(C.HitTestResult.CUSTOM,{itemIndex:2,cursorType:p.PaneCursorType.Default,hideCrosshairLinesOnHover:!0,contextMenuHandler:this._data.callbacks.onContextMenu,clickHandler:this._data.callbacks.onReverse,tapHandler:this._data.callbacks.onReverse,tooltip:{extendMargin:!0,text:this._data.reverse.title,rect:{x:t,y:i,w:e,h:this._height}}})}if(s>=t&&s<r.body.left)return new C.HitTestResult(C.HitTestResult.CUSTOM,{cursorType:p.PaneCursorType.Default,hideCrosshairLinesOnHover:!0})}return super.hitTest(t,e)}draw(t,e){var i;if(super.draw(t,e),!(null===(i=this._data)||void 0===i?void 0:i.callbacks.onReverse)||!this._isDataVisibleInViewport(e))return;const o=this._cachedCoordinates(e);this._drawReverseButton(t,e.pixelRatio,o.reverse.left,o.top,o.reverse.width,o.bottom-o.top,o.borderWidth,o.borderRadius)}_drawLinesWithBackground(t,e){var i;if(!(null===(i=this._data)||void 0===i?void 0:i.callbacks.onReverse))return void super._drawLinesWithBackground(t,e);const r=Object(o.ensureNotNull)(this._data),s=e.pixelRatio,n=this._cachedCoordinates(e),a=Math.round(e.physicalWidth),l=n.reverse.left+n.reverse.width;t.save(),t.strokeStyle=r.line.color,t.lineWidth=Math.max(1,Math.floor(r.line.thickness*s)),Object(x.setLineStyle)(t,r.line.style),Object(y.drawHorizontalLine)(t,n.yMid,n.body.right,a),Object(y.drawHorizontalLine)(t,n.yMid,l,n.body.left),r.line.extend&&Object(y.drawHorizontalLine)(t,n.yMid,0,n.reverse.left),t.restore()}_cachedCoordinates(t){return super._cachedCoordinates(t)}_calculateCache(t){const e=super._calculateCache(t),i=Math.round(28*t.pixelRatio),o=e.body.left-i-Math.round(10*t.pixelRatio);return Object.assign(Object.assign({},e),{reverse:{width:i,left:o}})}_calcAllWidth(t,e,i,o,r,s){var n;const a=super._calcAllWidth(t,e,i,o,r,s);if(!(null===(n=this._data)||void 0===n?void 0:n.callbacks.onReverse))return a;return a+Math.round(28*t)+Math.round(10*t)}_textWidth(t){const e=Object(o.ensureNotNull)(this._data);if(!e.text.text)return 0;t.save(),t.font=Object(o.ensureNotNull)(this._font);const i=Math.ceil(this._textWidthCache.measureText(t,e.text.text));if(i>this._lastTextWidth){const e=Math.ceil(this._textWidthCache.measureText(t,"0"));this._lastTextWidth=i+e}
return t.restore(),Math.round(14+this._lastTextWidth)}_closeWidth(){return 23}_drawReverseButton(t,e,i,r,s,n,a,l){const c=Object(o.ensureNotNull)(this._data),d=c.reverse,h=d.active;t.save(),Object(y.drawRoundRectWithInnerBorder)(t,i,r,s,n,d.backgroundColor,l,a,c.borderColor),h.visible&&Object(y.drawRoundRectWithInnerBorder)(t,i,r,s,n,h.backgroundColor,l,a,"transparent");const u=Math.round(2*e),_=Math.round(4*e),b=Math.round(7*e),f=Math.round(i+(s-u)/2-_),C=Math.round(f+_+u),p=Math.round(r+6*e),x=p+b,g=d.iconColor;t.lineWidth=a,Object(v.a)(t,f,p,g,!1,b,_),Object(v.a)(t,C,x,g,!0,b,_),t.restore()}}function w(t,e){if(null===t)return"";const i=Math.abs(t),o=Object(u.splitThousands)((Math.round(100*i)/100||0).toFixed(2)," "),r=t>0?"+ "+o:t<0?"− "+o:o,s=e?`${r} ${e}`:r;return Object(_.startWithLTR)(s)}const k=Object(b.appendEllipsis)(window.t("Protect Position")),O=window.t("Reverse Position"),S=window.t("Close Position");class P extends f.a{constructor(){super(...arguments),this._renderer=new m}_updateImpl(){this._renderer.setData(null);const t=this.priceToCoordinate(this._source.price());if(null===t)return;const e=this._styleGetter(),i=e.reverse;var o,r;this._renderer.setData({y:t,disabled:this._source.isBlocked(),hovered:this.isHoveredSource(),selected:this.isSelectedSource(),callbacks:this._callbacks(),fontSize:13,borderColor:e.borderColor,borderStyle:e.borderStyle,line:{thickness:this._source.lineWidth(),width:this._source.lineLength(),style:this._source.lineStyle(),color:e.lineColor,extend:this._source.isLineExtended()},qty:{title:k,text:Object(f.b)(this._source.qty()),textColor:e.qty.textColor,backgroundColor:e.qty.backgroundColor,dividerColor:e.qty.dividerColor,active:{visible:this.isItemActive(0),backgroundColor:e.qty.activeColor}},text:{text:w(this._source.pl(),this._source.currency()),textColor:(o=this._source.pl(),r=e.text,null===o||0===o?r.textColor:o>0?r.positiveTextColor:r.negativeTextColor),backgroundColor:e.text.backgroundColor,dividerColor:e.text.dividerColor},close:{title:S,backgroundColor:e.close.backgroundColor,iconColor:e.close.iconColor,active:{visible:this.isItemActive(1),backgroundColor:e.close.activeColor}},reverse:{title:O,backgroundColor:i.backgroundColor,iconColor:i.iconColor,active:{visible:this.isItemActive(2),backgroundColor:i.activeColor}}})}_callbacks(){const t={};return this._source.supportReverse()&&(t.onReverse=this._source.onReverse.bind(this._source)),this._source.supportClose()&&(t.onClose=this._source.onClose.bind(this._source)),this._source.supportModify()&&(t.onModify=this._source.onModify.bind(this._source)),this._source.hasContextMenu()&&(t.onContextMenu=this._source.onContextMenu.bind(this._source)),t}}var F=i("972a"),M=i("kGg1"),D=i("npNH");const T=Object(l.getLogger)("Trading.Positions");class E extends c.a{constructor(t,e,i,o,r,s,n){super(t,e,i,o),this._data=null,this._currency="",this._callbacks=s,this._positionDataSpawn=r.spawn(),this._positionDataSpawn.subscribe(this._updateData.bind(this),{callWithLast:!0});const a=()=>function(t,e){
const i=e?M:D,o=t.isBuyDirection()?i.buy:i.sell,r=t.isBlocked()?o.disabled:o.normal;return Object.assign(Object.assign({},r),{lineStyle:t.lineStyle(),borderStyle:F.LineStyle.Solid,labelBorderVisible:!1})}(this,this._model.isDark());this._paneViews.push(new P(e,this,a)),this._priceAxisViews.push(new d.a(e,this,a)),this._priceLineAxisViews.push(new h.a(e,this,21,0,a)),n().then(t=>{this._currency=t,this.updateAllViews(),this._model.updateSource(this)})}destroy(){this._positionDataSpawn.destroy(),super.destroy()}price(){return Object(o.ensureNotNull)(this._data).price}currency(){return this._currency}qty(){return Object(o.ensureNotNull)(this._data).qtyBySide}isBuyDirection(){return 1===Object(o.ensureNotNull)(this._data).side}supportReverse(){return Object(o.ensureNotNull)(this._data).supportReverse}async onReverse(){await this._doActionWithBlock("reversePosition",!0)}supportClose(){return Object(o.ensureNotNull)(this._data).supportClose}async onClose(){await this._doActionWithBlock("closePosition",!0)}supportModify(){return Object(o.ensureNotNull)(this._data).supportBrackets}async onModify(){await this._doActionWithBlock("modifyPosition",!1)}hasContextMenu(){return this.supportModify()||this.supportClose()||this.supportClose()}onContextMenu(t){if(null!==this._data){const e={};this.supportClose()&&(e.closePosition=this._callbacks.closePosition),this.supportReverse()&&(e.reversePosition=this._callbacks.reversePosition),this.supportModify()&&(e.modifyPosition=this._callbacks.modifyPosition),Object(o.ensureDefined)(this._callbacks.showContextMenu)(this._data.id,e,t)}}pl(){return Object(o.ensureNotNull)(this._data).pl}profitState(){return Object(o.ensureNotNull)(this._data).profitState}async _doActionWithBlock(t,e){if(void 0!==this._callbacks[t]&&null!==this._data){e&&this._setIsBlocked(!0);try{await Object(o.ensureDefined)(this._callbacks[t])("Chart Position",this._data.id)}catch(i){T.logWarn(`Try to ${t}, but got error: ${Object(a.a)(i)}`)}finally{e&&this._setIsBlocked(!1)}}}_updateData(t){this._data=t,t.symbol!==this._symbol&&(this._symbol=t.symbol,this._updateActualSymbolAndFormatter()),this.updateAllViews(),this._model.updateSource(this)}}function A(t,e,i,o,r){t.addCustomSource("position"+e,(t,e)=>{const s=e.properties().childs().tradingProperties.childs(),a=Object(n.b)(e.isInReplay.bind(e),e.onInReplayStateChanged()),l=Object(n.a)((t,e)=>e,a,s.showPositions),c={width:s.lineWidth,length:s.lineLength,style:s.lineStyle,extend:s.extendLeft};return new E(t,e,l,c,i,o,r)},s.a.Topmost)}var j=i("ogJP"),B=i("7KDR"),N=i("5VQP");async function V(t,e,i){const r=function(t,e){const i=[];void 0!==e.modifyPosition&&i.push(new B.Action({label:R,statName:"Modify Position",onExecute:()=>Object(o.ensureDefined)(e.modifyPosition)("Chart Position Context Menu",t)}));void 0!==e.closePosition&&i.push(new B.Action({label:W,statName:"Close Position",onExecute:()=>Object(o.ensureDefined)(e.closePosition)("Chart Position Context Menu",t)}));void 0!==e.reversePosition&&i.push(new B.Action({label:L,statName:"Reverse Position",
onExecute:()=>Object(o.ensureDefined)(e.reversePosition)("Chart Position Context Menu",t)}));return i}(t,e);return N.ContextMenuManager.createMenu(r,{}).then(t=>(t.show(i),t))}const R=Object(b.appendEllipsis)(window.t("Protect Position")),W=window.t("Close Position"),L=window.t("Reverse Position");i.d(e,"PositionsManager",(function(){return q}));class q{constructor(t,e,i){this._positionsData=new Map,this._positionsService=t,this._chartWidgetCollection=e,this._brokerCommandsUIGetter=i.brokerCommandsUI,this._trackEvent=i.trackEvent,this._addPositionSources(this._positionsService.positions()),this._positionsService.positionUpdate().subscribe(this,t=>this._addPositionSources([t])),this._positionsService.positionsRemoved().subscribe(this,this._removePositionSources)}destroy(){this._positionsService.positionUpdate().unsubscribeAll(this),this._positionsService.positionsRemoved().unsubscribeAll(this),this._positionsData.clear()}_addPositionSources(t){for(const e of t){const t=e.id,i=Object(j.clone)(e);let o=this._positionsData.get(t);if(void 0===o){o=new r.a(i);const e={};e.reversePosition=this._reversePosition.bind(this),e.closePosition=this._closePosition.bind(this),e.modifyPosition=this._modifyPosition.bind(this),e.showContextMenu=this._showPositionContextMenu.bind(this);const s=this._positionsService.getCurrency.bind(this._positionsService,i.symbol);A(this._chartWidgetCollection,t,o,e,s),this._positionsData.set(t,o)}else o.setValue(i)}}_removePositionSources(t){for(const o of t)e=this._chartWidgetCollection,i=o,e.removeCustomSource("position"+i),this._positionsData.delete(o);var e,i}_reversePosition(t,e){return this._trackEvent(t,"Reverse Position"),Object(o.ensureNotNull)(this._brokerCommandsUIGetter()).reversePosition(e)}_closePosition(t,e){this._trackEvent(t,"Close Position");const i=Object(o.ensureNotNull)(this._brokerCommandsUIGetter());return this._positionsService.isDisplayModeTrades()?i.closeTrade(e):i.closePosition(e)}_modifyPosition(t,e){this._trackEvent(t,"Edit Position");const i=Object(o.ensureNotNull)(this._brokerCommandsUIGetter());return this._positionsService.isDisplayModeTrades()?Object(o.ensureDefined)(i.editTradeBrackets).call(i,e):i.editPositionBrackets(e,{})}_showPositionContextMenu(t,e,i){return V(t,e,i)}}},KSBC:function(t,e,i){"use strict";i.r(e),i.d(e,"ExecutionsPointsManager",(function(){return a}));var o=i("Y7w9"),r=i("aIyQ"),s=i.n(r);function n(t){return void 0!==t.index}class a{constructor(t,e,i){this._points=[],this._existingExecutionPointsCache=null,this._offsetOfFirstExistingPoint=null,this._existingPointsChanged=new s.a,this._pointsets=[],this._pointsetManagerFactory=e,this._firstSeriesTimePointWV=i,this._firstSeriesTimePointWV.subscribe(this._updateExistingPoints.bind(this)),this._executionsService=t,this._addPoints(this._executionsService.executions()),this._executionsService.executionsAdded().subscribe(this,this._addPoints),this._executionsService.executionsCleared().subscribe(this,this._clearPoints)}destroy(){this._clearPoints(),this._firstSeriesTimePointWV.destroy(),
this._executionsService.executionsAdded().unsubscribeAll(this),this._executionsService.executionsCleared().unsubscribeAll(this),this._executionsService.destroy()}existingPoints(){return null===this._offsetOfFirstExistingPoint?[]:(null===this._existingExecutionPointsCache&&(this._existingExecutionPointsCache=this._points.slice(this._offsetOfFirstExistingPoint).filter(n)),this._existingExecutionPointsCache)}existingPointsChanged(){return this._existingPointsChanged}_onExistingStartPointChanged(){this._existingExecutionPointsCache=null,this._existingPointsChanged.fire(this.existingPoints())}_addPoints(t){if(0===t.length)return;const e=function(t){return t.map(t=>({time_t:Math.round(t.time/1e3),index:void 0,isBuyDirection:1===t.side,tooltip:t.tooltip}))}(t);e.sort((t,e)=>t.time_t-e.time_t);let i=0;const r=this._points.length>0;r&&(i=Object(o.upperbound)(this._points,e[0].time_t,(t,e)=>e.time_t>t,0)),this._points=this._points.slice(0,i).concat(e).concat(this._points.slice(i));const s=this._firstSeriesTimePointWV.value();null!==this._offsetOfFirstExistingPoint&&null!==s&&e[0].time_t<s?this._offsetOfFirstExistingPoint=this._offsetOfFirstExistingPoint+e.length:((null===this._offsetOfFirstExistingPoint||e[0].time_t<this._points[this._offsetOfFirstExistingPoint].time_t)&&(this._offsetOfFirstExistingPoint=this._calcOffsetOfFirstExistingPoint()),null!==this._offsetOfFirstExistingPoint&&(r?i>=this._offsetOfFirstExistingPoint&&this._sendPointsToServer(i,i+e.length):this._sendPointsToServer(this._offsetOfFirstExistingPoint,this._points.length)))}_updateExistingPoints(){const t=this._calcOffsetOfFirstExistingPoint();null!==t&&(null===this._offsetOfFirstExistingPoint&&(this._offsetOfFirstExistingPoint=this._points.length),t<this._offsetOfFirstExistingPoint&&(this._sendPointsToServer(t,this._offsetOfFirstExistingPoint),this._offsetOfFirstExistingPoint=t))}_clearPoints(){for(const t of this._pointsets)t.onUpdate().unsubscribeAll(this),t.destroy();this._pointsets=[],this._points=[],this._offsetOfFirstExistingPoint=null,this._onExistingStartPointChanged()}_sendPointsToServer(t,e){const i=this._points.slice(t,e).map(t=>({time_t:t.time_t,offset:0}));if(0===i.length)return;const o=this._pointsetManagerFactory(i);null!==o&&(o.onUpdate().subscribe(this,this._updatePointsFromServer),this._pointsets.push(o))}_updatePointsFromServer(t){if(null===this._offsetOfFirstExistingPoint)return;const e=Object(o.lowerbound)(this._points,t[0].time_t,(t,e)=>t.time_t<e,this._offsetOfFirstExistingPoint);let i=Math.max(this._offsetOfFirstExistingPoint,e);for(const o of t)for(let t=i;t<this._points.length&&(i=t,!(this._points[t].time_t>o.time_t));t++)this._points[t].time_t===o.time_t&&(this._points[t].index=o.index);this._onExistingStartPointChanged()}_calcOffsetOfFirstExistingPoint(){const t=this._firstSeriesTimePointWV.value();return null===t?null:Object(o.upperbound)(this._points,t,(t,e)=>e.time_t>t,0,this._offsetOfFirstExistingPoint||this._points.length)}}},NJqN:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var o=i("TmNs")
;class r extends o.PriceLineAxisView{constructor(t,e,i,o,r){super(),this._chartModel=t,this._source=e,this._height=i,this._verticalPadding=o,this._styleGetter=r}_value(){const t=this._chartModel.mainSeries(),e=t.firstValue(),i=this._source.price();if(null===i||null===e)return{noData:!0};const o=t.priceScale().priceToCoordinate(i,e);return{noData:!1,floatCoordinate:o,coordinate:o,color:"",formattedPricePercentage:"",formattedPriceAbsolute:"",text:"",index:0}}_updateRendererData(t,e,i){const o=this._styleGetter();t.linestyle=o.lineStyle,i.additionalPaddingTop=this._verticalPadding,i.additionalPaddingBottom=this._verticalPadding,super._updateRendererData(t,e,i)}_priceLineColor(t){return this._styleGetter().lineColor}_lineWidth(){return this._source.lineWidth()}_lineStyle(){return this._styleGetter().lineStyle}_backgroundAreaHeight(){return this._height}_isVisible(){return this._source.showProperty().value()}}},Oc7V:function(t){
t.exports=JSON.parse('{"buy":{"normal":{"labelTickColor":"#1976D2","lineColor":"#1976D2","borderColor":"#1976D2","qty":{"backgroundColor":"#131722","textColor":"#1976D2","dividerColor":"#144987","activeColor":"rgba(33, 150, 243, 0.1)"},"text":{"backgroundColor":"#131722","textColor":"#1976D2","dividerColor":"#144987"},"close":{"backgroundColor":"#131722","iconColor":"#1976D2","activeColor":"rgba(33, 150, 243, 0.1)"}},"disabled":{"labelTickColor":"#1976D2","lineColor":"#1976D2","borderColor":"#1976D2","qty":{"backgroundColor":"#131722","textColor":"#1976D2","dividerColor":"#144987","activeColor":"rgba(33, 150, 243, 0.1)"},"text":{"backgroundColor":"#131722","textColor":"#1976D2","dividerColor":"#144987"},"close":{"backgroundColor":"#131722","iconColor":"rgba(25, 118, 210, 0.2)","activeColor":"rgba(33, 150, 243, 0.1)"}}},"sell":{"normal":{"labelTickColor":"#EF5350","lineColor":"#EF5350","borderColor":"#EF5350","qty":{"backgroundColor":"#131722","textColor":"#EF5350","dividerColor":"#862226","activeColor":"rgba(239, 83, 80, 0.1)"},"text":{"backgroundColor":"#131722","textColor":"#EF5350","dividerColor":"#862226"},"close":{"backgroundColor":"#131722","iconColor":"#EF5350","activeColor":"rgba(239, 83, 80, 0.1)"}},"disabled":{"labelTickColor":"#EF5350","lineColor":"#EF5350","borderColor":"#EF5350","qty":{"backgroundColor":"#131722","textColor":"#EF5350","dividerColor":"#862226","activeColor":"rgba(239, 83, 80, 0.1)"},"text":{"backgroundColor":"#131722","textColor":"#EF5350","dividerColor":"#862226"},"close":{"backgroundColor":"#131722","iconColor":"rgba(244, 67, 54, 0.2)","activeColor":"rgba(239, 83, 80, 0.1)"}}},"takeProfit":{"normal":{"labelTickColor":"#26a69a","lineColor":"#26a69a","borderColor":"#26a69a","qty":{"backgroundColor":"#131722","textColor":"#26a69a","dividerColor":"#0A2622","activeColor":"rgba(38, 166, 154, 0.15)"},"text":{"backgroundColor":"#131722","textColor":"#26a69a","dividerColor":"#0A2622"},"close":{"backgroundColor":"#131722","iconColor":"#26a69a","activeColor":"rgba(38, 166, 154, 0.15)"}},"disabled":{"labelTickColor":"#26a69a","lineColor":"#26a69a","borderColor":"#26a69a","qty":{"backgroundColor":"#131722","textColor":"#26a69a","dividerColor":"#0A2622","activeColor":"rgba(38, 166, 154, 0.15)"},"text":{"backgroundColor":"#131722","borderColor":"#26a69a","textColor":"#26a69a","dividerColor":"#0A2622","activeColor":"rgba(38, 166, 154, 0.15)"},"close":{"backgroundColor":"#131722","borderColor":"#26a69a","iconColor":"rgba(38, 166, 154, 0.2)","activeColor":"rgba(38, 166, 154, 0.15)"}}},"stopLoss":{"normal":{"labelTickColor":"#FFA726","lineColor":"#FFA726","borderColor":"#FFA726","qty":{"backgroundColor":"#131722","textColor":"#FFA726","dividerColor":"#504625","activeColor":"rgba(255, 167, 38, 0.15)"},"text":{"backgroundColor":"#131722","textColor":"#FFA726","dividerColor":"#504625"},"close":{"backgroundColor":"#131722","iconColor":"#FFA726","activeColor":"rgba(255, 167, 38, 0.15)"}},"disabled":{"labelTickColor":"#FFA726","lineColor":"#FFA726","borderColor":"#FFA726","qty":{"backgroundColor":"#131722","textColor":"#FFA726","dividerColor":"#504625","activeColor":"rgba(255, 167, 38, 0.15)"},"text":{"backgroundColor":"#131722","textColor":"#FFA726","dividerColor":"#504625"},"close":{"backgroundColor":"#131722","iconColor":"rgba(255, 167, 38, 0.2)","activeColor":"rgba(255, 167, 38, 0.15)"}}}}')
},QOhU:function(t,e,i){"use strict";i.r(e);var o=i("Eyy1"),r=i("3+Gi"),s=i("QfUd"),n=i("vTIA"),a=i("GOhO"),l=i("ivNn"),c=i("aO4+"),d=i("ogJP"),h=i("Tmoa"),u=i("14ox"),_=i("fAa4"),b=i("2uTr");const f=Object(b.appendEllipsis)(window.t("Modify Order")),C=window.t("Cancel Order");class p extends _.a{constructor(){super(...arguments),this._renderer=new u.a}_updateImpl(){this._renderer.setData(null);const t=this.priceToCoordinate(this._source.price());if(null===t)return;const e=this._styleGetter(),i=Object(h.generateColor)(e.borderColor,85);this._renderer.setData({y:t,disabled:this._source.isBlocked(),hovered:this.isHoveredSource(),selected:this.isSelectedSource(),callbacks:this._callbacks(),fontSize:13,borderColor:e.borderColor,borderStyle:e.borderStyle,line:{thickness:this._source.lineWidth(),width:this._source.lineLength(),style:e.lineStyle,color:e.lineColor,extend:this._source.isLineExtended()},qty:{title:f,text:Object(_.b)(this._source.qtyText()),textColor:e.qty.textColor,backgroundColor:e.qty.backgroundColor,dividerColor:e.qty.dividerColor,active:{visible:this.isItemActive(0),backgroundColor:i}},text:{text:this._source.text(),textColor:e.text.textColor,backgroundColor:e.text.backgroundColor,dividerColor:e.text.dividerColor},close:{title:C,backgroundColor:e.close.backgroundColor,iconColor:e.close.iconColor,active:{visible:this.isItemActive(1),backgroundColor:i}}})}_callbacks(){const t={};return this._source.supportModify()&&(t.onModify=this._source.onModify.bind(this._source)),this._source.supportCancel()&&(t.onClose=this._source.onCancel.bind(this._source)),this._source.supportMove()&&(t.onMove=this._source.onMove.bind(this._source),t.onFinishMove=this._source.onFinishMove.bind(this._source)),this._source.hasContextMenu()&&(t.onContextMenu=this._source.onContextMenu.bind(this._source)),t}}var v=i("uDRY"),x=i("0W4x"),y=i("almi"),g=i("NJqN"),m=i("972a"),w=i("TNlN"),k=i("Oc7V");const O=window.t("Trailing Stop"),S=window.t("Stop Loss"),P=window.t("Take Profit");class F extends v.a{constructor(t,e,i,o,r,s,n,a,l){super(t,e,r,s),this._quantityFormatter=null,this._data=null,this._quantityFormatterGetter=i,this._parentOrderDataGetter=o,this._callbacks=a,this._exitTrackingMode=l,this._orderData=n,this._orderData.subscribe(this._updateData.bind(this),{callWithLast:!0});const c=()=>function(t,e){const i=e?k:w;let o;o=t.isBracket()?1===t.type()?i.takeProfit:i.stopLoss:t.isBuyDirection()?i.buy:i.sell;const r=t.isBlocked()?o.disabled:o.normal,s=t.isActive()?t.lineStyle():m.LineStyle.Dotted,n=t.isActive()?m.LineStyle.Solid:m.LineStyle.Dotted;return Object.assign(Object.assign({},r),{lineStyle:s,borderStyle:n,labelBorderVisible:!0})}(this,this._model.isDark());this._paneViews.push(new p(e,this,c)),this._priceAxisViews.push(new y.a(e,this,c)),this._priceLineAxisViews.push(new g.a(e,this,19,0,c))}destroy(){this._orderData.unsubscribe(),super.destroy()}price(){return Object(o.ensureNotNull)(this._data).price}qtyText(){const t=Object(o.ensureNotNull)(this._data)
;return Object(o.ensureNotNull)(this._quantityFormatter).format(t.considerFilledQty?t.qty-(t.filledQty||0):t.qty)}text(){const t=Object(o.ensureNotNull)(this._data);if(this.isBracket()){const o=(e=t.type,i=t.stopType,3===e?i===r.a.TrailingStop?O:S:1===e?P:null);if(null!==o)return o}var e,i;return`${Object(x.l)(t.side)} ${Object(x.i)(t.type)}`}type(){return Object(o.ensureNotNull)(this._data).type}isActive(){return Object(o.ensureNotNull)(this._data).isActive}isBuyDirection(){return 1===Object(o.ensureNotNull)(this._data).side}supportModify(){return Boolean(this._callbacks.modifyOrder)}async onModify(){const t=Object(o.ensureNotNull)(this._data);await Object(o.ensureDefined)(this._callbacks.modifyOrder)("Chart Order",t.id,t.symbol)}supportMove(){return Boolean(this._callbacks.moveOrder)}async onMove(t){const e=new c.Point(t.localX,t.localY),i=this._mainSeries.priceScale(),r=this._mainSeries.firstValue();if(null===r)return;const s=1/this._mainSeries.base(),n=Object(d.clone)(Object(o.ensureNotNull)(this._data)),a=i.coordinateToPrice(e.y,r);n.price=Object(l.fixComputationError)(s*Math.round(a/s)),this._orderData.setValue(n),t.isTouch&&this._exitTrackingMode()}async onFinishMove(){const t=Object(o.ensureNotNull)(this._data);Object(o.ensureDefined)(this._callbacks.moveOrder)("Chart Order",t.id,t.symbol)}supportCancel(){return Boolean(this._callbacks.cancelOrder)}async onCancel(){const t=Object(o.ensureNotNull)(this._data);t.isBlocked||await Object(o.ensureDefined)(this._callbacks.cancelOrder)("Chart Order",t.id)}hasContextMenu(){return null!==this._data&&this._data.hasContextMenu}onContextMenu(t){const e=this._data;null!==e&&this._callbacks.showContextMenu&&this._callbacks.showContextMenu(e.id,e.symbol,this._callbacks,t)}isBracket(){const t=Object(o.ensureNotNull)(this._data),e=t.parentId;if(!e)return!1;const i=this._parentOrderDataGetter(e);return 1!==t.parentType||null!==i&&function(t,e){if(t.side===e.side)return!1;const i=Object(o.ensureDefined)(t.limitPrice||t.stopPrice),r=Object(o.ensureDefined)(e.limitPrice||e.stopPrice);if(1===t.side){if(1===e.type&&r<i||3===e.type&&r>i)return!1}else if(1===e.type&&r>i||3===e.type&&r<i)return!1;return!0}(i,t)}async _updateActualSymbolAndFormatter(){if(null===this._symbol)return;super._updateActualSymbolAndFormatter();null!==this._mainSeries.symbolInfo()&&(this._quantityFormatter=await this._quantityFormatterGetter(this._symbol)),this.updateAllViews()}_updateData(t){this._data=t,this._setIsBlocked(this._data.isBlocked),t.symbol!==this._symbol&&(this._symbol=t.symbol,this._updateActualSymbolAndFormatter()),this.updateAllViews(),this._model.updateSource(this)}}function M(t,e,i,o,r,s){t.addCustomSource("order"+o,(o,n)=>{const l=n.properties().childs().tradingProperties.childs(),c=Object(a.b)(n.isInReplay.bind(n),n.onInReplayStateChanged()),d=Object(a.a)((t,e)=>e,c,l.showOrders),h={width:l.lineWidth,length:l.lineLength,style:l.lineStyle,extend:l.extendLeft};return new F(o,n,e,i,d,h,r,s,()=>t.activeChartWidget.value().exitTrackingMode())},n.a.Topmost)}function D(t,e){
t.removeCustomSource("order"+e)}var T=i("7KDR"),E=i("5VQP");async function A(t,e,i,o){const r=function(t,e,i){const o=[],r=i.modifyOrder;void 0!==r&&o.push(new T.Action({label:j,statName:"Edit Order",onExecute:()=>r("Chart Order Context Menu",t,e)}));const s=i.cancelOrder;void 0!==s&&o.push(new T.Action({label:B,statName:"Cancel Order",onExecute:()=>s("Chart Order Context Menu",t)}));return o}(t,e,i);return E.ContextMenuManager.createMenu(r,{}).then(t=>(t.show(o),t))}const j=Object(b.appendEllipsis)(window.t("Modify Order")),B=window.t("Cancel Order");var N=i("Cf1E"),V=i("txPx");i.d(e,"OrdersManager",(function(){return W}));const R=Object(V.getLogger)("Trading.Order");class W{constructor(t,e,i,o){this._ordersData=new Map,this._stopLimitOrdersData=new Map,this._ordersInModify=new Map,this._quantityFormattersMap=new Map,this._ordersService=t,this._positionService=e,this._chartWidgetCollection=i,this._activeBrokerGetter=o.activeBroker,this._onConnectionStatusChange=o.onConnectionStatusChange,this._brokerCommandsUIGetter=o.brokerCommandsUI,this._trackEvent=o.trackEvent,this._addOrderSources(this._ordersService.activeOrders()),this._ordersService.activeOrdersUpdated().subscribe(this,t=>this._addOrderSources([t])),this._ordersService.activeOrdersRemoved().subscribe(this,this._removeOrderSources),this._onConnectionStatusChange.subscribe(this,()=>this._quantityFormattersMap.clear())}destroy(){this._ordersService.activeOrdersUpdated().unsubscribeAll(this),this._ordersService.activeOrdersRemoved().unsubscribeAll(this),this._ordersData.clear(),this._stopLimitOrdersData.clear(),this._ordersInModify.clear(),this._onConnectionStatusChange.unsubscribeAll(this),this._quantityFormattersMap.clear()}async _quantityFormatter(t){let e=this._quantityFormattersMap.get(t);if(void 0===e){const i=Object(o.ensureNotNull)(this._activeBrokerGetter());e=await i.quantityFormatter(t),this._quantityFormattersMap.set(t,e)}return e}_parentOrder(t){const e=this._ordersData.get(t);return void 0===e?null:e.value()}_addOrderSources(t){for(const e of t){const t=e.id;if(this._ordersInModify.has(t)){this._ordersInModify.set(t,e);continue}let i=Object(d.merge)(Object(d.clone)(e),{isBlocked:!1,hasContextMenu:!0}),o=this._ordersData.get(t);if(void 0===o){if(o=new s.a(i),M(this._chartWidgetCollection,this._quantityFormatter.bind(this),this._parentOrder.bind(this),t,o,this._createCallbacksForOrder(i,!0)),this._ordersData.set(t,o),4===e.type){const o={price:e.limitPrice,considerFilledQty:!1,isActive:!0,hasContextMenu:!1},r=new s.a(Object(d.merge)(Object(d.clone)(e),o));M(this._chartWidgetCollection,this._quantityFormatter.bind(this),this._parentOrder.bind(this),"StopLimit"+t,r,this._createCallbacksForOrder(i,!1)),this._stopLimitOrdersData.set(t,r)}}else{const r=this._stopLimitOrdersData.get(t);void 0!==r&&(4!==e.type?(i=Object(d.merge)(r.value(),{price:e.price}),this._removeNestedStopLimitOrderSource(t)):r.setValue(Object(d.merge)(Object(d.clone)(e),{price:e.limitPrice}))),o.setValue(i)}}}_removeOrderSources(t){for(const e of t)D(this._chartWidgetCollection,e),
this._ordersData.delete(e),this._removeNestedStopLimitOrderSource(e)}_removeNestedStopLimitOrderSource(t){this._stopLimitOrdersData.has(t)&&(D(this._chartWidgetCollection,"StopLimit"+t),this._stopLimitOrdersData.delete(t))}async _getNestedOrdersIds(t){let e=[];const i=await this._ordersService.orders(),o=i.find(e=>e.id===t);if(void 0!==o)if(o.parentId){e=i.filter(t=>t.parentId===o.parentId);const t=i.find(t=>t.id===o.parentId);t&&e.push(t)}else e=i.filter(t=>t.parentId===o.id).concat(o);return e.map(t=>t.id)}async _blockNestedOrders(t,e){const i=await this._getNestedOrdersIds(t);for(const o of i){const t=this._ordersData.get(o);if(t){const i=Object(d.clone)(t.value());i.isBlocked=e,t.setValue(i);const r=this._stopLimitOrdersData.get(o);if(r){const t=Object(d.clone)(r.value());t.isBlocked=e,r.setValue(t)}}}}_createCallbacksForOrder(t,e){const i={};return t.supportModify&&(i.modifyOrder=this._modifyOrder.bind(this,e),i.moveOrder=this._moveOrder.bind(this,e)),e&&(i.cancelOrder=this._cancelOrder.bind(this),i.showContextMenu=this._showContextMenu.bind(this)),i}async _processingModifyOrder(t={},e,i,s){const n=e.parentId;if(n&&e.stopType===r.a.TrailingStop){const t=this._ordersData.get(n),i=t&&t.value()||this._positionService.find(n),r=Object(o.ensureNotNull)(this._activeBrokerGetter()),a=await r.symbolInfo(s),l=await r.quotesSnapshot(s);if(null!==i){let t;t=1!==e.parentType?1===i.side?l.bid:l.ask:3===i.type?i.stopPrice:i.limitPrice,e.trailingStopPips=(Object(o.ensureDefined)(e.stopPrice||e.limitPrice)-t)/a.pipSize*(1===i.side?-1:1)}}let a;this._ordersInModify.set(i.id,i),this._blockNestedOrders(e.id,!0),4===i.type&&(t.useLimitPrice||(a=2),t.useStopPrice||(a=1));let l=!1;try{l=await Object(o.ensureNotNull)(this._brokerCommandsUIGetter()).modifyOrder(e,t.silent,a)}catch(c){R.logError("Try to modify order with error "+Object(N.a)(c))}finally{if(this._ordersData.has(e.id)){const t=Object(o.ensureDefined)(this._ordersInModify.get(e.id));this._ordersInModify.delete(e.id),this._blockNestedOrders(e.id,!1),this._addOrderSources([t])}else this._ordersInModify.delete(e.id)}return l}_modifyOrder(t,e,i,r){this._trackEvent(e,"Edit Order");const s=Object(o.ensureDefined)(this._ordersData.get(i)).value(),n={};t||(n.useLimitPrice=!0);const a=Object(o.ensureNotNull)(this._ordersService.find(i));return this._processingModifyOrder(n,s,a,r)}_cancelOrder(t,e){return this._trackEvent(t,"Cancel Order"),Object(o.ensureNotNull)(this._brokerCommandsUIGetter()).cancelOrder(e)}_moveOrder(t,e,i,r){this._trackEvent(e,"Move Order");const s=Object(o.ensureDefined)(t?this._ordersData.get(i):this._stopLimitOrdersData.get(i)).value(),n=Object(d.clone)(s),a={silent:!0};if(t){const t=n.price;n.stopPrice?n.stopPrice=t:n.limitPrice&&(n.limitPrice=t),a.useStopPrice=Boolean(n.stopPrice)}else n.limitPrice=s.price,a.useLimitPrice=!0;const l=Object(o.ensureNotNull)(this._ordersService.find(i));return this._processingModifyOrder(a,n,l,r)}_showContextMenu(t,e,i,o){return A(t,e,i,o)}}},TNlN:function(t){
t.exports=JSON.parse('{"buy":{"normal":{"labelTickColor":"#2196F3","lineColor":"#2196F3","borderColor":"#2196F3","qty":{"backgroundColor":"#ffffff","textColor":"#2196F3","dividerColor":"#BBDEFB","activeColor":"rgba(33, 150, 243, 0.15)"},"text":{"backgroundColor":"#ffffff","textColor":"#2196F3","dividerColor":"#BBDEFB"},"close":{"backgroundColor":"#ffffff","iconColor":"#2196F3","activeColor":"rgba(33, 150, 243, 0.15)"}},"disabled":{"labelTickColor":"#2196F3","lineColor":"#2196F3","borderColor":"#2196F3","qty":{"backgroundColor":"#ffffff","textColor":"#2196F3","dividerColor":"#BBDEFB","activeColor":"rgba(33, 150, 243, 0.15)"},"text":{"backgroundColor":"#ffffff","textColor":"#2196F3","dividerColor":"#BBDEFB"},"close":{"backgroundColor":"#ffffff","iconColor":"rgba(33, 150, 243, 0.2)","activeColor":"rgba(33, 150, 243, 0.15)"}}},"sell":{"normal":{"labelTickColor":"#EF5350","lineColor":"#EF5350","borderColor":"#EF5350","qty":{"backgroundColor":"#ffffff","textColor":"#EF5350","dividerColor":"#FFCDD2","activeColor":"rgba(239, 83, 80, 0.15)"},"text":{"backgroundColor":"#ffffff","textColor":"#EF5350","dividerColor":"#FFCDD2"},"close":{"backgroundColor":"#ffffff","iconColor":"#EF5350","activeColor":"rgba(239, 83, 80, 0.15)"}},"disabled":{"labelTickColor":"#EF5350","lineColor":"#EF5350","borderColor":"#EF5350","qty":{"backgroundColor":"#ffffff","textColor":"#EF5350","dividerColor":"#FFCDD2","activeColor":"rgba(239, 83, 80, 0.15)"},"text":{"backgroundColor":"#ffffff","textColor":"#EF5350","dividerColor":"#FFCDD2"},"close":{"backgroundColor":"#ffffff","iconColor":"rgba(244, 67, 54, 0.2)","activeColor":"rgba(239, 83, 80, 0.15)"}}},"takeProfit":{"normal":{"labelTickColor":"#26a69a","lineColor":"#26a69a","borderColor":"#26a69a","qty":{"backgroundColor":"#ffffff","textColor":"#26a69a","dividerColor":"#B2DFDB","activeColor":"rgba(38, 166, 154, 0.15)"},"text":{"backgroundColor":"#ffffff","textColor":"#26a69a","dividerColor":"#B2DFDB"},"close":{"backgroundColor":"#ffffff","iconColor":"#26a69a","activeColor":"rgba(38, 166, 154, 0.15)"}},"disabled":{"labelTickColor":"#26a69a","lineColor":"#26a69a","borderColor":"#26a69a","qty":{"backgroundColor":"#ffffff","textColor":"#26a69a","dividerColor":"#B2DFDB","activeColor":"rgba(38, 166, 154, 0.15)"},"text":{"backgroundColor":"#ffffff","textColor":"#26a69a","dividerColor":"#B2DFDB"},"close":{"backgroundColor":"#ffffff","iconColor":"rgba(38, 166, 154, 0.2)","activeColor":"rgba(38, 166, 154, 0.15)"}}},"stopLoss":{"normal":{"labelTickColor":"#FFA726","lineColor":"#FFA726","borderColor":"#FFA726","qty":{"backgroundColor":"#ffffff","textColor":"#FFA726","dividerColor":"#FFE0B2","activeColor":"rgba(255, 167, 38, 0.15)"},"text":{"backgroundColor":"#ffffff","textColor":"#FFA726","dividerColor":"#FFE0B2"},"close":{"backgroundColor":"#ffffff","iconColor":"#FFA726","activeColor":"rgba(255, 167, 38, 0.15)"}},"disabled":{"labelTickColor":"#FFA726","lineColor":"#FFA726","borderColor":"#FFA726","qty":{"backgroundColor":"#ffffff","textColor":"#FFA726","dividerColor":"#FFE0B2","activeColor":"rgba(255, 167, 38, 0.15)"},"text":{"backgroundColor":"#ffffff","textColor":"#FFA726","dividerColor":"#FFE0B2"},"close":{"backgroundColor":"#ffffff","iconColor":"rgba(255, 167, 38, 0.2)","activeColor":"rgba(255, 167, 38, 0.15)"}}}}')
},almi:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var o=i("KcY8");class r extends o.a{constructor(t,e,i){super(),this._model=t,this._source=e,this._styleGetter=i}_updateRendererData(t,e,i){if(t.visible=!1,!this._source.showProperty().value())return;const o=this._model.mainSeries(),r=o.priceScale(),s=o.firstValue();if(null===s)return;const n=this._source.price();if(null===n)return;const a=this._styleGetter();i.background=a.qty.backgroundColor,i.borderColor=a.labelBorderVisible?a.borderColor:void 0,i.borderStyle=a.labelBorderVisible?a.borderStyle:void 0,i.textColor=a.qty.textColor,i.coordinate=r.priceToCoordinate(n,s),t.borderVisible=a.labelBorderVisible,t.text=this._formatPrice(n),t.tickColor=a.labelTickColor,t.visible=!0}_formatPrice(t){return this._source.formatter().format(t)}}},bydf:function(t,e,i){"use strict";i.r(e);var o=i("Eyy1"),r=i("ogJP"),s=i("KtbP"),n=i("oV8k"),a=i("TmNs");class l extends a.PriceLineAxisView{constructor(t,e,i){super(),this._model=t,this._source=e,this._priceType=i}_value(){const t=this._model.mainSeries(),e=t.priceScale(),i=t.firstValue();if(null===i)return{noData:!0};const o=this._source.getPrice(this._priceType);if(null===o)return{noData:!0};const r=e.priceToCoordinate(o,i);return{noData:!1,floatCoordinate:r,coordinate:r,color:"",formattedPricePercentage:"",formattedPriceAbsolute:"",text:"",index:0}}_priceLineColor(t){const e=this._source.properties().childs();return 0===this._priceType?e.bidLineColor.value():e.askLineColor.value()}_lineWidth(){return this._source.properties().childs().lineWidth.value()}_lineStyle(){return this._source.properties().childs().lineStyle.value()}_isVisible(){return this._source.properties().childs().visible.value()}}var c=i("YFKU"),d=i("KcY8");class h extends d.a{constructor(t,e,i){super(),this._model=t,this._source=e,this._priceType=i}_updateRendererData(t,e,i){if(t.visible=!1,e.visible=!1,!this._model.properties().scalesProperties.showBidAskLabels.value())return;const o=this._model.mainSeries(),r=o.priceScale(),s=o.firstValue();if(null===s)return;const n=this._source.getPrice(this._priceType);if(null===n)return;t.visible=!0,e.visible=!0,t.text=r.formatPriceAbsolute(n),e.text=0===this._priceType?Object(c.t)("Bid"):Object(c.t)("Ask"),i.coordinate=r.priceToCoordinate(n,s);const a=this._source.properties().childs();i.background=0===this._priceType?a.bidLineColor.value():a.askLineColor.value()}}var u=i("2ijp"),_=i("VdBB");class b extends u.a{constructor(t,e,i,o){super(),this._model=t,this._source=e,this._priceType=i;const r={doubleClickHandler:o,doubleTapHandler:o};this._lineRenderer.setHitTest(new _.HitTestResult(_.HitTestResult.REGULAR,r))}_updateImpl(){const t=this._lineRendererData;t.visible=!1;const e=this._source.properties().childs();if(!e.visible.value())return;const i=this._model.mainSeries(),o=i.priceScale(),r=i.firstValue();if(null===r)return;const s=this._source.getPrice(this._priceType);null!==s&&(t.visible=!0,t.y=o.priceToCoordinate(s,r),t.linestyle=e.lineStyle.value(),t.linewidth=e.lineWidth.value(),
t.color=0===this._priceType?e.bidLineColor.value():e.askLineColor.value())}}i.d(e,"BidAsk",(function(){return f}));class f extends n.a{constructor(t,e,i,o){super(t,e),this._ask=null,this._bid=null,this._symbol=null,this._realtimeProvider=i,this._bidLinesPaneView=new b(e,this,0,o),this._askLinesPaneView=new b(e,this,1,o),this._bidPriceAxisView=new h(e,this,0),this._askPriceAxisView=new h(e,this,1),this._regularPriceAxisViews=[this._bidPriceAxisView,this._askPriceAxisView],this._bidLabelPaneView=new s.PanePriceAxisView(this._bidPriceAxisView,e.mainSeries(),e),this._askLabelPaneView=new s.PanePriceAxisView(this._askPriceAxisView,e.mainSeries(),e),this._bidPriceLineAxisView=new l(e,this,0),this._askPriceLineAxisView=new l(e,this,1),this._externalPriceAxisViews=[this._bidPriceLineAxisView,this._askPriceLineAxisView],this._updateRealtimeDataHandler=this._updateRealtimeData.bind(this);const r=e.mainSeries().dataEvents();r.symbolResolved().subscribe(this,this._createTradedSymbol),r.symbolError().subscribe(this,this._createTradedSymbol),this._createTradedSymbol()}destroy(){const t=this._model.mainSeries().dataEvents();t.symbolResolved().unsubscribeAll(this),t.symbolError().unsubscribeAll(this),this._clearTradedSymbol()}paneViews(t){return this._isMainSourcePane(t)?[this._bidLinesPaneView,this._askLinesPaneView]:[]}labelPaneViews(t){return this._isMainSourcePane(t)?[this._bidLabelPaneView,this._askLabelPaneView]:[]}priceAxisViews(t,e){return this._isMainSourcePane(t)?t.findTargetPriceAxisViews(this,e,this._regularPriceAxisViews,this._externalPriceAxisViews):[]}priceScale(){return this._model.mainSeries().priceScale()}updateAllViews(){this._bidLinesPaneView.update(),this._askLinesPaneView.update(),this._bidPriceAxisView.update(),this._askPriceAxisView.update(),this._bidPriceLineAxisView.update(),this._askPriceLineAxisView.update(),this._bidLabelPaneView.update(),this._askLabelPaneView.update()}getPrice(t){return 1===t?this._ask:this._bid}properties(){return this._model.mainSeries().properties().bidAsk}_createTradedSymbol(){const t=function(t){if(t.isConvertedToOtherCurrency()||t.isConvertedToOtherUnit())return null;const e=t.symbolInfo();return null===e?t.proSymbol():e.pro_name||e.full_name||e.name||null}(this._model.mainSeries());t!==this._symbol&&(this._clearTradedSymbol(),null!==t&&this._initTradedSymbol(t))}_initTradedSymbol(t){this._symbol=t,this._realtimeProvider.subscribeRealtime(this._symbol,this._updateRealtimeDataHandler)}_clearTradedSymbol(){this._ask=null,this._bid=null,null!==this._symbol&&(this._realtimeProvider.unsubscribeRealtime(Object(o.ensureNotNull)(this._symbol),this._updateRealtimeDataHandler),this._symbol=null)}_updateRealtimeData(t,e,i){const o=e.ask,s=e.bid;o===s?(this._ask=null,this._bid=null):(Object(r.isNumber)(o)&&(this._ask=o),Object(r.isNumber)(s)&&(this._bid=s)),(this._model.mainSeries().properties().bidAsk.visible.value()||this._model.properties().scalesProperties.showBidAskLabels.value())&&(this.updateAllViews(),this._model.updateSource(this))}_isMainSourcePane(t){
return this._model.paneForSource(this._model.mainSeries())===t}}},"fA+p":function(t,e,i){"use strict";i.r(e),i.d(e,"ExecutionsService",(function(){return d}));var o=i("Eyy1"),r=i("ogJP"),s=i("kcTO"),n=i("2TBc"),a=i("aIyQ"),l=i.n(a),c=i("4qhP");class d extends n.a{constructor(t,e,i){super(t),this._allExecutionsID=new Set,this._executions=[],this._executionsAdded=new l.a,this._executionsCleared=new l.a,this._formatter=new s.PriceFormatter,this._symbol="",this._dataEvents=e,this._getSymbolName=i,this._initialized=!0,this._tryToStart()}destroy(){this.stopService()}formatter(){return this._formatter}executions(){return this._executions}executionsAdded(){return this._executionsAdded}executionsCleared(){return this._executionsCleared}startService(){this._canBeStarted=!0,this._tryToStart()}stopService(){this._canBeStarted=!1,this._isStarted&&this._stop()}_tryToStart(){Object(o.assert)(!this._isStarted,"Execution's service has already started"),this._canBeStarted&&this._initialized&&this._start()}_start(){Object(o.assert)(!this._isStarted,"Execution's service has already started"),this._isStarted=!0,this._dataEvents.symbolResolved().subscribe(this,this._createExecutions),this._dataEvents.symbolError().subscribe(this,this._createExecutions),this._createExecutions()}_stop(){this._isStarted=!1,this._clearExecutions();Object(o.ensure)(this.activeBroker()).executionUpdate.unsubscribeAll(this),this._dataEvents.symbolResolved().unsubscribeAll(this),this._dataEvents.symbolError().unsubscribeAll(this)}_createExecutions(){this._clearExecutions(),this._symbol=this._getSymbolName(),this._symbol&&this._requestFormatterAndExecutions()}_clearExecutions(){this._allExecutionsID=new Set,this._executions=[],this._executionsCleared.fire()}async _requestFormatterAndExecutions(){const t=this.activeBroker();if(!t)return;if(!this._symbol)return;if(!(await t.isTradable(this._symbol)).tradable)return;const e=this._symbol;Promise.all([t.formatter(this._symbol,!1),t.executions(this._symbol)]).then(([i,o])=>{this._symbol===e&&(this._formatter=i,this._executions=o.map(t=>this._createExecutionData(t)).filter(r.notNull),this._executionsAdded.fire(this._executions),t.executionUpdate.unsubscribeAll(this),t.executionUpdate.subscribe(this,this._addExecution))})}_addExecution(t){const e=this._createExecutionData(t);null!==e&&this._executionsAdded.fire([e])}_createExecutionData(t){return t.symbol!==this._symbol||this._allExecutionsID.has(t.id)?null:(this._allExecutionsID.add(t.id),Object.assign(Object.assign({},t),{tooltip:Object(c.d)(t,this._formatter)}))}}},fAa4:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return n}));var o=i("EBrf"),r=i("Ialn");function s(t){return null===t?"0":Object(r.forceLTRStr)(Object(o.splitThousands)(t," "))}class n{constructor(t,e,i){this._invalidated=!0,this._renderer=null,this._chartModel=t,this._source=e,this._styleGetter=i}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}priceToCoordinate(t){if(null===t)return null
;const e=this._chartModel.mainSeries(),i=e.firstValue();return null===i?null:e.priceScale().priceToCoordinate(t,i)}isHoveredSource(){return this._source===this._chartModel.hoveredSource()}isItemActive(t){var e;return this._chartModel.hoveredSource()===this._source&&(null===(e=this._chartModel.lastHittestData())||void 0===e?void 0:e.itemIndex)===t}isSelectedSource(){return this._chartModel.selection().isSelected(this._source)}}},kGg1:function(t){t.exports=JSON.parse('{"buy":{"normal":{"lineColor":"#1976D2","borderColor":"#1976D2","qty":{"backgroundColor":"#1976D2","textColor":"#E3F2FD","dividerColor":"#1976D2","activeColor":"#1E88E5"},"text":{"backgroundColor":"#131722","textColor":"#787B86","positiveTextColor":"#009688","negativeTextColor":"#D32F2F","dividerColor":"#153661"},"close":{"backgroundColor":"#131722","iconColor":"#1976D2","activeColor":"rgba(33, 150, 243, 0.1)"},"reverse":{"backgroundColor":"#131722","borderColor":"#1976D2","iconColor":"#1976D2","activeColor":"rgba(33, 150, 243, 0.1)"}},"disabled":{"lineColor":"#1976D2","borderColor":"#1976D2","qty":{"backgroundColor":"#1976D2","textColor":"#E3F2FD","dividerColor":"#1976D2","activeColor":"#1E88E5"},"text":{"backgroundColor":"#131722","textColor":"#787B86","positiveTextColor":"#009688","negativeTextColor":"#D32F2F","dividerColor":"#153661"},"close":{"backgroundColor":"#131722","iconColor":"rgba(25, 118, 210, 0.2)","activeColor":"rgba(33, 150, 243, 0.1)"},"reverse":{"backgroundColor":"#131722","borderColor":"#1976D2","iconColor":"rgba(25, 118, 210, 0.2)","activeColor":"rgba(33, 150, 243, 0.1)"}}},"sell":{"normal":{"lineColor":"#D32F2F","borderColor":"#D32F2F","qty":{"backgroundColor":"#D32F2F","textColor":"#FFEBEE","dividerColor":"#D32F2F","activeColor":"#E53935"},"text":{"backgroundColor":"#131722","textColor":"#787B86","positiveTextColor":"#009688","negativeTextColor":"#D32F2F","dividerColor":"#862326"},"close":{"backgroundColor":"#131722","iconColor":"#D32F2F","activeColor":"rgba(211, 47, 47, 0.15)"},"reverse":{"backgroundColor":"#131722","borderColor":"#D32F2F","iconColor":"#D32F2F","activeColor":"rgba(211, 47, 47, 0.15)"}},"disabled":{"lineColor":"#D32F2F","borderColor":"#D32F2F","qty":{"backgroundColor":"#D32F2F","textColor":"#FFEBEE","dividerColor":"#D32F2F","activeColor":"#E53935"},"text":{"backgroundColor":"#131722","textColor":"#787B86","positiveTextColor":"#009688","negativeTextColor":"#D32F2F","dividerColor":"#862226"},"close":{"backgroundColor":"#131722","iconColor":"rgba(244, 67, 54, 0.2)","activeColor":"rgba(211, 47, 47, 0.15)"},"reverse":{"backgroundColor":"#131722","borderColor":"#D32F2F","iconColor":"rgba(244, 67, 54, 0.2)","activeColor":"rgba(211, 47, 47, 0.15)"}}}}')},npNH:function(t){
t.exports=JSON.parse('{"buy":{"normal":{"lineColor":"#2196F3","borderColor":"#2196F3","qty":{"backgroundColor":"#2196F3","textColor":"#ffffff","dividerColor":"#2196F3","activeColor":"#1E88E5"},"text":{"backgroundColor":"#ffffff","textColor":"#787B86","positiveTextColor":"#009688","negativeTextColor":"#F44336","dividerColor":"#BBDEFB"},"close":{"backgroundColor":"#ffffff","iconColor":"#2196F3","activeColor":"rgba(33, 150, 243, 0.15)"},"reverse":{"backgroundColor":"#ffffff","borderColor":"#2196F3","iconColor":"#2196F3","activeColor":"rgba(33, 150, 243, 0.15)"}},"disabled":{"lineColor":"#2196F3","borderColor":"#2196F3","qty":{"backgroundColor":"#2196F3","textColor":"#ffffff","dividerColor":"#2196F3","activeColor":"#1E88E5"},"text":{"backgroundColor":"#ffffff","textColor":"#787B86","positiveTextColor":"#009688","negativeTextColor":"#F44336","dividerColor":"#BBDEFB"},"close":{"backgroundColor":"#ffffff","iconColor":"rgba(33, 150, 243, 0.2)","activeColor":"#BBDEFB"},"reverse":{"backgroundColor":"#ffffff","borderColor":"#2196F3","iconColor":"rgba(33, 150, 243, 0.2)","activeColor":"rgba(33, 150, 243, 0.15)"}}},"sell":{"normal":{"lineColor":"#F44336","borderColor":"#F44336","qty":{"backgroundColor":"#F44336","textColor":"#ffffff","dividerColor":"#F44336","activeColor":"#E53935"},"text":{"backgroundColor":"#ffffff","textColor":"#787B86","positiveTextColor":"#009688","negativeTextColor":"#F44336","dividerColor":"#FFCDD2"},"close":{"backgroundColor":"#ffffff","iconColor":"#F44336","activeColor":"rgba(244, 67, 54, 0.15)"},"reverse":{"backgroundColor":"#ffffff","borderColor":"#F44336","iconColor":"#F44336","activeColor":"rgba(244, 67, 54, 0.15)"}},"disabled":{"lineColor":"#F44336","borderColor":"#F44336","qty":{"backgroundColor":"#F44336","textColor":"#ffffff","dividerColor":"#F44336","activeColor":"#E53935"},"text":{"backgroundColor":"#ffffff","textColor":"#787B86","positiveTextColor":"#009688","negativeTextColor":"#F44336","dividerColor":"#FFCDD2"},"close":{"backgroundColor":"#ffffff","iconColor":"rgba(244, 67, 54, 0.2)","activeColor":"rgba(244, 67, 54, 0.15)"},"reverse":{"backgroundColor":"#ffffff","borderColor":"#F44336","iconColor":"rgba(244, 67, 54, 0.2)","activeColor":"rgba(244, 67, 54, 0.15)"}}}}')},uDRY:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var o=i("kcTO"),r=i("oV8k"),s=i("Kxc7");class n extends r.a{constructor(t,e,i,r){super(t,e),this._symbol=null,this._isActualSymbol=!1,this._formatter=new o.PriceFormatter,this._paneViews=[],this._priceAxisViews=[],this._priceLineAxisViews=[],this._isBlocked=!1,this._mainSeries=e.mainSeries(),this._showProperty=i,this._lineProperties=r;const s=this._mainSeries.dataEvents();s.symbolResolved().subscribe(this,this._updateActualSymbolAndFormatter),s.symbolError().subscribe(this,this._updateActualSymbolAndFormatter),this._updateActualSymbolAndFormatter()}destroy(){this._showProperty.destroy();const t=this._mainSeries.dataEvents();t.symbolResolved().unsubscribeAll(this),t.symbolError().unsubscribeAll(this)}formatter(){return this._formatter}showProperty(){
return this._showProperty}lineWidth(){return this._lineProperties.width.value()}lineLength(){return this._lineProperties.length.value()}lineStyle(){return this._lineProperties.style.value()}isLineExtended(){return this._lineProperties.extend.value()}isBlocked(){return this._isBlocked}priceScale(){return this._mainSeries.priceScale()}updateAllViews(){if(this._showProperty.value()){for(const t of this._paneViews)t.update();for(const t of this._priceAxisViews)t.update();for(const t of this._priceLineAxisViews)t.update()}}updateViewsForPane(t){this._isSourceShouldBeShown(t)&&this.updateAllViews()}paneViews(t){return this._isSourceShouldBeShown(t)?this._paneViews:[]}priceAxisViews(t,e){return this._isSourceShouldBeShown(t)?t.findTargetPriceAxisViews(this,e,this._priceAxisViews,this._priceLineAxisViews):[]}isSelectionEnabled(){return!0}_setIsBlocked(t){this._isBlocked=t,this.updateAllViews(),this._model.updateSource(this)}_updateActualSymbolAndFormatter(){if(null===this._symbol)return;const t=this._mainSeries.symbolInfo();if(null===t)this._isActualSymbol=!1,this._formatter=new o.PriceFormatter(100,1,!1);else{const e=this._mainSeries.isConvertedToOtherCurrency()||this._mainSeries.isConvertedToOtherUnit();this._isActualSymbol=!e&&this._mainSeries.symbolSameAsCurrent(this._symbol),this._formatter=new o.PriceFormatter(t.pricescale,t.fractional?t.minmov:1,t.fractional,t.minmove2)}this.updateAllViews(),this._model.updateSource(this)}_isSourceShouldBeShown(t){return!!this._isActualSymbol&&(!!t.containsMainSeries()&&(!(window.TradingView.printing&&!s.enabled("snapshot_trading_drawings"))&&this._showProperty.value()))}}}}]);