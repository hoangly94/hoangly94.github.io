(window.webpackJsonp=window.webpackJsonp||[]).push([["position-widget"],{CWem:function(e,o,t){"use strict";t.r(o);var s=t("q1tI"),n=t("i8i4"),l=t("AVTG"),i=t("WXjp"),a=t("oykh"),r=t("k/ZQ"),d=t("twDL"),c=t("en3B"),u=t("/qCs"),p=t("Rxoo");function m(e){return s.createElement("div",{className:p.positionInfo},s.createElement("div",{className:p.title},e.title),s.createElement(u.a,{rows:e.infoTableData.rows,header:e.infoTableData.header,disabled:!1,rightAlignedValues:!0}))}class b extends s.PureComponent{constructor(e){super(e),this._updateInfoTableData=e=>{this.setState({infoTableData:e})},this.state={title:e.model.title(),infoTableData:e.model.infoTableData().value()}}componentDidMount(){this._subscribeToModel(this.props.model)}componentWillUnmount(){this._unsubscribeFromModel(this.props.model)}render(){return s.createElement(m,{title:this.state.title,infoTableData:this.state.infoTableData})}_subscribeToModel(e){e.infoTableData().subscribe(this._updateInfoTableData)}_unsubscribeFromModel(e){e.infoTableData().unsubscribe(this._updateInfoTableData)}}var h=t("NbG7"),f=t("/3z9"),g=t("YSy0"),v=t("+Kd2");class k extends s.PureComponent{constructor(e){super(e),this._block=null,this._setRef=e=>{this._block=e},this._onEnter=e=>{13===Object(f.hashFromEvent)(e)&&!1===this.props.model.disabled.value()&&this.props.model.doneButtonClick()},this._callback=()=>this.forceUpdate()}componentDidMount(){this._subscribeToModel(this.props.model),this.props.settings.subscribe(this._callback),null!==this._block&&void 0===this.props.focus&&this._block.focus()}componentWillUnmount(){this._unsubscribeFromModel(this.props.model),this.props.settings.unsubscribe(this._callback)}render(){const e=this.props.model,{settings:o}=this.props,t={value:o.value(),setValue:o.setValue.bind(o)},n=e.warning.value();return s.createElement(h.a.Provider,{value:t},s.createElement("div",{className:g.positionWidget,onKeyDown:this._onEnter,tabIndex:-1,ref:this._setRef},s.createElement("div",{className:g.header},s.createElement(a.a,{model:e.headerModel,supportBrackets:!0,currency:e.currency,mode:e.mode.value()})),s.createElement("div",{className:g.separator}),s.createElement("div",{className:g.brackets},s.createElement(r.a,{model:e,focus:this.props.focus})),Array.isArray(e.customFieldModels.value())&&e.customFieldModels.value().length>0&&s.createElement("div",{className:g.customFieldsWrapper},this._generateCustomFields(e)),n&&s.createElement("div",{className:g.warning},s.createElement("span",null,e.warning.value())),s.createElement("div",{className:g.button},s.createElement(d.a,{model:e})),e.mode.value()===c.g.Panel&&null!==e.positionInfoModel&&s.createElement("div",null,s.createElement("div",{className:g.separator}),s.createElement("div",{className:g.positionInfo},s.createElement(b,{model:e.positionInfoModel})))))}_subscribeToModel(e){this.props.model.disabled.subscribe(this._callback),this.props.model.loading.subscribe(this._callback),this.props.model.mode.subscribe(this._callback),this.props.model.warning.subscribe(this._callback)}_unsubscribeFromModel(e){
this.props.model.disabled.unsubscribe(this._callback),this.props.model.loading.unsubscribe(this._callback),this.props.model.mode.unsubscribe(this._callback),this.props.model.warning.unsubscribe(this._callback)}_generateCustomFields(e){return Object(v.a)(e.customFieldModels.value(),!1,e.status,g.customField)}}var C=t("ahhv");class _ extends s.PureComponent{constructor(e){super(e),this._onKeyDown=e=>{27===e.keyCode&&this.props.onClose&&this.props.onClose()}}render(){return s.createElement(i.a,{className:C.dialog,isOpened:this.props.isOpened,onKeyDown:this._onKeyDown,width:414},s.createElement(l.a,{className:C.dialogBody},this.props.model&&this.props.settings&&s.createElement(k,{settings:this.props.settings,model:this.props.model,key:this.props.model.id,focus:this.props.focus})))}}var E=t("O51n");class I extends s.PureComponent{constructor(e){super(e),this._onKeyDown=e=>{27===e.keyCode&&this.props.onCancel&&this.props.onCancel()}}render(){return s.createElement("div",{className:E.positionPanel,onKeyDown:this._onKeyDown},s.createElement(k,{settings:this.props.settings,model:this.props.model,focus:this.props.focus,key:this.props.model.id}))}}t.d(o,"showPositionDialog",(function(){return w})),t.d(o,"closePositionDialog",(function(){return M})),t.d(o,"mountPositionPanel",(function(){return T})),t.d(o,"unmountPositionPanel",(function(){return B}));let y=null;function w(e,o,t){M();const s={model:e,settings:o,isOpened:!0,focus:t,onClose:()=>{M(),e.onDoneButtonClicked.reject(),s.model.headerModel.pinButtonClicked().unsubscribe(null,s.onClose),s.model.headerModel.closeButtonClicked().unsubscribe(null,s.onClose),y&&n.unmountComponentAtNode(y)}};D(s),s.model.headerModel.pinButtonClicked().subscribe(null,s.onClose),s.model.headerModel.closeButtonClicked().subscribe(null,s.onClose)}function M(){D({model:null,isOpened:!1})}function D(e){y||(y=document.createElement("div"),document.body.appendChild(y));const o=s.createElement(c.f.Provider,{value:{mode:e.model&&e.model.mode.value()||c.g.Panel,supportTrailingStop:Boolean(e.model&&e.model.supportTrailingStop)}},s.createElement(_,Object.assign({},e)));n.render(o,y)}function T(e,o,t,l){B(e,t);const i={model:e,settings:o,focus:l,onClose:()=>{B(e,t),i.model.headerModel.pinButtonClicked().unsubscribe(null,i.onClose),i.model.headerModel.closeButtonClicked().unsubscribe(null,i.onClose)},onCancel:()=>{i.model.headerModel&&i.model.headerModel.back()}};i.model.headerModel.pinButtonClicked().subscribe(null,i.onClose),i.model.headerModel.closeButtonClicked().subscribe(null,i.onClose),function(e,o){const t=s.createElement(c.f.Provider,{value:{mode:e.model.mode.value(),supportTrailingStop:Boolean(e.model.supportTrailingStop)}},s.createElement(I,Object.assign({},e)));n.render(t,o)}(i,t)}function B(e,o){n.unmountComponentAtNode(o)}},O51n:function(e,o,t){e.exports={positionPanel:"positionPanel-JKJMXNzQ"}},Rxoo:function(e,o,t){e.exports={positionInfo:"positionInfo-gdwULvBb",title:"title-gdwULvBb",positionInfoItem:"positionInfoItem-gdwULvBb",positionInfoItemTitle:"positionInfoItemTitle-gdwULvBb",
positionInfoItemValue:"positionInfoItemValue-gdwULvBb"}},YSy0:function(e,o,t){e.exports={positionWidget:"positionWidget-1lIcWKyL",header:"header-1lIcWKyL",separator:"separator-1lIcWKyL",brackets:"brackets-1lIcWKyL",button:"button-1lIcWKyL",positionInfo:"positionInfo-1lIcWKyL",warning:"warning-1lIcWKyL",customFieldsWrapper:"customFieldsWrapper-1lIcWKyL"}},ahhv:function(e,o,t){e.exports={dialog:"dialog-j5USH1y6",dialogBody:"dialogBody-j5USH1y6"}}}]);